{"version":3,"sources":["Array.from.js","Array.prototype.find.js","Array.prototype.findIndex.js","Array.prototype.includes.js","NodeList.prototype.forEach.js","Object.Assign.js","Okanjo.js","Request.js","Cookie.js","TemplateEngine.js","Modal.js","Metrics.js","AutoPageView.js","Widget.js","Placement.js","Product.js","Ad.js","EventEmitter.js","vendor.js"],"names":["_classCallCheck","instance","Constructor","TypeError","Array","from","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_typeof","obj","Symbol","iterator","constructor","prototype","isCallable","fn","toStr","call","toLength","value","len","number","Number","isNaN","Math","floor","abs","toInteger","min","max","maxSafeInteger","arrayLike","T","mapFn","arguments","A","k","items","find","predicate","this","thisArg","kValue","o","undefined","findIndex","includes","searchElement","fromIndex","n","x","sameValueZero","y","window","NodeList","forEach","assign","nextSource","to","nextKey","index","hasOwnProperty","navigator","userAgent","document","NOOP","pageXOffset","settings","ELLIPSIFY_PATTERN","MOBILE_PATTERN","Console","console","okanjo","version","metrics","args","err","_len","_key","messageIndex","stack","Error","split","shift","push","error","reportStack","a","arg","join","splice","concat","warn","message","apply","_len2","_key2","parent","qwery","selector","querySelector","querySelectorAll","net","metrics_batch","routes","ads","getRoute","env","route","sandboxEndpoint","params","keys","request","endpoint","util","isMobile","val","trim","getPageArguments","test","AGENT","eqIndex","query","decodeURIComponent","part","location","search","substring","queryArgs","hashArgs","indexOf","includeHashArguments","hash","ifDefined","deepClone","mixed","out","map","options","dateToIso","input","output","toISOString","childObject","isArray","flatten","childKey","arrayToCsv","randomByte","shortid","crypto","msCrypto","require","previousSeconds","str","counter","encode","href","ui","getScrollPosition","CSS1_COMPATIBLE","documentElement","body","scrollLeft","SUPPORTS_PAGE_OFFSET","pageYOffset","scrollTop","size","marginTop","parseInt","width","height","element","offsetHeight","style","currentStyle","getComputedStyle","includeMargin","marginBottom","marginLeft","marginRight","html","w","scrollWidth","offsetWidth","clientWidth","getViewportSize","scrollHeight","clientHeight","inHeight","innerHeight","isMobileZoom","inWidth","innerWidth","vh","getEventPosition","event","et","ex","type","pageX","ey","pageY","el","__proto__","name","clientX","clientY","getElementPosition","getBoundingClientRect","rect","domFailed","contains","x2","report","exception","left","right","y2","bottom","top","x1","e","y1","intersectionArea","s","v","elementArea","iRight","vw","iTop","iLeft","iBottom","isElementVisible","getPercentageInViewport","percentage","_getIntersection","_okanjo$ui$_getInters","ellipsify","container","replacer","text","replacedText","getElementSize","targetHeight","useTextContent","content","safety","parentNode","textContent","innerText","replace","span","createElement","setAttribute","appendChild","innerHTML","img","display","backgroundImage","backgroundSize","src","btoa","svg","$html","createElements","$modalContainer","$modalWindow","$modalOuter","$body","removeClass","addClass","Metrics","MetricEvent","Widget","DATA_REPLACE_PATTERN","TemplateEngine","DISPLAY","ARTICLE_META","MINIMUM_VIEW_PX","MINIMUM_VIEW_TIME","MINIMUM_VIEW_FREQ","LARGE_PX_THRESHOLD","Product","Ad","loopCounter","done","dest","Uint8Array","randomBytes","getRandomValues","shuffled","pow","REDUCE_TIME","getWindowHeight","handler","addEventListener","handleReposition","setTimeout","IS_MOBILE","setContent","getKey","keyPrefix","JSON_TEST","req","XMLHttpRequest","url","payload","callback","ActiveXObject","calledBack","timeout","statusCode","xhr","onreadystatechange","readyState","res","responseText","getResponseHeader","status","attributes","method","JSON","withCredentials","send","get","bind","put","pairs","stringify","expireDate","cookie","Date","cookieName","setDate","getDate","expireDays","secure","protocol","cookieValue","encodeURI","expires","nameTest","substr","decodeURI","_templates","_css","classDetects","template","beforeRender","nodeType","lib","parse","markup","css","id","head","styleSheet","link","model","templateName","context","okanjoMetricUrl","blockClasses","now","getTime","Mustache","render","_this","ensureCss","formatCurrency","thousandsSeparator","decimals","engine","toFixed","j","decimalSeparator","slice","openModal","initialized","$modalSkin","$modalInner","$modalFrame","$modalClose","addListener","closeModal","stopPropagation","preventDefault","modal","show","hide","_queue","_processTimeout","defaultChannel","_getStoredQueue","sid","pageId","sourceCh","sourceCx","_checkUrlForReferral","_createClass","queue","localStorage","Params","_saveQueueTimeout","_this2","clearTimeout","_saveQueue","urlSid","pageArgs","trackEvent","object_type","metric_session","event_type","correlation","ch","_noProcess","channel","localSid","sourceContext","_push","page","Event","view","getLocation","_processQueue","_this3","data","item","_updateSid","_this4","events","_normalizeEvent","post","m","pgid","allowedKeys","Set","Meta","include","referrer","ref","win","set","ttl","_len3","_key3","getPageSize","create","pw","ph","h","containerSize","fallback","current","resources","wix2","_fallback","wiy2","wix1","getMax","getMin","wiy1","wox1","woy1","wox2","boxes","wrps","vp","pos","vx1","vy1","vx2","vy2","jsEvent","_len4","_key4","_key5","click","article","cause","marketplace","order","order_item","user","product","store","Channel","placement","external","Environment","live","testing","others","_data","addEventInfo","_element","addWidgetInfo","_len6","_key6","addEventMeta","trackPageView","_events","EventEmitter","listener","idx","listeners","_this6","_arguments","_EventEmitter","widget","_this7","_super","instanceId","config","_assertThisInitialized","_applyConfiguration","_setCompatibilityOptions","_ensurePlacementKey","load","_this8","normalizedKey","_default","isEmpty","group","origKey","getGroup","showError","setFlexClasses","align","justify","classList","add","attr","match","DATA_ATTRIBUTE_PATTERN","exec","Field","_convert","_strip","converter","parseFloat","_group","strip","array","string","bool","_Widget","FILTERS","_okanjo$_Widget$Field","Placement","_inherits","_super2","_createSuper","ignoreArrays","_metricBase","_this10","_viewedWatchers","disposed","_response","_viewWatcherIv","q","url_selectors","not_url_paths","organization_id","store_id","url_referrer","organization_name","property_name","store_name","external_id","sku","external_store_id","condition","manufacturer","upc","tags","category","min_price","float","max_price","isbn","max_donation_percent","donation_to","sort_by","sort_direction","skip","take","placement_tests_only","template_name","template_theme","template_variant","template_cta_text","template_cta_invert","adx_unit_path","hide_pricing","template_cta_style","custom_css_url","no_init","custom_css","url_category","verbose_click_data","utm_click_data","proxy_url","disable_inline_buy","disable_popup","backwards","backfill","shortfill","article_meta","backfillPattern","getSettings","filters","shortfillPattern","matches","isBackfill","isShortfill","_this12","_fetchContent","_mergeResponseSettings","_updateBaseMetaFromResponse","_showContent","base","cx","declined","shortfilled","segments","_getResponseData","backfilled","total","res_length","results","c","res_types","splitfilled","res_total","reduce","res_sf","res_type","viewport","_addOnceViewedHandler","ContentTypes","impression","meta","getConfig","setMarkup","_this14","emit","_this15","seed","aid","enabled","pten","ptid","ptseed","renderedSegments","segment","_renderADXSegment","products","_renderProductSegment","articles","_renderArticleSegment","adx","msg","segmentContent","_reportWidgetLoad","_postArticleRender","_postADXRender","fitImages","no_css","button_classes","price_classes","additionalUrlParams","ok_ch","_okjr","ok_cx","encodeURIComponent","toUrl","u","cid","clickId","sf","resource","currentTarget","trackParam","interaction","urlParam","bf","splitfill_segment","additionalParams","_event","ea","Action","_getClickThroughURL","_clickId","_additionalParams","contentType","defaultName","isTemplateRegistered","template_layout","brandCSS","brandCSSId","registerCss","_toggleViewWatcher","successfulCount","controller","_okanjo$ui$getPercent","LARGE_MINIMUM_VIEW_PX","clearInterval","setInterval","_checkViewWatchers","segmentIndex","_this16","offer","image_urls","DefaultTemplates","inline_buy_url","_image_url","_getBaseRenderModel","buy_url","_price_formatted","price","_this17","getAttribute","productSVG","spltfl_seg","_handleProductClick","allowfullscreen","scrolling","showPopupNativeBuyUx","showNativeBuyUx","_popupFrame","frame","mozallowfullscreen","class","hspace","webkitallowfullscreen","ok_expandable","expandable","ok_frame_width","ok_ad_size","_escaped_url","_this18","articleSVG","_handleArticleClick","Sizes","renderContext","adUnitPath","_this19","ta_s","ta_w","ta_h","path","frameborder","vspace","_frame","clickUrl","contentWindow","thirdparty_ad","write","open","close","medium_rectangle","large_mobile_banner","half_page","billboard","micro_bar","portrait","rectangle","super_leaderboard","wide_skyscraper","mobile_leaderboard","small_square","button_1","full_banner","half_banner","large_rectangle","pop_under","three_to_one_rectangle","skyscraper","square","square_button","vertical_banner","vertical_rectangle","_this20","init","mode","selectors","sold_by","marketplace_id","marketplace_status","sandbox","_this21","objectToString","toString","object","hasProperty","primitiveHasOwnProperty","primitive","propName","regExpTest","isWhitespace","nonSpaceRe","entityMap","&",">","\"","'","/","`","whiteRe","spaceRe","equalsRe","curlyRe","tagRe","hasTag","openingTagRe","closingTagRe","closingCurlyRe","nonSpace","indentation","tagIndex","stripSpace","spaces","tokens","pop","compileTags","mustache","tagsToCompile","start","token","eos","RegExp","escapeRegExp","valueLength","scanner","Scanner","lineHasNonSpace","chr","scan","scanUntil","openSection","sections","nestTokens","collector","squashTokens","squashedTokens","lastToken","numTokens","nestedTokens","section","tail","Context","parentContext","cache","Writer","clear","_cache","re","lookup","intermediateValue","names","lookupHit","clearCache","templateCache","isCacheEnabled","cacheKey","parseTemplate","partials","getConfigTags","renderTokens","originalTemplate","symbol","buffer","renderSection","renderInverted","renderPartial","unescapedValue","escapedValue","rawValue","self","filteredIndentation","partialByNl","partial","indentPartial","indentedValue","escape","String","getConfigEscape","defaultWriter","escapeHtml","exports","module","factory","define","amd","global"],"mappings":"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","file":"okanjo.min.js","sourcesContent":["// Production steps of ECMA-262, Edition 6, 22.1.2.1\nif (!Array.from) {\n    Array.from = (function () {\n        var toStr = Object.prototype.toString;\n        var isCallable = function (fn) {\n            return typeof fn === 'function' || toStr.call(fn) === '[object Function]';\n        };\n        var toInteger = function (value) {\n            var number = Number(value);\n            if (isNaN(number)) { return 0; }\n            if (number === 0 || !isFinite(number)) { return number; }\n            return (number > 0 ? 1 : -1) * Math.floor(Math.abs(number));\n        };\n        var maxSafeInteger = Math.pow(2, 53) - 1;\n        var toLength = function (value) {\n            var len = toInteger(value);\n            return Math.min(Math.max(len, 0), maxSafeInteger);\n        };\n\n        // The length property of the from method is 1.\n        return function from(arrayLike/*, mapFn, thisArg */) {\n            // 1. Let C be the this value.\n            var C = this;\n\n            // 2. Let items be ToObject(arrayLike).\n            var items = Object(arrayLike);\n\n            // 3. ReturnIfAbrupt(items).\n            if (arrayLike == null) {\n                throw new TypeError('Array.from requires an array-like object - not null or undefined');\n            }\n\n            // 4. If mapfn is undefined, then let mapping be false.\n            var mapFn = arguments.length > 1 ? arguments[1] : void undefined;\n            var T;\n            if (typeof mapFn !== 'undefined') {\n                // 5. else\n                // 5. a If IsCallable(mapfn) is false, throw a TypeError exception.\n                if (!isCallable(mapFn)) {\n                    throw new TypeError('Array.from: when provided, the second argument must be a function');\n                }\n\n                // 5. b. If thisArg was supplied, let T be thisArg; else let T be undefined.\n                if (arguments.length > 2) {\n                    T = arguments[2];\n                }\n            }\n\n            // 10. Let lenValue be Get(items, \"length\").\n            // 11. Let len be ToLength(lenValue).\n            var len = toLength(items.length);\n\n            // 13. If IsConstructor(C) is true, then\n            // 13. a. Let A be the result of calling the [[Construct]] internal method\n            // of C with an argument list containing the single item len.\n            // 14. a. Else, Let A be ArrayCreate(len).\n            var A = isCallable(C) ? Object(new C(len)) : new Array(len);\n\n            // 16. Let k be 0.\n            var k = 0;\n            // 17. Repeat, while k < len (also steps a - h)\n            var kValue;\n            while (k < len) {\n                kValue = items[k];\n                if (mapFn) {\n                    A[k] = typeof T === 'undefined' ? mapFn(kValue, k) : mapFn.call(T, kValue, k);\n                } else {\n                    A[k] = kValue;\n                }\n                k += 1;\n            }\n            // 18. Let putStatus be Put(A, \"length\", len, true).\n            A.length = len;\n            // 20. Return A.\n            return A;\n        };\n    }());\n}","// https://tc39.github.io/ecma262/#sec-array.prototype.find\nif (!Array.prototype.find) {\n    Object.defineProperty(Array.prototype, 'find', {\n        value: function(predicate) {\n            // 1. Let O be ? ToObject(this value).\n            if (this == null) {\n                throw new TypeError('\"this\" is null or not defined');\n            }\n\n            var o = Object(this);\n\n            // 2. Let len be ? ToLength(? Get(O, \"length\")).\n            var len = o.length >>> 0;\n\n            // 3. If IsCallable(predicate) is false, throw a TypeError exception.\n            if (typeof predicate !== 'function') {\n                throw new TypeError('predicate must be a function');\n            }\n\n            // 4. If thisArg was supplied, let T be thisArg; else let T be undefined.\n            var thisArg = arguments[1];\n\n            // 5. Let k be 0.\n            var k = 0;\n\n            // 6. Repeat, while k < len\n            while (k < len) {\n                // a. Let Pk be ! ToString(k).\n                // b. Let kValue be ? Get(O, Pk).\n                // c. Let testResult be ToBoolean(? Call(predicate, T,  kValue, k, O )).\n                // d. If testResult is true, return kValue.\n                var kValue = o[k];\n                if (predicate.call(thisArg, kValue, k, o)) {\n                    return kValue;\n                }\n                // e. Increase k by 1.\n                k++;\n            }\n\n            // 7. Return undefined.\n            return undefined;\n        }\n    });\n}","// https://tc39.github.io/ecma262/#sec-array.prototype.findIndex\nif (!Array.prototype.findIndex) {\n    Object.defineProperty(Array.prototype, 'findIndex', {\n        value: function(predicate) {\n            // 1. Let O be ? ToObject(this value).\n            if (this == null) {\n                throw new TypeError('\"this\" is null or not defined');\n            }\n\n            var o = Object(this);\n\n            // 2. Let len be ? ToLength(? Get(O, \"length\")).\n            var len = o.length >>> 0;\n\n            // 3. If IsCallable(predicate) is false, throw a TypeError exception.\n            if (typeof predicate !== 'function') {\n                throw new TypeError('predicate must be a function');\n            }\n\n            // 4. If thisArg was supplied, let T be thisArg; else let T be undefined.\n            var thisArg = arguments[1];\n\n            // 5. Let k be 0.\n            var k = 0;\n\n            // 6. Repeat, while k < len\n            while (k < len) {\n                // a. Let Pk be ! ToString(k).\n                // b. Let kValue be ? Get(O, Pk).\n                // c. Let testResult be ToBoolean(? Call(predicate, T,  kValue, k, O )).\n                // d. If testResult is true, return k.\n                var kValue = o[k];\n                if (predicate.call(thisArg, kValue, k, o)) {\n                    return k;\n                }\n                // e. Increase k by 1.\n                k++;\n            }\n\n            // 7. Return -1.\n            return -1;\n        }\n    });\n}","// https://tc39.github.io/ecma262/#sec-array.prototype.includes\nif (!Array.prototype.includes) {\n    Object.defineProperty(Array.prototype, 'includes', {\n        value: function(searchElement, fromIndex) {\n\n            if (this == null) {\n                throw new TypeError('\"this\" is null or not defined');\n            }\n\n            // 1. Let O be ? ToObject(this value).\n            var o = Object(this);\n\n            // 2. Let len be ? ToLength(? Get(O, \"length\")).\n            var len = o.length >>> 0;\n\n            // 3. If len is 0, return false.\n            if (len === 0) {\n                return false;\n            }\n\n            // 4. Let n be ? ToInteger(fromIndex).\n            //    (If fromIndex is undefined, this step produces the value 0.)\n            var n = fromIndex | 0;\n\n            // 5. If n  0, then\n            //  a. Let k be n.\n            // 6. Else n < 0,\n            //  a. Let k be len + n.\n            //  b. If k < 0, let k be 0.\n            var k = Math.max(n >= 0 ? n : len - Math.abs(n), 0);\n\n            function sameValueZero(x, y) {\n                return x === y || (typeof x === 'number' && typeof y === 'number' && isNaN(x) && isNaN(y));\n            }\n\n            // 7. Repeat, while k < len\n            while (k < len) {\n                // a. Let elementK be the result of ? Get(O, ! ToString(k)).\n                // b. If SameValueZero(searchElement, elementK) is true, return true.\n                if (sameValueZero(o[k], searchElement)) {\n                    return true;\n                }\n                // c. Increase k by 1.\n                k++;\n            }\n\n            // 8. Return false\n            return false;\n        }\n    });\n}","// https://developer.mozilla.org/en-US/docs/Web/API/NodeList/forEach\nif (window.NodeList && !NodeList.prototype.forEach) {\n    NodeList.prototype.forEach = function (callback, thisArg) {\n        thisArg = thisArg || window;\n        for (var i = 0; i < this.length; i++) {\n            callback.call(thisArg, this[i], i, this);\n        }\n    };\n}","// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign\nif (typeof Object.assign != 'function') {\n    // Must be writable: true, enumerable: false, configurable: true\n    Object.defineProperty(Object, \"assign\", {\n        value: function assign(target, varArgs) { // .length of function is 2\n            'use strict';\n            if (target == null) { // TypeError if undefined or null\n                throw new TypeError('Cannot convert undefined or null to object');\n            }\n\n            var to = Object(target);\n\n            for (var index = 1; index < arguments.length; index++) {\n                var nextSource = arguments[index];\n\n                if (nextSource != null) { // Skip over if undefined or null\n                    for (var nextKey in nextSource) {\n                        // Avoid bugs when hasOwnProperty is shadowed\n                        if (Object.prototype.hasOwnProperty.call(nextSource, nextKey)) {\n                            to[nextKey] = nextSource[nextKey];\n                        }\n                    }\n                }\n            }\n            return to;\n        },\n        writable: true,\n        configurable: true\n    });\n}","\"use strict\";\n\n/* exported okanjo */\n\n//noinspection ThisExpressionReferencesGlobalObjectJS,JSUnusedLocalSymbols\n/**\n * Okanjo widget framework namespace\n * @global okanjo\n */\nconst okanjo = (function(window, document) { // eslint-disable-line no-unused-vars\n\n    //region Constants\n\n    // Environment Vars\n    const SUPPORTS_PAGE_OFFSET = window.pageXOffset !== undefined;\n    const CSS1_COMPATIBLE = (document.compatMode || /* istanbul ignore next: out of scope */ \"\") === \"CSS1Compat\";\n    const AGENT = window.navigator.userAgent;\n    const ELLIPSIFY_PATTERN = /[\\s\\S](?:\\.\\.\\.)?$/;\n    const MOBILE_PATTERN = /(iPhone|iPad|iPod|Android|blackberry)/i;\n    const NOOP = () => {};\n    const Console = window.console;\n\n    // Place to pull defaults, if already set\n    const settings = window.okanjo || {};\n\n    //endregion\n\n    //region Okanjo Core\n\n\n    //noinspection JSValidateJSDoc,JSClosureCompilerSyntax - idk phpStorm generated it so why would it be wrong? :P\n    /**\n     * Okanjo namespace\n     * @global\n     * @type {{version: string, metrics: null, key: null, report: ((...p1?:*[])), warn: ((p1?:*, ...p2?:*[])), qwery: ((p1?:*, p2?:*))}}\n     */\n    const okanjo = {\n\n        /**\n         * Okanjo version\n         */\n        version: \"%%OKANJO_VERSION\",\n\n        /**\n         * Placeholder\n         */\n        metrics: null,\n\n        /**\n         * Global/default placement key\n         */\n        key: settings.key || null,\n\n        /**\n         * Reports an error to the console and possibly Raven in the future\n         * @param args\n         */\n        report: (...args) => {\n            let err = args.find((arg) => arg instanceof Error);\n            if (!err) {\n                let messageIndex = args.findIndex((arg) => typeof arg === \"string\");\n                err = new Error(args[messageIndex] || \"Okanjo Error\");\n                if (messageIndex >= 0) args.splice(messageIndex, 1);\n            } else {\n                // Grow our own stack so we can figure out what async thing did it\n                let stack = (new Error()).stack.split('\\n');\n                stack.shift();\n                stack.shift();\n                args.push({ reportStack: stack.join('\\n') });\n                args = args.filter((a) => a !== err);\n            }\n\n            Console.error(`[Okanjo v${okanjo.version}]: ${err.stack}`);\n            args.length && Console.error.apply(Console, ['Additional information:'].concat(args));\n\n            // TODO - integrate with Raven\n        },\n\n        /**\n         * Warn developers of their misdeeds\n         * @param message\n         * @param args\n         */\n        warn: (message, ...args) => {\n            const err = new Error(message);\n\n            Console.warn(`[Okanjo v${okanjo.version}]: ${err.stack}`);\n            args.length && Console.warn.apply(Console, ['Additional information:'].concat(args));\n        },\n\n        // Backwards compatibility when we shipped with qwery, cuz querySelector[All] wasn't mainstream enough\n        qwery: (selector, parent) => {\n\n            // If parent is a selector, select the parent first!\n            if (typeof parent === \"string\") {\n                parent = document.querySelector(parent);\n\n                // If parent is not found, there are obviously no results\n                if (!parent) return [];\n            }\n\n            if (!parent) parent = document;\n\n            return parent.querySelectorAll(selector);\n        }\n    };\n\n    //endregion\n\n    //region Vendor Libs\n\n    /**\n     * Placeholder for where vendor libraries get no-conflict loaded\n     * @type {{}}\n     */\n    okanjo.lib = {};\n\n    //endregion\n\n    //region Networking\n\n    /**\n     * Networking methods\n     * @type {{getRoute: *, exec: *}}\n     */\n    okanjo.net = {\n\n        /**\n         * API Endpoints\n         */\n        endpoint: 'https://api2.okanjo.com',\n        sandboxEndpoint: 'https://sandbox-api2.okanjo.com',\n\n        /**\n         * API routes\n         */\n        routes: {\n            ads: '/content',\n            metrics: '/metrics/:object_type/:event_type',\n            metrics_batch: '/metrics'\n        },\n\n        /**\n         * Compiles a route and parameters into a final URL\n         * @param {string} route - Route constant\n         * @param {*} [params] - Key value hash\n         * @param {*} [env] - Optional environment to use instead of live\n         * @return {string} - Route\n         */\n        getRoute: (route, params, env) => {\n            if (params) {\n                Object.keys(params).forEach((key) => {\n                    route = route.replace(`:${key}`, params[key]+\"\");\n                });\n            }\n            env = env || okanjo.env || 'live';\n            return (env === 'sandbox' ? okanjo.net.sandboxEndpoint : okanjo.net.endpoint) + route;\n        },\n\n        // placeholder, xhr request extension\n        request: NOOP\n    };\n\n    //endregion\n\n    // region Utilities\n\n    //noinspection JSClosureCompilerSyntax,JSValidateJSDoc\n    /**\n     * Utility functions and helpers\n     * @type {{isEmpty: ((p1?:*)=>boolean), isMobile: (()), getPageArguments: ((p1:boolean))}}\n     */\n    okanjo.util = {\n\n        /**\n         * Checks whether a value is _really_ empty (trims)\n         * @param val\n         * @return {boolean}\n         */\n        isEmpty: (val) => val === null || val === undefined || (typeof val === \"string\" && val.trim().length === 0),\n\n        /**\n         * Checks if the current user agent identifies as a mobile device\n         * @returns {boolean}\n         */\n        isMobile: () => {\n            // KludgyAF, but let's go with it\n            return MOBILE_PATTERN.test(AGENT);\n        },\n\n        /**\n         * Returns an object hashmap of query and hash parameters\n         * @param {boolean} includeHashArguments - Whether to include the hash arguments, if any\n         * @return {*}\n         */\n        getPageArguments: (includeHashArguments) => {\n\n            const split = (query) => {\n                query = query || \"\";\n                const params = {};\n                const parts = query.split('&');\n                parts.forEach((part) => {\n                    const eqIndex = part.indexOf('=');\n                    let key, value;\n                    if (eqIndex < 0) {\n                        key = decodeURIComponent(part);\n                        value = null;\n                    } else {\n                        key = decodeURIComponent(part.substring(0, eqIndex));\n                        value = decodeURIComponent(part.substring(eqIndex + 1));\n                    }\n                    if (key) params[key] = value;\n                });\n                return params;\n            };\n\n            const queryArgs = split(window.location.search.substring(window.location.search.indexOf('?') + 1));\n            const hashArgs = includeHashArguments ? split(window.location.hash.substring(Math.max(window.location.hash.indexOf('#') + 1, window.location.hash.indexOf('#!') + 2))) : {};\n            Object.keys(hashArgs).forEach((key) => queryArgs[key] = hashArgs[key]);\n\n            return queryArgs;\n        },\n\n        /**\n         * Returns the value if defined and not null\n         * @param val Value to use if defined\n         * @returns {*|null} Defined value or null\n         */\n        ifDefined: (val) => (typeof val !== \"undefined\" && val !== null) ? val : null\n\n    };\n\n    /**\n     * Deep clones an object by breaking references, unlike Object.assign\n     * @param mixed  Source to clone (object, array, value)\n     * @param [out] - Existing output, if any\n     * @return {*}\n     */\n    okanjo.util.deepClone = (mixed, out) => {\n        if (Array.isArray(mixed)) {\n            // Array reference\n            out = out || [];\n            out = out.concat(mixed.map((val) => okanjo.util.deepClone(val)));\n        } else if (typeof mixed === \"object\" && mixed !== null) {\n            // Object reference\n            out = out || {};\n            Object.keys(mixed).forEach((key) => {\n                out[key] = okanjo.util.deepClone(mixed[key]);\n            });\n        } else {\n            // Value\n            out = mixed;\n        }\n\n        return out;\n    };\n\n    /**\n     * Flattens a multi-dimensional object into a single object\n     * @param input\n     * @param [options]\n     * @return {{}}\n     */\n    okanjo.util.flatten = (input, options = {}) => {\n        const output = {};\n\n        if (input !== undefined && input !== null) {\n            Object\n                .keys(input)\n                .forEach((key) => {\n                    // Convert object ids to hex strings\n                    if (input[key] instanceof Date) {\n                        if (options.dateToIso) {\n                            output[key] = input[key].toISOString(); // convert to iso\n                        } else {\n                            output[key] = input[key]; // as-is\n                        }\n                    } else if (typeof input[key] === 'object' && input[key] !== null) {\n                        // Allow ignoring arrays if desired\n                        if (Array.isArray(input[key]) && options.ignoreArrays === true) {\n                            output[key] = input[key];\n                        } else if (Array.isArray(input[key]) && options.arrayToCsv === true) {\n                            output[key] = input[key].join(',');\n                        } else {\n                            // Make child objects flat too (always returns object so Object.keys is safe)\n                            const childObject = okanjo.util.flatten(input[key], options);\n                            Object\n                                .keys(childObject)\n                                .forEach((childKey) => {\n                                    output[key + '_' + childKey] = childObject[childKey];\n                                })\n                            ;\n                        }\n                    } else {\n                        // Copy value references\n                        output[key] = input[key];\n                    }\n                })\n            ;\n        }\n\n        return output;\n    };\n\n    /*! based on shortid https://github.com/dylang/shortid */\n    okanjo.util.shortid = (function(clusterWorkerId) {\n\n        const shuffled = 'ylZM7VHLvOFcohp01x-fXNr8P_tqin6RkgWGm4SIDdK5s2TAJebzQEBUwuY9j3aC',\n\n            crypto = window.crypto || window.msCrypto || (typeof require === \"function\" && require('crypto')),\n\n            randomByte = () => {\n                /* istanbul ignore next: platform diffs out of scope */\n                if (crypto && crypto.randomBytes) {\n                    return crypto.randomBytes(1)[0] & 0x30;\n                } else if (!crypto || !crypto.getRandomValues) {\n                    return Math.floor(Math.random() * 256) & 0x30;\n                }\n                /* istanbul ignore next: platform diffs out of scope */\n                const dest = new Uint8Array(1);\n                /* istanbul ignore next: platform diffs out of scope */\n                crypto.getRandomValues(dest);\n                /* istanbul ignore next: platform diffs out of scope */\n                return dest[0] & 0x30;\n            },\n\n            encode = (number) => {\n                let loopCounter = 0,\n                    done,\n                    str = '';\n\n                while (!done) {\n                    str = str + shuffled[ ( (number >> (4 * loopCounter)) & 0x0f ) | randomByte() ];\n                    done = number < (Math.pow(16, loopCounter + 1 ) );\n                    loopCounter++;\n                }\n                return str;\n            },\n\n            // Ignore all milliseconds before a certain time to reduce the size of the date entropy without sacrificing uniqueness.\n            // This number should be updated every year or so to keep the generated id short.\n            // To regenerate `new Date() - 0` and bump the version. Always bump the version!\n\n            REDUCE_TIME = 1490384907498,\n            version = 7;\n\n        let counter,\n            previousSeconds;\n\n        clusterWorkerId = clusterWorkerId || 0;\n\n        return function() {\n            let str = '',\n                seconds = Math.floor(((new Date()).getTime() - REDUCE_TIME) * 0.001);\n\n            if (seconds === previousSeconds) {\n                counter++;\n            } else {\n                counter = 0;\n                previousSeconds = seconds;\n            }\n\n            str = str + encode(version) + encode(clusterWorkerId);\n            if (counter > 0) {\n                str = str + encode(counter);\n            }\n            str = str + encode(seconds);\n\n            return str;\n        };\n    })();\n\n    /**\n     * Gets the best URL for where we are operating\n     * @returns {string|*}\n     */\n    okanjo.util.getLocation = () => {\n        /* istanbul ignore if: hard to reproduce in jsdom at the moment */\n        if (window.location !== window.parent.location) {\n            // attempt to see if the frame is friendly and get the parent\n            try {\n                return window.parent.location.href;\n            } catch (e) {\n                // Not friendly :(\n            }\n\n            // prefer the frame referrer (at least the same as the origin site) over the ad server url\n            if (document.referrer) return document.referrer;\n            return document.referrer;\n        }\n\n        // Direct on page or frame is goofy\n        return window.location.href\n    }\n\n    //endregion\n\n    //region User Interface\n\n    okanjo.ui = {\n\n        /**\n         * Gets the current page scroll position\n         * @returns {{x: Number, y: Number}}\n         */\n        getScrollPosition: () => {\n            return {\n                x: SUPPORTS_PAGE_OFFSET ? window.pageXOffset : /* istanbul ignore next: old browsers */ CSS1_COMPATIBLE ? document.documentElement.scrollLeft : document.body.scrollLeft,\n                y: SUPPORTS_PAGE_OFFSET ? window.pageYOffset : /* istanbul ignore next: old browsers */ CSS1_COMPATIBLE ? document.documentElement.scrollTop : document.body.scrollTop\n            };\n        },\n\n        /**\n         * Gets the height and width of the given element\n         * @param {HTMLElement|Node} element  The DOM element to get the size of\n         * @param {boolean} [includeMargin]  Whether to include the margins of the element in the size\n         * @returns {{height: number, width: number}}\n         */\n        getElementSize: (element, includeMargin) => {\n            const size = {\n                height: element.offsetHeight,\n                width : element.offsetWidth\n            };\n            const style = element.currentStyle || window.getComputedStyle(element);\n\n            if (includeMargin) {\n                size.height += parseInt(style.marginTop) + parseInt(style.marginBottom);\n                size.width += parseInt(style.marginLeft) + parseInt(style.marginRight);\n            }\n\n            return size;\n        },\n\n        /**\n         * Gets the current page size\n         * @return {{w: number, h: number}}\n         */\n        getPageSize: () => {\n            const body = document.querySelector('body');\n            const html = document.documentElement;\n\n            return {\n                w: Math.max(\n                    body.scrollWidth,\n                    body.offsetWidth,\n                    html.clientWidth,\n                    html.scrollWidth,\n                    html.offsetWidth\n                ),\n\n                h: Math.max(\n                    body.scrollHeight,\n                    body.offsetHeight,\n                    html.clientHeight,\n                    html.scrollHeight,\n                    html.offsetHeight\n                )\n            };\n        },\n\n        /**\n         * Gets the current viewport size\n         * @return {{vw: number, vh: number}}\n         */\n        getViewportSize: () => {\n            const element = CSS1_COMPATIBLE ? document.documentElement : /* istanbul ignore next: browser diffs */ document.body;\n            const width = element.clientWidth;\n            const height = element.clientHeight;\n            const inWidth = window.innerWidth || /* istanbul ignore next: browser diffs */ 0;\n            const inHeight = window.innerHeight || /* istanbul ignore next: browser diffs */ 0;\n            const isMobileZoom = (inWidth && width > inWidth) || (inHeight && height > inHeight);\n\n            return {\n                vw: isMobileZoom ? /* istanbul ignore next: browser diffs */ inWidth : width,\n                vh: isMobileZoom ? /* istanbul ignore next: browser diffs */ inHeight : height\n            };\n        },\n\n        /**\n         * Gets the x, y location of the event relative to the page\n         * @param event  Mouse/Touch Event\n         * @return {{ex: number, ey: number}}\n         */\n        getEventPosition: (event) => {\n            const ex = event.pageX;\n            const ey = event.pageY;\n            const body = document.body;\n            const el = document.documentElement;\n            const scrollLeft = 'scrollLeft';\n            const scrollTop = 'scrollTop';\n            const type = event.__proto__.constructor.name;\n\n            return {\n                et: type, // mouse? touch? keyboard? robot?\n                ex: ex === undefined /* istanbul ignore next: browser diffs */ ? event.clientX + body[scrollLeft] + el[scrollLeft] : ex,\n                ey: ey === undefined /* istanbul ignore next: browser diffs */ ? event.clientY + body[scrollTop] + el[scrollTop] : ey\n            };\n        },\n\n        /**\n         * Gets the element's rectangle coordinates on the page\n         * @param element\n         * @return {{x1: number, y1: number, x2: number, y2: number}}\n         */\n        getElementPosition: (element) => {\n\n            // Wrapped in try-catch because IE is super strict about the\n            // element being on the DOM before you call this. Other browsers\n            // let it slide, but oh well.\n\n            const err = 'Could not get position of element. Did you attach the element to the DOM before initializing?';\n            try {\n                let rect = element.getBoundingClientRect();\n                let body = document.body.getBoundingClientRect();\n                let domFailed = !document.body.contains(element);\n                // let pos = okanjo.ui.getScrollPosition();\n\n                /* istanbul ignore else: jsdom doesn't mock this */\n                if (domFailed) {\n                    okanjo.report(err, element);\n                }\n                return {\n                    // x1: rect.left + pos.x,\n                    // y1: rect.top + pos.y,\n                    // x2: rect.right + pos.x,\n                    // y2: rect.bottom + pos.y\n\n                    // This might fix\n                    x1: rect.left - body.left,\n                    y1: rect.top - body.top,\n                    x2: rect.right - body.left,\n                    y2: rect.bottom - body.top,\n                    err: domFailed ? 2 : 0\n                };\n            } catch (e) {\n                okanjo.report(err, { exception: e, element });\n                return {\n                    x1: 0,\n                    y1: 0,\n                    x2: 0,\n                    y2: 0,\n                    err: 1\n                };\n            }\n        },\n\n        /**\n         * Gets the intersection information given the element, viewport and scroll positions\n         * @param e  Element position\n         * @param s - Scroll position\n         * @param v - Viewport size\n         * @return {{intersectionArea: number, elementArea: number}}\n         * @private\n         */\n        _getIntersection: (e, s, v) => {\n            let iLeft = Math.max(e.x1, s.x),\n                iRight = Math.min(e.x2, s.x+v.vw),\n                iTop = Math.max(e.y1, s.y),\n                iBottom = Math.min(e.y2, s.y+v.vh),\n\n                intersectionArea = Math.max(0, iRight - iLeft) * Math.max(0, iBottom - iTop),\n                elementArea = (e.x2 - e.x1) * (e.y2 - e.y1);\n\n            return {\n                intersectionArea,\n                elementArea\n            };\n        },\n\n        /**\n         * Checks whether the element is actually displayed on the DOM\n         * @param element\n         * @return {boolean}\n         */\n        isElementVisible: (element) => {\n            /* istanbul ignore next: jsdom won't trigger this */\n            return element.offsetWidth > 0 && element.offsetHeight > 0;\n        },\n\n        /**\n         * Gets the percentage of the element pixels currently within the viewport\n         * @param {HTMLElement|Node} element\n         * @returns {{intersectionArea: number, percentage: number, elementArea: number}|{intersectionArea: null, percentage: number, elementArea: null}}\n         */\n        getPercentageInViewport: (element) => {\n            let e = okanjo.ui.getElementPosition(element),\n                s = okanjo.ui.getScrollPosition(),\n                v = okanjo.ui.getViewportSize();\n\n            // If there was a problem getting the element position, fail fast\n            if (e.err) return {\n                percentage: 0,\n                elementArea: null,\n                intersectionArea: null,\n                err: true\n            };\n\n            // Get intersection rectangle\n            let { intersectionArea, elementArea } = okanjo.ui._getIntersection(e,s,v);\n\n            // Don't let it return NaN\n            /* istanbul ignore else: jsdom no love positional data */\n            if (elementArea <= 0) return {\n                percentage: 0,\n                elementArea,\n                intersectionArea\n            };\n\n            /* istanbul ignore next: jsdom no love positional data, area tested with helper fn tho */\n            return {\n                percentage: intersectionArea / elementArea,\n                elementArea,\n                intersectionArea\n            };\n        }\n    };\n\n    /**\n     * Splits the text in the element to fit within the visible height of its container, and separates with an ellipses\n     * @param {HTMLElement|Node} element  The DOM element containing the text to fit\n     * @param {HTMLElement} [container]  Optional container to compute fit on. Defaults to the element's parent\n     */\n    okanjo.ui.ellipsify = function(element, container) {\n\n        // It's a sad day when you have to resort to JS because CSS kludges are too hacky to work down to IE8, programmatically\n\n        //noinspection JSValidateTypes\n        const parent = container || element.parentNode,\n            targetHeight = okanjo.ui.getElementSize(parent).height,\n            useTextContent = element.textContent !== undefined;\n\n        let text = useTextContent ? element.textContent : /* istanbul ignore next: browser diffs */ element.innerText,\n            replacedText = \"\",\n            safety = 5000, // Safety switch to bust out of the loop in the event something goes terribly wrong\n            replacer = /* istanbul ignore next: n/a to jsdom */ (match) => {\n                replacedText = match.substring(0, match.length-3) + replacedText;\n                return '...';\n            };\n\n        // Trim off characters until we can fit the text and ellipses\n        // If the text already fits, this loop is ignored\n        /* istanbul ignore next: jsdom doesn't do element size computing stuff */\n        while (okanjo.ui.getElementSize(element).height > targetHeight && text.length > 0 && (safety-- > 0)) {\n            text = useTextContent ? element.textContent : element.innerText;\n\n            text = text.replace(ELLIPSIFY_PATTERN, replacer);\n\n            if (useTextContent) {\n                element.textContent = text;\n            } else {\n                element.innerText = text;\n            }\n        }\n\n        // If there is work to do, split the content into two span tags\n        // Like so: [content]...[hidden content]\n        /* istanbul ignore if: n/a to jsdom */\n        if (replacedText.length > 0) {\n\n            let content = document.createElement('span'),\n                span = document.createElement('span');\n\n            content.setAttribute('class','okanjo-ellipses');\n            span.setAttribute('class','okanjo-visually-hidden');\n\n            if (useTextContent) {\n                content.textContent = text.substring(0, text.length-3);\n                span.textContent = replacedText;\n            } else {\n                content.innerText = text.substring(0, text.length-3);\n                span.innerText = replacedText;\n            }\n\n            element.innerHTML = '';\n            element.appendChild(content);\n            element.appendChild(span);\n        }\n\n    };\n\n    /**\n     * Locates images with the class okanjo-fit and ensures that they get filled.\n     * This is basically a object-fit hacky workaround\n     * @param element\n     */\n    okanjo.ui.fitImages = function(element) {\n        // Detect objectFit support\n        /* istanbul ignore if: jsdom has objectFit defined and refuses to let you hack it */\n        if (!('objectFit' in document.documentElement.style)) {\n            // Find images to fit\n            element.querySelectorAll('img.okanjo-fit').forEach((img) => {\n\n                // Hide the image\n                img.style.display = 'none';\n\n                // Update the parent w/ the background\n                let parent = img.parentNode;\n                parent.style.backgroundSize = 'cover';\n                parent.style.backgroundImage = 'url('+img.src+')';\n                parent.style.backgroundposition = 'center center';\n            });\n        }\n    };\n\n    /**\n     * Returns the SVG content for an article icon\n     * @return {string}\n     */\n    okanjo.ui.articleSVG = function() {\n        return `<svg version=\"1.1\" id=\"Layer_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" viewBox=\"0 0 48 48\" style=\"enable-background:new 0 0 48 48;\" xml:space=\"preserve\"> <g id=\"newspaper_1_\"> <g id=\"newspaper_2_\"> <path id=\"newspaper_6_\" d=\"M21.5,23h-5c-0.276,0-0.5-0.224-0.5-0.5v-5c0-0.276,0.224-0.5,0.5-0.5h5c0.276,0,0.5,0.224,0.5,0.5v5 C22,22.776,21.776,23,21.5,23z M37,32c0,1.654-1.346,3-3,3h-2H15c-1.654,0-3-1.346-3-3V14c0-0.552,0.448-1,1-1h17 c0.552,0,1,0.448,1,1v18c0,0.552,0.449,1,1,1h2c0.551,0,1-0.448,1-1V17h-1v14.75c0,0.138-0.112,0.25-0.25,0.25h-1.5 C32.112,32,32,31.888,32,31.75V16c0-0.552,0.448-1,1-1h3c0.552,0,1,0.448,1,1v1V32z M15,33h14.184C29.072,32.686,29,32.352,29,32 V15H14v17C14,32.552,14.449,33,15,33z M26.5,19h-2c-0.276,0-0.5-0.224-0.5-0.5v-1c0-0.276,0.224-0.5,0.5-0.5h2 c0.276,0,0.5,0.224,0.5,0.5v1C27,18.776,26.776,19,26.5,19z M26.5,23h-2c-0.276,0-0.5-0.224-0.5-0.5v-1c0-0.276,0.224-0.5,0.5-0.5 h2c0.276,0,0.5,0.224,0.5,0.5v1C27,22.776,26.776,23,26.5,23z M26.5,27h-10c-0.276,0-0.5-0.224-0.5-0.5v-1 c0-0.276,0.224-0.5,0.5-0.5h10c0.276,0,0.5,0.224,0.5,0.5v1C27,26.776,26.776,27,26.5,27z M26.5,31h-10 c-0.276,0-0.5-0.224-0.5-0.5v-1c0-0.276,0.224-0.5,0.5-0.5h10c0.276,0,0.5,0.224,0.5,0.5v1C27,30.776,26.776,31,26.5,31z\"/> </g> </g> </svg>`;\n    };\n\n    /**\n     * Returns the SVG content for a product icon\n     * @return {string}\n     */\n    okanjo.ui.productSVG = function () {\n        return `<svg id=\"glyphicons-basic\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 32 32\"> <path id=\"cart\" d=\"M13,26.5A1.5,1.5,0,1,1,11.5,25,1.5,1.5,0,0,1,13,26.5ZM21.5,25A1.5,1.5,0,1,0,23,26.5,1.5,1.5,0,0,0,21.5,25ZM27.96436,8.82544l-2,9A1.49988,1.49988,0,0,1,24.5,19H11.77l.4375,2H23a1,1,0,0,1,1,1v1a1,1,0,0,1-1,1H11a1.5,1.5,0,0,1-1.46533-1.17944L6.29248,8H4A1,1,0,0,1,3,7V6A1,1,0,0,1,4,5H7.5A1.49993,1.49993,0,0,1,8.96533,6.17944L9.14484,7H26.5a1.50029,1.50029,0,0,1,1.46436,1.82544ZM24.62988,10H9.80115l1.31256,6H23.29688Z\"/></svg>`;\n    }\n\n    /**\n     * Returns the inline SVG src attribute\n     * @param svg\n     * @return {string}\n     */\n    okanjo.ui.inlineSVG = function(svg) {\n        return 'data:image/svg+xml;base64,' + btoa('<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>' + svg);\n    };\n\n    //endregion\n\n    // Export the root namespace\n    return window.okanjo = okanjo;\n\n})(window, document);","\"use strict\";\n\n(function(window) {\n\n    const JSON_TEST = /^application\\/json/;\n    const okanjo = window.okanjo;\n\n    /**\n     * Performs a reliable XHR request\n     * @param {string} method - Request method\n     * @param {string} url - URL\n     * @param [payload] optional payload\n     * @param callback Fired on when completed (err, res), normalized to standard response format\n     */\n    okanjo.net.request = function (method, url, payload, callback) {\n\n        // payload is not required\n        if (typeof payload === \"function\") {\n            callback = payload;\n            payload = undefined;\n        }\n\n        // Create a new instance\n        const req = new (window.XMLHttpRequest || /* istanbul ignore next: old ie */ window.ActiveXObject)('MSXML2.XMLHTTP.3.0');\n\n        // Flag to prevent duplicate callbacks / races\n        let calledBack = false;\n\n        // Normalized done handler\n        const done = function(err, res) {\n            /* istanbul ignore else: out of scope */\n            if (!calledBack) {\n                calledBack = true;\n                callback(err, res);\n            }\n        };\n\n        // Apply timeout if configured globally\n        if (okanjo.net.request.timeout) {\n            req.timeout = okanjo.net.request.timeout;\n        }\n\n        // Catch timeout errors\n        req.ontimeout = function(e) {\n            /* istanbul ignore next: idk if jsdom can mock this, also readystatechange may fire before this anyway */\n            done({\n                statusCode: 504,\n                error: \"Request timed out\",\n                message: 'Something went wrong',\n                attributes: {\n                    event: e,\n                    xhr: req\n                }\n            });\n        };\n\n        // Handle the response\n        req.onreadystatechange = function(e) {\n            // 4 = completed / failed\n            if (req.readyState === 4) {\n                // Do we have a response?\n                if (req.status > 0) {\n                    let res;\n\n                    // Check if we got JSON and parse it right away\n                    if (JSON_TEST.test(req.getResponseHeader('Content-Type'))) {\n                        res = JSON.parse(req.responseText);\n                    } else {\n                        // Not JSON, normalize it instead\n                        res = {\n                            statusCode: req.status,\n                            data: req.responseText\n                        };\n                    }\n\n                    // Put the response in the proper slot (err for non success responses)\n                    if (req.status >= 200 && req.status < 300) {\n                        done(null, res);\n                    } else {\n                        done(res);\n                    }\n                } else {\n                    // Request failed - e.g. CORS or network issues\n                    done({\n                        statusCode: 503,\n                        error: \"Request failed\",\n                        message: 'Something went wrong',\n                        attributes: {\n                            event: e,\n                            xhr: req\n                        }\n                    });\n                }\n            }\n        };\n\n        // Open the request\n        req.open(method.toUpperCase(), url);\n\n        // Include credentials\n        req.withCredentials = true;\n\n        // Handle post payloads\n        if (['POST','PUT','PATCH'].includes(method.toUpperCase())) {\n            req.setRequestHeader('Content-Type', 'application/json; charset=utf-8');\n            if (payload !== undefined) {\n                payload = JSON.stringify(payload);\n            }\n        }\n\n        // Ship it\n        req.send(payload || undefined);\n    };\n\n    // Bind helpers to make things easy as pie\n    okanjo.net.request.get = okanjo.net.request.bind(this, 'GET');\n    okanjo.net.request.post = okanjo.net.request.bind(this, 'POST');\n    okanjo.net.request.put = okanjo.net.request.bind(this, 'PUT');\n    okanjo.net.request.delete = okanjo.net.request.bind(this, 'DELETE');\n\n    /**\n     * Helper to aid in minificiation+querystringify and redundant encodeURIComponent stuff\n     * @param val\n     * @return {*}\n     */\n    const encode = (val) => {\n        if (val === null || val === undefined) return '';\n        return encodeURIComponent(''+val);\n    };\n\n    /**\n     * Helper to aid in getting a query string key using a prefix and keyname\n     * @param key\n     * @param keyPrefix\n     * @return {*}\n     */\n    const getKey = (key, keyPrefix) => {\n        if (keyPrefix) {\n            return `${keyPrefix}[${encode(key)}]`;\n        } else {\n            return encode(key)\n        }\n    };\n\n    /**\n     * Super basic querystringify helper. It handles deep objects, but not for array values\n     * @param obj\n     * @param [keyPrefix]\n     * @return {string}\n     */\n    okanjo.net.request.stringify = (obj, keyPrefix) => {\n        let pairs = [];\n        keyPrefix = keyPrefix || \"\";\n        Object.keys(obj).forEach((key) => {\n            let value = obj[key];\n            if (Array.isArray(value)) {\n                value.forEach((v) => pairs.push(getKey(key, keyPrefix) + '=' + encode(v))); // Does not do that PHP garbage with key[]=val\n            } else if (typeof value === \"object\" && value !== null) {\n                // Recurse\n                let res = okanjo.net.request.stringify(value, getKey(key, keyPrefix));\n                if (res) pairs.push(res);\n            } else if (value !== undefined) {\n                pairs.push(getKey(key, keyPrefix) + '=' + encode(value));\n            }\n        });\n        return pairs.join('&');\n    };\n\n})(window);","\"use strict\";\n\n//noinspection ThisExpressionReferencesGlobalObjectJS\n(function(window, document) {\n\n    /**\n     * Okanjo cookie utility helpers\n     */\n    window.okanjo.util.cookie = {\n\n        /**\n         * Sets a cookie\n         * @param cookieName\n         * @param value\n         * @param expireDays\n         */\n        set: (cookieName, value, expireDays) => {\n            const expireDate = new Date();\n            expireDate.setDate(expireDate.getDate() + expireDays);\n            const expires = expireDays ? \" Expires=\" + expireDate.toUTCString() + \";\" : \"\";\n            const path = \" Path=/\";\n            const secure = window.location.protocol === 'https:' ? ' Secure;' : '';\n            // const secure = ' Secure;';\n            const cookieValue = `${encodeURI(value)};${expires}${secure} SameSite=None;${path}`;\n            // console.log('setting cookie', cookieName, cookieValue)\n            document.cookie = cookieName + \"=\" + cookieValue;\n        },\n\n        /**\n         * Gets a cookie\n         * @param cookieName\n         * @return {*}\n         */\n        get: (cookieName) => {\n            let output = null;\n            document.cookie\n                .split(\";\")\n                .find((cookie) => {\n                    let nameTest = cookie.substr(0, cookie.indexOf(\"=\")).trim();\n                    let value = cookie.substr(cookie.indexOf(\"=\") + 1);\n                    if (nameTest === cookieName) {\n                        output = decodeURI(value);\n                        return true;\n                    } else {\n                        return false;\n                    }\n                })\n            ;\n            return output;\n        }\n    };\n\n})(window, document);","\"use strict\";\n\n//noinspection JSUnusedLocalSymbols,ThisExpressionReferencesGlobalObjectJS\n(function(window, document) {\n\n    const okanjo = window.okanjo;\n\n    /**\n     * UI Rendering Engine\n     */\n    class TemplateEngine {\n\n        constructor() {\n\n            // Load initial templates from options\n            this._templates = {};\n            this._css = {};\n\n            // Hook point for adding custom styles to ui elements\n            this.classDetects = '';\n        }\n\n        /**\n         * Registers a template for use\n         * @param name\n         * @param template\n         * @param beforeRender\n         * @param options\n         */\n        registerTemplate(name, template, beforeRender, options) {\n\n            if (typeof template === \"object\") {\n                //noinspection JSValidateTypes\n                if (template.nodeType === undefined) {\n                    throw new Error('Parameter template must be a string or a DOM element');\n                } else {\n                    template = template.innerHTML;\n                    okanjo.lib.Mustache.parse(template);\n                }\n            } else if (typeof template !== \"string\") {\n                throw new Error('Parameter template must be a string or a DOM element');\n            }\n\n            // Shift options if only have 3 params\n            if (arguments.length === 3 && typeof beforeRender === \"object\") {\n                options = beforeRender;\n                beforeRender = null;\n            } else {\n                options = options || {};\n            }\n\n            if (beforeRender && typeof beforeRender !== \"function\") {\n                throw new Error('Parameter beforeRender must be a function');\n            }\n\n            // Assign the template\n            this._templates[name] = {\n                markup: template,\n                options,\n                beforeRender\n            };\n        }\n\n        /**\n         * Registers a CSS payload for use\n         * @param name\n         * @param css\n         * @param options\n         */\n        registerCss(name, css, options) {\n            options = options || {};\n\n            if (typeof css === \"object\") {\n                //noinspection JSValidateTypes\n                if (css.nodeType === undefined) {\n                    throw new Error('Parameter css must be a string or a DOM element');\n                }\n            } else if (typeof css !== \"string\") {\n                throw new Error('Parameter css must be a string or a DOM element');\n            }\n\n            this._css[name] = {\n                markup: css,\n                options: options\n            };\n        }\n\n        /**\n         * Checks whether a template is registered\n         * @param name\n         * @return {boolean}\n         */\n        isTemplateRegistered(name) {\n            return !!this._templates[name];\n        }\n\n        //noinspection JSUnusedGlobalSymbols\n        /**\n         * Checks whether a CSS payload is registered\n         * @param name\n         * @return {boolean}\n         */\n        isCssRegistered(name) {\n            return !!this._css[name];\n        }\n\n        /**\n         * Ensures that a CSS payload has been added to the DOM\n         * @param name\n         */\n        ensureCss(name) {\n            if (this._css[name]) {\n                //noinspection JSValidateTypes\n                const css = this._css[name],\n                    id = css.markup.nodeType === undefined ? css.options.id || \"okanjo-css-\" + name : null; // If it's a DOM element, just forget it cuz it's already on the page\n\n                // Check for css element on page, if we have an ID to look for\n                if (id) {\n                    const element = document.querySelector('#' + id.replace(/\\./g, '\\\\.'));\n                    if (!element) {\n                        const head = document.head,\n                            style = document.createElement('style');\n\n                        style.id = id;\n                        style.setAttribute('type', 'text/css');\n\n                        /* istanbul ignore else: old ie */\n                        if (style.hasOwnProperty) { // old ie\n                            style.textContent = css.markup;\n                        } else {\n                            style.styleSheet.cssText = css.markup;\n                        }\n\n                        if (head) {\n                            head.appendChild(style);\n                        } else {\n                            // NO HEAD, just prepend to body then\n                            const body = document.body;\n                            if (body) {\n                                body.appendChild(style);\n                            } else {\n                                // And if this doesn't work, just give up\n                                okanjo.report('Cannot add CSS template to document. Does it not have a body or head?');\n                            }\n                        }\n                    }\n                }\n            } else {\n                okanjo.report('Attempted to add CSS template \"'+name+'\" to the DOM, however it does not appear to be registered?');\n            }\n        }\n\n        /**\n         * Ensures that a custom CSS stylesheet has been added to the DOM\n         * @param url\n         */\n        ensureExternalCss(url) {\n            const id = 'okanjo-custom-css-'+url;\n            if (document.getElementById(id)) return;\n\n            const head = document.head,\n                link = document.createElement('link');\n\n            link.id = id;\n            link.setAttribute('rel', 'stylesheet');\n            link.setAttribute('href', url);\n\n            if (head) {\n                head.appendChild(link);\n            } else {\n                // NO HEAD, just prepend to body then\n                const body = document.body;\n                if (body) {\n                    body.appendChild(link);\n                } else {\n                    // And if this doesn't work, just give up\n                    okanjo.report('Cannot add custom CSS stylesheet to document. Does it not have a body or head?');\n                }\n            }\n        }\n\n        /**\n         * Renders a template and returns the markup\n         * @param templateName\n         * @param context\n         * @param model\n         * @return {string}\n         */\n        render(templateName, context, model) {\n\n            model = model || {};\n            const template = this._templates[templateName];\n\n            // If there's a data controller closure set, and if so, run the data through there\n            if (template.beforeRender) {\n                model = template.beforeRender.call(context, model);\n            }\n\n            // Attach globals\n            model.okanjo = okanjo;\n            model.okanjoMetricUrl = okanjo.net.endpoint.replace(/^https?:\\/\\//,''); // Url w/o scheme to prevent mixed-content warnings\n            model.now = function() { return (new Date()).getTime(); };\n            model.classDetects = this.classDetects;\n\n            //noinspection JSUnresolvedVariable\n            if (model.blockClasses && Array.isArray(model.blockClasses)) {\n                model.classDetects += \" \" + model.blockClasses.join(' ');\n                delete model.blockClasses;\n            }\n\n            // Add CSS unless we are told not to\n            if (model.css !== false && template.options.css && template.options.css.length > 0) {\n                template.options.css.forEach((css) => this.ensureCss(css));\n                delete model.css;\n            }\n\n            // Render the template and return the result\n            return okanjo.lib.Mustache.render(template.markup, model);\n        }\n\n    }\n\n    /**\n     * Formats a number into a currency string (rounded, decimal points, thousands separators)\n     * See: http://stackoverflow.com/questions/149055/how-can-i-format-numbers-as-money-in-javascript\n     *\n     * @param value  the number to format\n     * @param [decimals] - The number of decimals to show\n     * @param [decimalSeparator]  The decimals separator, default: .\n     * @param [thousandsSeparator]  The thousands separator, default: ,\n     * @returns {string}  Formatted currency string\n     */\n    TemplateEngine.formatCurrency = (value, decimals=2, decimalSeparator='.', thousandsSeparator=',') => {\n        const s = value < 0 ? \"-\" : \"\",\n            i = parseInt(value = Math.abs(+value || 0).toFixed(decimals)) + \"\";\n        let j = i.length;\n        j = (j) > 3 ? j % 3 : 0;\n        return s + (j ? i.substr(0, j) + thousandsSeparator : \"\") + i.substr(j).replace(/(\\d{3})(?=\\d)/g, \"$1\" + thousandsSeparator) + (decimals ? decimalSeparator + Math.abs(value - i).toFixed(decimals).slice(2) : \"\");\n    };\n\n    // Export\n    okanjo.ui.engine = new TemplateEngine();\n\n})(window, document);","\"use strict\";\n\n//noinspection ThisExpressionReferencesGlobalObjectJS,JSUnusedLocalSymbols\n(function(window, document) {\n\n    /*\n\n     div .modal-container .fade-out .hidden\n     | div .modal-window .clearfix\n     | |\n     | | div .modal-window-skin\n     | | | div .modal-window-outer\n     | | | | div .modal-window-inner\n     | | | | | iframe .okanjo-inline-buy-frame\n     | | | | /div\n     | | | /div\n     | | /div\n     | |\n     | | div .close-button\n     | | | \n     | | /div\n     | |\n     | /div\n     /div\n\n     */\n\n    const okanjo = window.okanjo;\n    const IS_MOBILE = okanjo.util.isMobile();\n\n    let initialized = false,\n        // scrollY = null,\n\n        // Selectors\n        $html, $body, $modalContainer, $modalWindow, $modalSkin, $modalOuter, $modalInner, $modalClose, $modalFrame,\n\n        createElements = function() {\n\n            // Page elements\n            //noinspection JSUnresolvedFunction\n            $html = document.documentElement || /* istanbul ignore next: old browsers */ document.querySelector('html');\n            //noinspection JSUnresolvedFunction\n            $body = document.body || /* istanbul ignore next: old browsers */ document.querySelector('body');\n\n            // Modal elements\n            $modalContainer = document.createElement('div');\n            $modalWindow = document.createElement('div');\n            $modalSkin = document.createElement('div');\n            $modalOuter = document.createElement('div');\n            $modalInner = document.createElement('div');\n            $modalClose = document.createElement('div');\n            $modalFrame = document.createElement('iframe');\n\n            $modalContainer.setAttribute('class', 'okanjo-modal-container okanjo-modal-hidden ' /*+ okanjo.util.detectClasses().join(' ')*/);\n            $modalWindow.setAttribute('class', 'okanjo-modal-window');\n            $modalSkin.setAttribute('class', 'okanjo-modal-window-skin');\n            $modalOuter.setAttribute('class', 'okanjo-modal-window-outer');\n            $modalInner.setAttribute('class', 'okanjo-modal-window-inner');\n            $modalClose.setAttribute('class', 'okanjo-modal-close-button');\n\n            $modalFrame.setAttribute('class', 'okanjo-inline-buy-frame');\n            $modalFrame.setAttribute('frameborder', '0');\n            $modalFrame.setAttribute('vspace', '0');\n            $modalFrame.setAttribute('hspace', '0');\n            $modalFrame.setAttribute('webkitallowfullscreen', '');\n            $modalFrame.setAttribute('mozallowfullscreen', '');\n            $modalFrame.setAttribute('allowfullscreen', '');\n            $modalFrame.setAttribute('scrolling', 'auto');\n\n            $modalClose.innerHTML = '';\n\n            // Create the modal element tree\n            $modalInner.appendChild($modalFrame);\n            $modalOuter.appendChild($modalInner);\n            $modalSkin.appendChild($modalOuter);\n            $modalWindow.appendChild($modalSkin);\n            $modalWindow.appendChild($modalClose);\n            $modalContainer.appendChild($modalWindow);\n\n            // Add the modal stuff to the body\n            $body.appendChild($modalContainer);\n        },\n\n        addListener = function(el, event, handler) {\n            /* istanbul ignore else: old browsers */\n            if (el.addEventListener) {\n                el.addEventListener(event, handler, false);\n            } else {\n                el.attachEvent(\"on\" + event, handler);\n            }\n        },\n\n        getWindowHeight = function() {\n            return window.innerHeight || /* istanbul ignore next: old browsers */ document.documentElement.clientHeight;\n        },\n\n        handleReposition = function() {\n            // scrollY = okanjo.ui.getScrollPosition().y;\n            //$modalWindow.style.marginTop = scrollY + 40 + \"px\";\n            $modalWindow.style.height = (getWindowHeight() - 80) + \"px\";\n        },\n\n        bindEvents = function() {\n\n            // If the device orientation changes, adjust the modal view port\n            addListener(window, 'orientationchange', function() {\n                for (let t = 0; t < 2; t++) {\n                    setTimeout(handleReposition, 1000 * t + 10);\n                }\n            });\n\n            // If the window changes size, also adjust the modal view port\n            addListener(window, 'resize', function() {\n                setTimeout(handleReposition, 100);\n            });\n\n            // Click the overlay to close the modal\n            addListener($modalContainer, 'click', closeModal);\n\n            // If you click in the modal, don't close it!\n            addListener($modalWindow, 'click', function(e) {\n                e.preventDefault();\n                e.stopPropagation();\n            });\n\n            // Click the close button to close it\n            addListener($modalClose, 'click', function(e) {\n\n                // Don't close it twice\n                e.preventDefault();\n                e.stopPropagation();\n\n                closeModal();\n            });\n\n        },\n\n        //removeListener = function(el, event, handler) {\n        //    if (el.removeEventListener) {\n        //        el.removeEventListener(event, handler);\n        //    } else {\n        //        el.detachEvent(\"on\" + event, handler);\n        //    }\n        //},\n\n        addClass = function(el, name) {\n            el.className += \" \" + name;\n        },\n\n        removeClass = function(el, name) {\n            el.className = el.className.replace(new RegExp(' *?'+name), '');\n        },\n\n        openModal = function() {\n\n            // scrollY = document.body.scrollTop;\n\n            removeClass($modalContainer, 'okanjo-modal-hidden');\n            addClass($modalContainer, 'okanjo-modal-fade-out');\n\n            handleReposition();\n\n            addClass($html, \"okanjo-modal-active\");\n\n            if (!IS_MOBILE) {\n                addClass($html, \"okanjo-modal-margin-fix\");\n            }\n\n            setTimeout(function() {\n                removeClass($modalContainer, 'okanjo-modal-fade-out');\n            }, 10);\n\n            // Click the overlay to close the modal\n            //addListener($body, 'click', closeModal);\n\n        },\n\n        closeModal = function() {\n            addClass($modalContainer, 'okanjo-modal-fade-out');\n\n            setTimeout(function() {\n                removeClass($modalContainer, 'okanjo-modal-fade-out');\n                addClass($modalContainer, \"okanjo-modal-hidden\");\n\n                removeClass($html, \"okanjo-modal-active\");\n                if (!IS_MOBILE) {\n                    removeClass($html, \"okanjo-modal-margin-fix\");\n                }\n            }, 210);\n\n            // Click the overlay to close the modal\n            //removeListener($body, 'click', closeModal);\n        },\n\n        /**\n         * Insert an element or markup into the modal\n         * @param content\n         */\n        setContent = function(content) {\n\n            // Remove existing content\n            $modalInner.innerHTML = \"\";\n\n            // Insert new content\n            if (typeof content === \"string\") {\n                $modalInner.innerHTML = content;\n            } else {\n                $modalInner.appendChild(content);\n            }\n        };\n\n\n    // Expose the modal functions\n    okanjo.ui.modal = {\n\n        show: function(content) {\n\n            if (!initialized) {\n                initialized = true;\n                createElements();\n                bindEvents();\n            }\n\n            setContent(content);\n            openModal();\n        },\n\n        hide: function() {\n            closeModal();\n        }\n\n    };\n\n    return okanjo.ui.modal;\n\n})(window, document);","\"use strict\";\n\n//noinspection ThisExpressionReferencesGlobalObjectJS,JSUnusedLocalSymbols\n(function(window, document) {\n\n    const okanjo = window.okanjo;\n\n    /**\n     * Event tracking class\n     * @type {Metrics}\n     */\n    class Metrics {\n\n        //noinspection JSUnusedGlobalSymbols\n        constructor() {\n\n            /**\n             * Events queued here before submission\n             * @type {Array}\n             * @private\n             */\n            this._queue = this._getStoredQueue();\n            this._processTimeout = null; // queue event loop timeout pointer\n\n            /**\n             * Unique page grouping event identifier\n             */\n            this.pageId = okanjo.util.shortid();\n            this.defaultChannel = Metrics.Channel.external;\n\n            this.sid = null;\n            this.sourceCh = null;\n            this.sourceCx = null;\n\n            // Extract referral data, if set\n            this._checkUrlForReferral();\n\n            // TODO - look into iframe session correlation system\n        }\n\n        //noinspection JSMethodCanBeStatic\n        /**\n         * Gets the storage backed metric queue, in case we did not send everything last time\n         * @return {Array}\n         * @private\n         */\n        _getStoredQueue() {\n            if (window.localStorage[Metrics.Params.queue]) {\n                try {\n                    let queue = JSON.parse(window.localStorage[Metrics.Params.queue]);\n                    if (Array.isArray(queue)) {\n                        return queue;\n                    } else {\n                        okanjo.report('Stored queue is not a queue', {queue});\n                        return [];\n                    }\n                } catch (e) {\n                    okanjo.report('Failed to load metric queue from storage', {err: e});\n                    return [];\n                }\n            } else {\n                // not stored\n                return [];\n            }\n        }\n\n        /**\n         * Updates the queue stored in storage, in the event we can't complete our submissions\n         * @param delay - Whether to delay updating the queue for a bit, to let other metrics pile in\n         * @private\n         */\n        _saveQueue(delay) {\n            if (delay) {\n                if (this._saveQueueTimeout) clearTimeout(this._saveQueueTimeout);\n                this._saveQueueTimeout = setTimeout(() => {\n                    this._saveQueue(false);\n                    this._saveQueueTimeout = null;\n                }, 100);\n            } else {\n                window.localStorage[Metrics.Params.queue] = JSON.stringify(this._queue);\n            }\n        }\n\n        /**\n         * Extract contextual pass-through data from the URL, if present\n         * @private\n         */\n        _checkUrlForReferral() {\n            const pageArgs = okanjo.util.getPageArguments(true),\n                urlSid = pageArgs[Metrics.Params.name],\n                localSid = window.localStorage[Metrics.Params.name] || okanjo.util.cookie.get(Metrics.Params.name), // pull from storage or cookie\n                sourceContext = pageArgs[Metrics.Params.context],\n                sourceChannel = pageArgs[Metrics.Params.channel];\n\n            // If for some reason, both are set, record the incident as a possible correlation\n            if (urlSid && localSid && urlSid !== localSid) {\n                this.trackEvent({\n                    object_type: Metrics.Object.metric_session,\n                    event_type: Metrics.Event.correlation,\n                    id: urlSid+\"_\"+localSid,\n                    ch: this.defaultChannel,\n                    _noProcess: true\n                });\n            }\n\n            // Update local values\n            this.sid = localSid || urlSid || null; // prefer local over remote (changed in 1.0)\n            this.sourceCh = sourceChannel || null;\n            this.sourceCx = sourceContext || null;\n        }\n\n        /**\n         * Submits an individual event metric\n         * @param event\n         * @param callback\n         */\n        trackEvent(event, callback) {\n            // Ensure the event contains the required fields\n            if (!event.object_type || !event.event_type) {\n                okanjo.report('Invalid metric to track (missing object_type or event_type)', {event});\n                return;\n            }\n\n            // Queue the event for publishing\n            this._push(event, callback);\n        }\n\n        //noinspection JSUnusedGlobalSymbols\n        /**\n         * Submits a page view metric\n         * @param event\n         * @param callback\n         */\n        trackPageView(event, callback) {\n            event = event || {};\n            event.object_type = Metrics.Object.page;\n            event.event_type = Metrics.Event.view;\n            event.id = event.id || okanjo.util.getLocation();\n            event.ch = event.ch || this.defaultChannel;\n\n            // Queue the event for publishing\n            this.trackEvent(event, callback);\n        }\n\n        /**\n         * Adds an event to the queue\n         * @param event\n         * @param callback\n         * @private\n         */\n        _push(event, callback) {\n            this._queue.push({ event, callback });\n\n            // Save the queue\n            this._saveQueue(true);\n\n            // Start burning down the queue, unless the event says not to\n            if (event._noProcess) {\n                delete event._noProcess;\n            } else {\n                this._processQueue();\n            }\n        }\n\n        /**\n         * Burn down the queue\n         * @private\n         */\n        _processQueue() {\n            // If the queue is not already being processed, and there's stuff to process, continue sending them\n            if (!this._processTimeout && this._queue.length > 0) {\n                this._processTimeout = setTimeout(() => {\n\n                    // Pull the items we're going to batch out of the queue\n                    const items = this._queue.splice(0, 255);\n                    this._saveQueue(false);\n\n                    // Track the item\n                    this._batchSend(items, (err, res) => {\n                        // TODO: If there was an error, consider splicing the batch back into the queue\n\n                        // Update / Set the metric sid on the publisher\n                        /* istanbul ignore else: server barks */\n                        if (res && res.data && res.data.sid) this._updateSid(res.data.sid);\n\n                        // When this batch is done being tracked, iterate to the next metric then fire it's callback if set\n                        this._processTimeout = null;\n                        this._processQueue();\n\n                        // Fire the event callbacks if there are any\n                        items.forEach((item) => {\n                            item.callback && item.callback(err, res);\n                        });\n                    });\n\n                }, 0); // break event loop, maybe\n            }\n        }\n\n        /**\n         * Sends a bunch of queued metric events\n         * @param items\n         * @param callback\n         * @private\n         */\n        _batchSend(items, callback) {\n\n            // Normalize event data\n            const events = items.map((item) => {\n                this._normalizeEvent(item.event);\n\n                // Strip duplicated data from event batch\n                delete item.event.sid;\n                delete item.event.win;\n\n                return item.event;\n            });\n\n            const payload = {\n                events,\n                win: okanjo.util.getLocation()\n            };\n\n            const route = okanjo.net.getRoute(okanjo.net.routes.metrics_batch);\n\n            // Set sid if present\n            if (this.sid) {\n                payload.sid = this.sid;\n            }\n\n            // Send it\n            okanjo.net.request.post(\n                route,\n                payload,\n                (err, res) => {\n                    /* istanbul ignore if: out of scope */\n                    if (err) {\n                        okanjo.report('Failed to send metrics batch', { err, res, items, route });\n                    }\n                    callback && callback(err, res);\n                }\n            );\n        }\n\n        /**\n         * Normaizes events so that they contain consistent data values\n         * @param event\n         * @private\n         */\n        _normalizeEvent(event) {\n\n            // Ensure meta is ready to receive values\n            event.m = event.m || {};\n\n            // Set key\n            event.key = event.key || event.m.key || okanjo.key || undefined;\n\n            // Set session\n            if (this.sid) event.sid = this.sid;\n\n            // Clone the metadata, since it might be a direct reference to a widget property\n            // Deleting properties on the meta object, could be very destructive\n            event.m = Object.assign({}, event.m); // event.m should be flat\n\n            // Strip meta keys that should be excluded\n            // Object.keys(Metrics.Meta.exclude).forEach((key) => delete event.m[key]);\n            // ^ this is now done after flattening as an include-only model in v3.x+\n\n            // Set referral channel / context\n            if (this.sourceCh) { event.m.ref_ch = this.sourceCh; }\n            if (this.sourceCx) { event.m.ref_cx = this.sourceCx; }\n\n            // Set page group id\n            event.m.pgid = this.pageId;\n\n            // Set okanjo version\n            event.m.ok_ver = okanjo.version;\n\n            // Finalize metadata\n            event.m = okanjo.util.flatten(event.m, { arrayToCsv: true });\n\n            // Only send allowed meta keys - rest will get stripped\n            const allowedKeys= new Set(Metrics.Meta.include);\n            Object.keys(event.m).forEach(key => {\n                if (!allowedKeys.has(key)) delete event.m[key];\n            });\n\n            // Ensure metadata strings won't exceed the imposed limit\n            Object.keys(event.m).forEach((key) => {\n                if (typeof event.m[key] === \"string\") {\n                    event.m[key] = event.m[key].substr(0, 255);\n                }\n            });\n\n            // Set page source reference\n            /* istanbul ignore else: jsdom setup with referrer */\n            if (document.referrer) {\n                event.ref = document.referrer;\n            }\n\n             // Set the window location\n            event.win = okanjo.util.getLocation();\n        }\n\n        /**\n         * Updates the stored session identifier\n         * @param sid\n         * @private\n         */\n        _updateSid(sid) {\n            // Not set or changed?\n            if (sid && (!this.sid || this.sid !== sid) ) {\n                this.sid = sid;\n                window.localStorage[Metrics.Params.name] = sid;\n                okanjo.util.cookie.set(Metrics.Params.name, sid, Metrics.Params.ttl);\n            }\n        }\n\n        //noinspection JSUnusedGlobalSymbols\n        /**\n         * Adds DOM element dimensions / positional data to the event\n         * @param element\n         * @param event\n         * @return {*|{}}\n         */\n        static addElementInfo(element, event) {\n            const page = okanjo.ui.getPageSize(),\n                size = okanjo.ui.getElementPosition(element);\n\n            event = event || {};\n            event.m = event.m || {};\n            event.m.pw = page.w;\n            event.m.ph = page.h;\n            event.m.x1 = size.x1;\n            event.m.y1 = size.y1;\n            event.m.x2 = size.x2;\n            event.m.y2 = size.y2;\n\n            return event;\n        }\n\n        static addWidgetInfo(element, event) {\n            const containerSize = okanjo.ui.getElementPosition(element);\n\n            event = event || {};\n            event.m = event.m || {};\n\n            // placement div size\n            event.m.wox1 = containerSize.x1;\n            event.m.woy1 = containerSize.y1;\n            event.m.wox2 = containerSize.x2;\n            event.m.woy2 = containerSize.y2;\n\n            // Inner size is the min/max of the child elements since they may be floating and have no official height/width\n            const resources = okanjo.qwery('.okanjo-resource, .okanjo-adx-container', element);\n            let size, wix1, wiy1, wix2, wiy2, boxes = [];\n            const getMin = (val, current) => typeof current === \"undefined\" || val < current ? val : current;\n            const getMax = (val, current) => typeof current === \"undefined\" || val > current ? val : current;\n            const fallback = (val, fallback) => typeof val === \"undefined\" ? fallback : val;\n\n            resources.forEach(e => {\n                size = okanjo.ui.getElementPosition(e);\n                wix1 = getMin(size.x1, wix1);\n                wiy1 = getMin(size.y1, wiy1);\n                wix2 = getMax(size.x2, wix2);\n                wiy2 = getMax(size.y2, wiy2);\n                boxes.push(size.x1, size.y1, size.x2, size.y2);\n            });\n\n            // inner size (might be centered or something)\n            // noinspection JSUnusedAssignment\n            event.m.wix1 = fallback(wix1, containerSize.x1); // noinspection JSUnusedAssignment\n            event.m.wiy1 = fallback(wiy1, containerSize.y1); // noinspection JSUnusedAssignment\n            event.m.wix2 = fallback(wix2, containerSize.x2); // noinspection JSUnusedAssignment\n            event.m.wiy2 = fallback(wiy2, containerSize.y2);\n            event.m.wrps = boxes.map(v => Math.floor(v)).join(','); // all resource positions x1,y1,x2,y2,...\n\n            return event;\n        }\n\n        //noinspection JSUnusedGlobalSymbols\n        /**\n         * Adds viewport dimensions / positional data to the event\n         * @param event\n         * @return {*|{}}\n         */\n        static addViewportInfo(event) {\n            const vp = okanjo.ui.getViewportSize(),\n                pos = okanjo.ui.getScrollPosition();\n\n            event = event || {};\n            event.m = event.m || {};\n            event.m.vx1 = pos.x;\n            event.m.vy1 = pos.y;\n            event.m.vx2 = pos.x+vp.vw;\n            event.m.vy2 = pos.y+vp.vh;\n\n            return event;\n        }\n\n        //noinspection JSUnusedGlobalSymbols\n        /**\n         * Adds DOM event positional data to the event\n         * @param jsEvent\n         * @param event\n         * @return {*|{}}\n         */\n        static addEventInfo(jsEvent, event) {\n            const pos = okanjo.ui.getEventPosition(jsEvent);\n\n            event = event || {};\n            event.m = event.m || {};\n            event.m.et = pos.et;\n            event.m.ex = pos.ex;\n            event.m.ey = pos.ey;\n\n            return event;\n        }\n\n        //noinspection JSUnusedGlobalSymbols\n        /**\n         * Adds meta data values to the event\n         * @param event\n         * @param args\n         * @return {*|{}}\n         */\n        static addEventMeta(event, ...args) {\n            event = event || {};\n            event.m = event.m || {};\n            event.m = Object.assign.apply(Object, [event.m].concat(args));\n            \n            return event;\n        }\n\n        /**\n         * Helper to create a new fluent event structure\n         * @param data\n         * @param args\n         * @return {MetricEvent}\n         */\n        static create(data, ...args) {\n            // return okanjo.util.deepClone(Object.assign.apply(Object, [{}].concat(args)));\n            return new MetricEvent(data, args);\n        }\n\n        //noinspection JSMethodCanBeStatic,JSUnusedGlobalSymbols\n        /**\n         * Helper to create a new fluent event structure\n         * @param args\n         * @return {*}\n         */\n        create(...args) {\n            return Metrics.create.apply(null, args);\n        }\n\n    }\n\n    /**\n     * The storage/cookie/url param names\n     * @type {{queue: string, name: string, channel: string, context: string, ttl: number}}\n     */\n    Metrics.Params = {\n        queue: '_ok_q',\n        name: 'ok_msid',\n        channel: 'ok_ch',\n        context: 'ok_cx',\n        ttl: 1460 // 4 years\n    };\n\n    /**\n     * Event Metadata configuration\n     * @type {{exclude: [*], include: [*]}}\n     */\n    Metrics.Meta = {\n        exclude: ['key','callback','metrics_channel_context','metrics_context','mode'],\n        include: [\n            'decl',\n            'ex', 'ey',\n            'filters_sort_by', 'filters_sort_direction', 'filters_take', 'filters_type', 'filters_url',\n            'ok_ver',\n            'ph', 'pw',\n            'pten', 'ptid',\n            'res_bf', 'res_length', 'res_sf', 'res_spltfl', 'res_type',\n            'bf', 'sf', 'spltfl_seg',\n            'vx1', 'vx2', 'vy1', 'vy2',\n            'pgid', 'wgid',\n            'wix1', 'wix2', 'wiy1', 'wiy2',\n            'wox1', 'wox2', 'woy1', 'woy2', 'wrps',\n            'x1', 'x2', 'y1', 'y2',\n\n            'cid', 'campaign_id', 'expandable', 'res_total'\n        ]\n    };\n\n    /**\n     * Event Types\n     * @type {{view: string, impression: string, interaction: string, correlation: string}}\n     */\n    Metrics.Event = {\n        view: 'vw',\n        impression: 'imp',\n        interaction: 'int',\n        correlation: 'cor'\n    };\n\n    /**\n     * Event Action Types\n     * @type {{click: string, inline_click: string}}\n     */\n    Metrics.Action = {\n        click: \"click\",\n        inline_click: \"inline_click\"\n    };\n\n    /**\n     * Event Object Types\n     * @type {{article: string, thirdparty_ad: string, cart: string, page: string, widget: string, product: string, store: string, cause: string, marketplace: string, order: string, order_item: string, user: string, metric_session: string}}\n     */\n    Metrics.Object = {\n        article: 'am',\n        thirdparty_ad: 'ta',\n        cart: 'ct',\n        page: 'pg',\n        widget: 'wg',\n        product: 'pr',\n        store: 'st',\n        cause: 'ca',\n        marketplace: 'mp',\n        order: 'or',\n        order_item: 'oi',\n        user: 'ur',\n        metric_session: 'mt'\n    };\n\n    /**\n     * Event Channels\n     * @type {{product_widget: string, ad_widget: string, store_widget: string, marketplace: string, external: string}}\n     */\n    Metrics.Channel = {\n        placement: 'pw',\n        marketplace: 'mp',\n        external: 'ex',\n\n        // Deprecated:\n        product_widget: 'pw',\n        ad_widget: 'aw',\n        store_widget: 'sw'\n    };\n\n    /**\n     * Event Environments\n     * @type {{live: string, testing: string}}\n     */\n    Metrics.Environment = {\n        live: \"live\",\n        testing: \"testing\"\n    };\n\n    /**\n     * Fluent wrapper around making events simple\n     */\n    class MetricEvent {\n        constructor(data, others) {\n            // Merge the data and other data sets into this object\n            data = data || {};\n            this.data(data);\n            /* istanbul ignore else: metrics.create is the only way to create this right now */\n            if (Array.isArray(others)) {\n                others.forEach((data) => {\n                    this.data(data);\n                });\n            }\n        }\n\n        /**\n         * Sets event parameter key-values\n         * @param data\n         */\n        data(data) {\n            Object.assign(this, okanjo.util.deepClone(data));\n            return this;\n        }\n\n        /**\n         * Adds DOM event positional data to the event\n         * @param jsEvent\n         * @return {MetricEvent}\n         */\n        event(jsEvent) {\n            Metrics.addEventInfo(jsEvent, this);\n            return this;\n        }\n\n        /**\n         * Adds viewport dimensions / positional data to the event\n         * @return {MetricEvent}\n         */\n        viewport() {\n            Metrics.addViewportInfo(this);\n            return this;\n        }\n\n        /**\n         * Adds DOM element dimensions / positional data to the event\n         * @param element\n         * @return {MetricEvent}\n         */\n        element(element) {\n            Metrics.addElementInfo(element, this);\n            return this;\n        }\n\n        /**\n         * Adds widget DOM element dimensions / positional data to the event\n         * @param element\n         * @returns {MetricEvent}\n         */\n        widget(element) {\n            Metrics.addWidgetInfo(element, this);\n            return this;\n        }\n\n        //noinspection JSUnusedGlobalSymbols\n        /**\n         * Adds meta data values to the event\n         * @param args\n         * @return {MetricEvent}\n         */\n        meta(...args) {\n            Metrics.addEventMeta.apply(null, [this].concat(args));\n            return this;\n        }\n\n        /**\n         * Sets the object and event type on the event w/o having to use .data\n         * @param object_type\n         * @param event_type\n         * @return {MetricEvent}\n         */\n        type(object_type, event_type) {\n            this.object_type = object_type;\n            this.event_type = event_type;\n            return this;\n        }\n\n        /**\n         * Finalizes and sends the event\n         * @param callback\n         */\n        send(callback) {\n            okanjo.metrics.trackEvent(this, callback);\n            // DONT RETURN - BREAK THE CHAIN HERE\n        }\n\n        /**\n         * Gets the single-metric tracking url for this event\n         * @return {string}\n         */\n        toUrl() {\n            // Copy data w/o modifying it\n            const event = Object.assign({}, this);\n\n            // Extract params\n            const {\n                object_type,\n                event_type\n            } = event;\n            delete event.object_type;\n            delete event.event_type;\n\n            // Normalize event data\n            okanjo.metrics._normalizeEvent(event);\n\n            // Get the URL\n            return okanjo.net.getRoute(okanjo.net.routes.metrics, { object_type, event_type }) + '?' +\n                okanjo.net.request.stringify(event);\n        }\n    }\n\n    // Export / initialize\n    okanjo.metrics = new Metrics();\n\n})(window, document);","\"use strict\";\n\n//noinspection ThisExpressionReferencesGlobalObjectJS\n(function(window) {\n\n    const okanjo = window.okanjo;\n\n    // Track the page view, but don't send it right away.\n    // Send it in one full second unless something else pushes an event\n    // This way, we have a chance that a placement key will be set globally\n    okanjo.metrics.trackPageView({_noProcess:true});\n    setTimeout(() => {\n        okanjo.metrics._processQueue();\n    }, 1000);\n\n})(window);","\"use strict\";\n\n//noinspection ThisExpressionReferencesGlobalObjectJS,JSUnusedLocalSymbols\n(function(window) {\n\n    const okanjo = window.okanjo;\n    const DATA_ATTRIBUTE_PATTERN = /^data-(.+)$/;\n    const DATA_REPLACE_PATTERN = /-/g;\n\n    /**\n     * Base widget class\n     */\n    class Widget extends okanjo._EventEmitter {\n\n        constructor(element, options) {\n            super();\n\n            // Verify element was given (we can't load unless we have one)\n            if (!element || typeof element.nodeType === \"undefined\") {\n                okanjo.report('Invalid or missing element on widget construction', { widget: this, element, options });\n                throw new Error('Okanjo: Invalid element - make sure to pass a valid DOM element when constructing Okanjo Widgets.');\n            }\n\n            // Verify configuration is OK\n            if (options && typeof options !== \"object\") {\n                // Warn and fix it\n                okanjo.report('Invalid widget options. Expected object, got: ' + typeof options, { widget: this, element, options });\n                options = {};\n            } else {\n                options = options || {};\n            }\n\n            // Store basics\n            this.name = 'Widget';\n            this.element = element;\n            this.instanceId = okanjo.util.shortid();\n\n            // Clone initial config, breaking the top-level reference\n            this.config = Object.assign({}, options);\n        }\n\n        /**\n         * Base widget initialization procedures\n         */\n        init() {\n            // process config attributes\n            this._applyConfiguration();\n\n            this._setCompatibilityOptions();\n\n            // ensure placement key\n            if (!this._ensurePlacementKey()) return;\n\n            // Tell the widget to load\n            this.load();\n        }\n\n        /**\n         * This is for extended widgets, so they may modify the configuration before loading\n         */\n        _setCompatibilityOptions() {\n            // By default, this does nothing. Must be overridden to be useful\n        }\n\n        //noinspection JSMethodCanBeStatic\n        /**\n         * Widget configuration definitions\n         * @return {{}}\n         */\n        getSettings() {\n            // Override this\n            return {};\n        }\n\n        /**\n         * Main widget load function.\n         */\n        load() {\n            // Override this in the widget implementation\n        }\n\n        /**\n         * Applies data attribute settings and defaults to the widget configuration\n         * @private\n         */\n        _applyConfiguration() {\n\n            // this.config was set to the options provided in the constructor\n            // so layer data attributes on top\n\n            const data = this.getDataAttributes();\n            const settings = this.getSettings();\n            Object\n                .keys(data)\n                .forEach((key) => {\n                    let normalizedKey = key.replace(DATA_REPLACE_PATTERN, '_');\n\n                    let val = data[key];\n\n                    // Attempt to convert the value if there's a setting for it\n                    if (settings[normalizedKey]) val = settings[normalizedKey].value(val, false);\n\n                    if (!okanjo.util.isEmpty(val)) {\n                        this.config[normalizedKey] = val;\n                    }\n                })\n            ;\n\n            // Apply defaults from the widget settings\n            Object.keys(settings).forEach((key) => {\n                if (this.config[key] === undefined && settings[key]._default !== undefined) {\n                    this.config[key] = settings[key].value(undefined, false);\n                }\n            });\n        }\n\n        //noinspection JSUnusedGlobalSymbols\n        /**\n         * Gets a copy of the configuration, suitable for transmission\n         * @return {{}}\n         */\n        getConfig() {\n            const settings = this.getSettings();\n            const out = {};\n\n            Object.keys(this.config).forEach((origKey) => {\n                let val = this.config[origKey];\n                let key = origKey;\n                let group = null;\n\n                // Check if this is a known property\n                if (settings[key]) {\n                    val = settings[key].value(val);\n                    group = settings[key].getGroup();\n                }\n\n                // Init the target/group if not already setup\n                let target = out;\n                if (group) {\n                    target[group] = target[group] || {};\n                    target = target[group];\n                }\n\n                // Set the value on the target if set\n                if (val === null) {\n                    target[key] = ''; // format null values as empty strings for transmission\n                } else if (val !== undefined) {\n                    target[key] = val;\n                }\n            });\n\n            return out;\n        }\n\n        /**\n         * Before loading, ensure that a placement key is present or abort\n         * @return {boolean}\n         * @private\n         */\n        _ensurePlacementKey() {\n\n            // Check if set on widget or globally\n            if (this.config.key) {\n                return true;\n            } else if (okanjo.key) {\n                // Copy key from global scope,\n                this.config.key = okanjo.key;\n                return true;\n            }\n\n            // No key set, can't load.\n            okanjo.report('No key provided on widget', { widget: this });\n            this.showError('Error: Missing placement key.');\n            return false;\n        }\n\n        /**\n         * Displays an error in the widget element\n         * @param message\n         */\n        showError(message) {\n            this.setMarkup(okanjo.ui.engine.render(\n                'okanjo.error',\n                this,\n                { message }\n            ));\n        }\n\n        /**\n         * Replaces the markup of the widget's element\n         * @param markup\n         */\n        setMarkup(markup) {\n            this.element.innerHTML = markup;\n            this.setFlexClasses(); // implicitly set the classes\n        }\n\n        /**\n         * Sets the flex classes for the placement container element\n         */\n        setFlexClasses() {\n            const align = this.config.align;\n            const justify = this.config.justify;\n            if (align) this.element.classList.add('okanjo-align-'+align);\n            if (justify) this.element.classList.add('okanjo-justify-'+justify);\n        }\n\n        //noinspection JSUnusedGlobalSymbols\n        /**\n         * Gets the current page URL, sans query string and fragment.\n         * @returns {string} - URL\n         */\n        static getCurrentPageUrl() {\n            return window.location.href.replace(/([?#].*)$/, '');\n        }\n\n        /**\n         * Instead of using HTML5 dataset, just rip through attributes and return data attributes\n         * @returns {*}\n         */\n        getDataAttributes() {\n            const data = {};\n                Array\n                    .from(this.element.attributes)\n                    .forEach((attr) => {\n                        const match = DATA_ATTRIBUTE_PATTERN.exec(attr.name);\n                        if (match) {\n                            data[match[1]] = attr.value;\n                        }\n                    });\n            return data;\n        }\n\n    }\n\n    /**\n     * Fluent configuration helper for organizing and formatting ad-hoc configuration values\n     * @type {Field}\n     */\n    Widget.Field = class Field {\n\n        //noinspection JSUnusedGlobalSymbols\n        constructor() {\n            this._convert = null;\n            this._strip = false;\n            this._default = undefined;\n            this._group = null;\n        }\n\n        /**\n         * Formats the value as an array of strings\n         * @param converter\n         * @return {Field}\n         */\n        array(converter) {\n            this._convert = (val) => {\n                if (Array.isArray(val)) {\n                    if (converter) {\n                        return val.map((v) => converter(v))\n                    } else {\n                        return val;\n                    }\n                }\n                val = val.replace(/\\\\,/g, '\\0');\n                return val.split(',').map((v) => {\n                    let res = v.trim().replace('\\0', ',');\n                    if (converter) res = converter(res);\n                    return res;\n                });\n            };\n            return this;\n        }\n        //noinspection JSUnusedGlobalSymbols\n        static array(converter) { return (new Field()).array(converter); }\n\n        /**\n         * Formats the value as a string\n         * @return {Field}\n         */\n        string() {\n            this._convert = (val) => {\n                if (val === null || val === undefined) return val;\n                else return \"\"+val;\n            };\n            return this;\n        }\n        static string() { return (new Field()).string(); }\n\n        /**\n         * Formats the value as a boolean (takes 1, 0, true, false)\n         * @return {Field}\n         */\n        bool() {\n            this._convert = (val) => {\n                if (typeof val === \"string\") {\n                    return (val === \"1\" || val.toLowerCase() === \"true\");\n                } else {\n                    return !!val;\n                }\n            };\n            return this;\n        }\n        //noinspection JSUnusedGlobalSymbols\n        static bool() { return (new Field()).bool(); }\n\n        /**\n         * Indicates the field should not be passed on for transmission\n         * @return {Field}\n         */\n        strip() { this._strip = true; return this; }\n        static strip() { return (new Field()).strip(); }\n\n        /**\n         * Formats the value as a integer (whole) number\n         * @return {Field}\n         */\n        int() { this._convert = (val) => parseInt(val); return this; }\n        //noinspection JSUnusedGlobalSymbols\n        static int() { return (new Field()).int(); }\n\n        /**\n         * Formats the value as a floating point number\n         * @return {Field}\n         */\n        float() { this._convert = (val) => parseFloat(val); return this; }\n        //noinspection JSUnusedGlobalSymbols\n        static float() { return (new Field()).float(); }\n\n        //noinspection ReservedWordAsName\n        /**\n         * Sets the default value to use if not set\n         * @param val\n         * @return {Field}\n         */\n        default(val) {\n            this._default = val;\n            return this;\n        }\n\n        /**\n         * Assigns the property to a bucket for hierarchy\n         * @param name\n         * @return {Field}\n         */\n        group(name) {\n            this._group = name;\n            return this;\n        }\n\n        /**\n         * Gets the group the field belongs to\n         * @return {*|null}\n         */\n        getGroup() {\n            return this._group;\n        }\n\n        //noinspection JSUnusedGlobalSymbols\n        /**\n         * Gets the formatted value of the field\n         * @param val\n         * @param strip\n         * @return {*}\n         */\n        value(val, strip=true) {\n            if (this._strip && strip) return undefined;\n            if (val !== undefined && this._convert) {\n                val = this._convert(val);\n            }\n            return val !== undefined ? val : this._default;\n        }\n\n    };\n\n    // Export\n    return okanjo._Widget = Widget;\n\n})(window);\n\n\n\n","\"use strict\";\n\n//noinspection ThisExpressionReferencesGlobalObjectJS,JSUnusedLocalSymbols\n(function(window) {\n\n    //region Imports and Constants\n\n    const okanjo = window.okanjo;\n    const { string, array, float, int, bool } = okanjo._Widget.Field;\n    const Metrics = okanjo.metrics.constructor;\n    const TemplateEngine = okanjo.ui.engine.constructor;\n\n    const FILTERS = 'filters';\n    const DISPLAY = 'display';\n    const ARTICLE_META = 'article_meta';\n\n    const MINIMUM_VIEW_PX = 0.5;    // 50% of pixels must be in viewport\n    const MINIMUM_VIEW_TIME = 1000; // for 1 full second\n    const MINIMUM_VIEW_FREQ = 2;    // time / freq = interval\n\n    const LARGE_PX_THRESHOLD = 242000;  // For large ads, a reduced % is applied\n    const LARGE_MINIMUM_VIEW_PX = 0.3;  // 30% of pixels must be in viewport for large ads\n\n    //endregion\n\n    /**\n     * Placement widget\n     */\n    class Placement extends okanjo._Widget {\n\n        //region Configuration & Overrides\n\n        /**\n         * Initializes a new placement\n         * @param element\n         * @param options\n         */\n        constructor(element, options = {}) {\n\n            // Flatten the options before passing on\n            options = okanjo.util.flatten(options, { ignoreArrays: true });\n            super(element, options);\n\n            this.name = 'Placement';\n            this._metricBase = {}; // placeholder for metrics\n            this._response = null; // placeholder for api response\n\n            // Aggregate view watchers into a single interval fn\n            this._viewWatcherIv = null;\n            this._viewedWatchers = [];\n            this.disposed = false;\n\n            // Start loading content\n            if (!options.no_init) this.init();\n        }\n\n        //noinspection JSMethodCanBeStatic,JSUnusedGlobalSymbols\n        /**\n         * Gets the widget settings configuration\n         * @return {{type: *, ids: *, q: *, url: *, url_referrer: *, url_selectors: *, organization_id: *, property_id: *, store_id: *, organization_name: *, property_name: *, store_name: *, external_id: *, sku: *, external_store_id: *, condition: *, manufacturer: *, upc: *, isbn: *, tags: *, category: *, pools: *, min_price: *, max_price: *, min_donation_percent: *, max_donation_percent: *, donation_to: *, sort_by: *, sort_direction: *, skip: *, take: *, placement_tests_only: *, size: *, template_name: *, template_layout: *, template_theme: *, template_cta_style: *, template_cta_text: *, template_cta_color: *, adx_unit_path: *, url_category: *, url_keywords: *, no_init: *, proxy_url: *, expandable, disable_inline_buy, disable_popup, backwards: *}}\n         */\n        getSettings() {\n            return {\n\n                // What type of response do you want\n                type: string().group(FILTERS),\n\n                // What specific products do you want\n                ids: array().group(FILTERS),\n\n                // Filter by generic query string\n                q: string().group(FILTERS),\n\n                // Filter by relation to content\n                url: string().group(FILTERS),\n                url_referrer: string().group(FILTERS).strip(),\n                url_selectors: string().group(FILTERS),\n                url_paths: array().group(FILTERS),\n                not_url_paths: array().group(FILTERS),\n\n                // Filter by hierarchy\n                organization_id: string().group(FILTERS),\n                property_id: string().group(FILTERS),\n                store_id: string().group(FILTERS),\n\n                // Filter by hierarchy names (use *_id where possible, this might not work as you might expect)\n                organization_name: string().group(FILTERS),\n                property_name: string().group(FILTERS),\n                store_name: string().group(FILTERS),\n\n                // Filter by integrations\n                external_id: string().group(FILTERS),\n                sku: string().group(FILTERS),\n                external_store_id: string().group(FILTERS),\n\n                // Filter by product attributes\n                condition: string().group(FILTERS),\n                manufacturer: string().group(FILTERS),\n                upc: string().group(FILTERS),\n                isbn: string().group(FILTERS),\n\n                // Filter by categorization / distribution\n                tags: array().group(FILTERS),\n                category: array().group(FILTERS),\n                pools: array().group(FILTERS),\n\n                // Filter by price range\n                min_price: float().group(FILTERS),\n                max_price: float().group(FILTERS),\n\n                // Filter by donation ranges\n                min_donation_percent: float().group(FILTERS),\n                max_donation_percent: float().group(FILTERS),\n\n                // Filter by donation recipient\n                donation_to: string().group(FILTERS),\n\n                // Sorting\n                sort_by: string().group(FILTERS),\n                sort_direction: string().group(FILTERS),\n\n                // Pagination\n                skip: int().group(FILTERS),\n                take: int().group(FILTERS),\n\n                // Placement Testing\n                placement_tests_only: bool(),\n\n                // Display settings\n                size: string().group(DISPLAY),\n                template_name: string().group(DISPLAY),\n                template_layout: string().group(DISPLAY),\n                template_theme: string().group(DISPLAY),\n                template_variant: string().group(DISPLAY),\n                template_cta_style: string().group(DISPLAY),\n                template_cta_text: string().group(DISPLAY),\n                template_cta_color: string().group(DISPLAY),\n                template_cta_invert: bool().group(DISPLAY), // Whether to invert the cta color scheme\n                adx_unit_path: string().group(DISPLAY), // Custom DFP ad unit path\n                hide_pricing: bool().group(DISPLAY), // hide price container on product resources\n\n                // Flexbox\n                align: string().group(DISPLAY),\n                justify: string().group(DISPLAY),\n\n                // Custom CSS\n                custom_css_url: string().group(DISPLAY),\n                custom_css: string().group(DISPLAY),\n\n                // Article metadata\n                url_category: array().group(ARTICLE_META),\n                url_keywords: array().group(ARTICLE_META),\n\n                // Functional settings\n                key: string().strip(), // don't need to resend key on all our requests\n                no_init: bool().strip(), // don't automatically load the placement, do it manually (e.g. (new Placement({no_init:true})).init()\n                no_css: bool().strip(), // don't automatically include stylesheets\n                verbose_click_data: bool().strip().default(false), // when enabled, sends ok_msid, ok_ch, ok_cx, _okjr to the destination url\n                utm_click_data: bool().strip().default(false), // when enabled, sends url_source, utm_campaign, and utm_medium to the destination url\n                proxy_url: string().strip(),\n                expandable: bool().strip().default(true),\n                disable_inline_buy: bool().strip().default(false), // stops inline buy functionality\n                disable_popup: bool().strip().default(false), // stops new window on mobile for inline buy functionality\n                backwards: string().strip(), // internal flag indicating port from a deprecated widget\n                testing: bool().strip() // metrics flag to indicate testing\n            };\n        }\n\n        /**\n         * Gets the widget configuration formatted using settings, suitable for transmission\n         * @return {{filters: {}, display: {}, backfill: {}, shortfill: {}, article_meta: {}}}\n         */\n        getConfig() {\n            const settings = this.getSettings();\n            const out = { filters: {}, display: {}, backfill: {}, shortfill: {}, article_meta: {} };\n            const backfillPattern = /^backfill_(.+)$/; // backfill_property\n            const shortfillPattern = /^shortfill_(.+)$/; // shortfill_property\n\n            Object.keys(this.config).forEach((origKey) => {\n                let val = this.config[origKey];\n                let key = origKey;\n                let isBackfill = false;\n                let isShortfill = false;\n                let group = null;\n\n                // Get the property name if it was prefixed with backfill\n                let matches = backfillPattern.exec(origKey);\n                if (matches) {\n                    key = matches[1];\n                    isBackfill = true;\n                } else {\n                    // Get the property name if it was prefixed with shortfill\n                    matches = shortfillPattern.exec(origKey);\n                    if (matches) {\n                        key = matches[1];\n                        isShortfill = true;\n                    }\n                }\n\n                // Check if this is a known property\n                if (settings[key]) {\n                    val = settings[key].value(val);\n                    group = settings[key].getGroup();\n                }\n\n                // Init the target/group if not already setup\n                let target = out;\n                if (isBackfill) {\n                    target = out.backfill;\n                } else if (isShortfill) {\n                    target = out.shortfill;\n                }\n\n                // Set the target to the bucket in the settings container\n                // except shortfill - can only apply settings directly to the bucket\n                // e.g. backfill_url -> { backfill: { filters: { url: xxx } } }\n                // e.g. shortfill_url-> { shortfill: { url: xxx } }\n                if (!isShortfill && group) {\n                    target[group] = target[group] || {};\n                    target = target[group];\n                }\n\n                // Set the value on the target if set\n                if (val === null) {\n                    target[key] = ''; // format null values as empty strings for transmission\n                } else if (val !== undefined) {\n                    target[key] = val;\n                }\n            });\n\n            return out;\n        }\n\n        //noinspection JSUnusedGlobalSymbols\n        /**\n         * Core load process\n         */\n        load() {\n            // Set metric base data (stub for all future events emitted by the widget)\n            this._setMetricBase();\n\n            // Find out what we should display here\n            this._fetchContent((err) => {\n                if (err) {\n                    // Report the widget load as declined\n                    this._reportWidgetLoad(\"fetch failed: \" + err.statusCode || /* istanbul ignore next: out of scope */ err.toString());\n                } else {\n                    // Merge display settings from response\n                    this._mergeResponseSettings();\n\n                    // Merge the referential data from the response\n                    this._updateBaseMetaFromResponse();\n\n                    // Handle rendering based on output type\n                    this._showContent();\n                }\n            });\n        }\n\n        //endregion\n\n        //region Internal Helpers\n\n        /**\n         * Initializes the common metric data for events emitted by the placement\n         * @private\n         */\n        _setMetricBase() {\n            const base = this._metricBase;\n            base.ch = Metrics.Channel.placement;\n            base.cx = this.config.backwards || 'auto';\n            base.key = this.config.key;\n            base.m = base.m || {};\n            base.m.wgid = this.instanceId;\n\n            if (this.config.testing) base.env = Metrics.Environment.testing;\n        }\n\n        /**\n         * Emits the widget impression event\n         * @param declined\n         * @private\n         */\n        _reportWidgetLoad(declined) {\n\n            const segments = this._getResponseData();\n\n            // widget stats now aggregate all segments\n            const backfilled = segments.find(s => s.backfilled) ? 1 : 0,\n                shortfilled = segments.find(s => s.shortfilled) ? 1 : 0,\n                splitfilled = segments.length > 1 ? 1 : 0,\n                res_total = segments.reduce((a, c) => a + (c.total || 0), 0),\n                res_length = segments.reduce((a, c) => a + (c.results && c.results.length || 0), 0),\n                res_types = Array.from(new Set(segments.map(s => s.type)));\n\n            // If this is declined, mark future events as declined too\n            this._metricBase.m.decl = declined || '0';\n\n            // Attach other main response attributes to all future events\n            this._metricBase.m.res_bf = backfilled; // whether the response used the backfill flow\n            this._metricBase.m.res_sf = shortfilled; // whether the response used the shortfill flow\n            this._metricBase.m.res_spltfl = splitfilled; // whether the response used the splitfill flow\n            this._metricBase.m.res_total = res_total; // how many total candidate results were available given filters\n            this._metricBase.m.res_type = res_types.length > 1 ? Placement.ContentTypes.mixed : res_types[0]; // what the given resource type was\n            this._metricBase.m.res_length = res_length; // number of resources delivered\n\n            // Track impression\n            okanjo.metrics.create(this._metricBase)\n                .type(Metrics.Object.widget, Metrics.Event.impression)\n                .meta(this.getConfig())\n                .element(this.element) // this might not be all that useful cuz the content hasn't been rendered yet\n                .viewport()\n                .widget(this.element)\n                .send();\n\n            // Start watching for a viewable impression\n            this._addOnceViewedHandler(this.element, () => {\n                okanjo.metrics.create(this._metricBase)\n                    .type(Metrics.Object.widget, Metrics.Event.view)\n                    .meta(this.getConfig())\n                    .element(this.element)\n                    .viewport()\n                    .widget(this.element)\n                    .send();\n            });\n        }\n\n        /**\n         * Executes the request for content to fill the placement\n         * @param callback\n         * @private\n         */\n        _fetchContent(callback) {\n            // Build request to api, starting with this placement config params\n            const query = this.getConfig();\n\n            // Extract the key\n            const key = this.config.key;\n\n            // Attach sid and referrer\n            if (okanjo.metrics.sid) query.sid = okanjo.metrics.sid;\n            query.filters.url_referrer = this.config.url_referrer || window.location.href;\n            query.wgid = this.instanceId;\n            query.pgid = okanjo.metrics.pageId;\n\n            // Send it\n            okanjo.net.request.post(\n                `${okanjo.net.getRoute(okanjo.net.routes.ads, null, this.config.sandbox ? 'sandbox' : 'live')}?key=${encodeURIComponent(key)}`,\n                query,\n                (err, res) => {\n                    if (err) {\n                        okanjo.report('Failed to retrieve placement content', err, { placement: this });\n                        this.setMarkup(''); // Don't show anything\n                        this.emit('error', err);\n                        callback && callback(err);\n                    } else {\n\n                        // Store the raw response\n                        this._response = res;\n\n                        // Hook point for response handling\n                        this.emit('data');\n\n                        // Return\n                        callback && callback();\n                    }\n                }\n            );\n        }\n\n        /**\n         * Extracts the response data from the payload (segments)\n         * @returns {*[]}\n         * @private\n         */\n        _getResponseData() {\n            const res = this._response;\n            return [].concat((res && res.data) || [{}]); // will force the old response data into an array\n        }\n\n        /**\n         * Applies response filters and display settings into the widget configuration\n         * @private\n         */\n        _mergeResponseSettings() {\n            // Apply the base segment settings as the main widget display settings\n            const data = this._getResponseData()[0];\n\n            // Merge the base results\n            const settings = (data.settings) || {};\n\n            if (settings.filters) {\n                Object.keys(settings.filters).forEach((key) => {\n                    this.config[key] = settings.filters[key];\n                });\n            }\n\n            if (settings.display) {\n                Object.keys(settings.display).forEach((key) => {\n                    this.config[key] = settings.display[key];\n                });\n            }\n        }\n\n        /**\n         * Applies response data to future metric events\n         * @private\n         */\n        _updateBaseMetaFromResponse() {\n            // Update the base metric data with info from the response\n\n            // SmartServe can now return an array of result objects\n            const data = this._getResponseData()[0] || {};\n\n            this._metricBase.m = this._metricBase.m || {};\n            const meta = this._metricBase.m;\n\n            // Article\n            if (data.article) meta.aid = data.article.id;\n\n            if (data.test && data.test.enabled) {\n                meta.pten = 1;\n                meta.ptid = data.test.id;\n                meta.ptseed = data.test.seed;\n            } else {\n                meta.pten = 0;\n            }\n        }\n\n        /**\n         * Beings the render process based on the response content\n         * @private\n         */\n        _showContent() {\n            const segments = this._getResponseData();\n\n            // 1. Render each segment to list html, store in array\n            // 2a. If array is empty, handle empty decline\n            // 2b. If not empty, render container html passing contents to embed\n            // 3. Set markup to final container render\n            // 4. Do follow-up event binding and cleanup stuff\n\n            // If there are multiple segments, force responsive slab template for now\n            if (segments.length > 1) {\n                this.config.template_name = 'slab';\n                this.config.size = 'responsive';\n            }\n\n            // Assemble list contents\n            let renderedSegments = [];\n\n            for (let segment, i = 0; i < segments.length; i++) {\n                segment = segments[i];\n\n                // Known content types we can display\n                if (segment.type === Placement.ContentTypes.products) {\n                    renderedSegments.push(this._renderProductSegment(segment, i));\n\n                } else if (segment.type === Placement.ContentTypes.articles) {\n                    renderedSegments.push(this._renderArticleSegment(segment, i));\n\n                } else if (segment.type === Placement.ContentTypes.adx) {\n                    renderedSegments.push(this._renderADXSegment(segment, i));\n\n                } else {\n                    // Unknown response type!\n\n                    // Report the widget load as declined\n                    const msg = 'Unknown response content type: ' + segment.type;\n                    okanjo.report(msg, { placement: this });\n                    // this.setMarkup(''); // Don't show anything\n                    this.emit('error', msg);\n                    // this._reportWidgetLoad(msg);\n                }\n            }\n\n            // Filter empty segments\n            // console.log('rendered segs', renderedSegments)\n            renderedSegments = renderedSegments.filter(html => !!html);\n\n            // No segments? Decline\n            if (renderedSegments.length === 0) {\n                this.emit('empty');\n                this._reportWidgetLoad('empty'); // decline the impression\n                return;\n            }\n\n            // Render the container and insert the markup\n            const model = this._getBaseRenderModel({\n                segmentContent: renderedSegments.join('')\n            });\n            const templateName = this._getTemplate(Placement.ContentTypes.container, Placement.DefaultTemplates.container);\n            this.setMarkup(okanjo.ui.engine.render(templateName, this, model));\n\n            // Report load\n            this._reportWidgetLoad();\n\n            // Handle resource post-render events\n            this._postProductRender();\n            this._postArticleRender();\n            this._postADXRender();\n\n            // Fit images\n            okanjo.ui.fitImages(this.element);\n\n            // Hook point that the widget is done loading\n            this.emit('load');\n        }\n\n        /**\n         * Returns the base render model with common properties set\n         * @param model\n         * @returns {{}}\n         * @private\n         */\n        _getBaseRenderModel(model) {\n            model.css = !this.config.no_css;\n            model.button_classes = this.config.template_cta_invert ? 'invert' : '';\n            model.price_classes = this.config.hide_pricing ? 'okanjo-invisible' : '';\n            return model;\n        }\n\n        /**\n         * Generates the click url using the event, proxy_url, and additional params\n         * @param event\n         * @param url\n         * @param additionalUrlParams\n         * @return {*}\n         * @private\n         */\n        _getClickThroughURL(event, url, additionalUrlParams) {\n            const joiner = url.indexOf('?') >= 0 ? '&' : '?';\n\n            // Tack on transfer params\n            additionalUrlParams = additionalUrlParams || /* istanbul ignore next: paranoia */ {};\n            additionalUrlParams.ok_msid = okanjo.metrics.sid || 'unknown';\n            if (this.config.verbose_click_data) {\n                additionalUrlParams.ok_ch = this._metricBase.ch;\n                additionalUrlParams.ok_cx = this._metricBase.cx;\n                additionalUrlParams._okjr = btoa(window.location.href.split(/[?#]/)[0]); // mod_security by default 403's when urls are present as query args\n            }\n            if (this.config.utm_click_data) {\n                additionalUrlParams.utm_source = 'okanjo';\n                additionalUrlParams.utm_medium = 'smartserve';\n                // additionalUrlParams.utm_source = window.location.hostname;\n                // additionalUrlParams.utm_campaign = 'smartserve';\n            }\n\n            url += joiner + Object.keys(additionalUrlParams)\n                    .map((key) => encodeURIComponent(key)+'='+encodeURIComponent(additionalUrlParams[key]))\n                    .join('&');\n\n            // Wrap the url if we're proxying\n            if (this.config.proxy_url) {\n                url = this.config.proxy_url + encodeURIComponent(url);\n            }\n\n            // Set the url on the event\n            event.data({\n                u: url\n            });\n\n            return event.toUrl();\n        }\n\n        /**\n         * Converts a resource's link into one suitable for tracking, making middle-click safe\n         * @param type\n         * @param resource\n         * @param e\n         * @private\n         */\n        _handleResourceMouseDown(type, resource, e) {\n            // Generate a new click id for this event\n            // const clickId = okanjo.util.shortid();\n            const clickId = resource._cid;\n\n            // Start building the event\n            const event = okanjo.metrics.create(this._metricBase, {\n                id: resource.id\n            })\n                .type(type, Metrics.Event.interaction)\n                .meta(this.getConfig())\n                .meta({ cid: clickId })\n                .meta({\n                    bf: resource.backfill ? 1 : 0,\n                    sf: resource.shortfill ? 1 : 0,\n                    spltfl_seg: okanjo.util.ifDefined(resource.splitfill_segment)\n                })\n                .event(e)\n                .element(e.currentTarget)\n                .viewport()\n                .widget(this.element);\n\n            // Pull the proper params out of the resource depending on it's type\n            let trackParam = 'url_track_param';\n            let urlParam = 'url';\n\n            if (type === Metrics.Object.product) {\n                trackParam = 'buy_url_track_param';\n                urlParam = 'buy_url';\n            }\n\n            // Attach the campaign tracking identifier\n            const additionalParams = {\n                ok_cid: clickId\n            };\n            if (resource[trackParam]) additionalParams[resource[trackParam]] = clickId;\n\n            // Update the link with the event data\n            event.data({ ea: Metrics.Action.click });\n            e.currentTarget.href = this._getClickThroughURL(event, resource[urlParam], additionalParams);\n\n            // Cache this on the product\n            resource._clickId = clickId;\n            resource._event = event;\n            resource._additionalParams = additionalParams;\n        }\n\n        /**\n         * Gets the template to use, accounting for configured preference if available\n         * @param contentType\n         * @param defaultName\n         * @return {string}\n         * @private\n         */\n        _getTemplate(contentType, defaultName) {\n            let templateName = this.config.template_name;\n            if (!templateName ||\n                !okanjo.ui.engine.isTemplateRegistered(`${contentType}.${templateName}`)) {\n                templateName = defaultName;\n            }\n            return `${contentType}.${templateName}`;\n        }\n\n        /**\n         * Enforces size/layout/cta restrictions\n         * @private\n         */\n        _enforceLayoutOptions() {\n            // Enforce format restrictions\n            if (this.config.size === \"leaderboard\" || this.config.size === \"large_mobile_banner\") {\n                this.config.template_layout = \"list\";\n                this.config.template_cta_style = \"link\";\n            } else if (this.config.size === \"half_page\" || this.config.size === \"auto\") {\n                this.config.template_layout = \"list\";\n            }\n        }\n\n        /**\n         * Enforces\n         * @private\n         */\n        _enforceSlabLayoutOptions() {\n            if (this.config.size === \"medium_rectangle\" || this.config.size === \"billboard\") {\n                // no list view\n                this.config.template_layout = \"grid\";\n\n                // no buttons\n                if (this.config.template_cta_style === \"button\") {\n                    this.config.template_cta_style = \"link\";\n                }\n            } else if (this.config.size === \"half_page\") {\n                this.config.template_layout = \"grid\";\n            } else if (this.config.size === \"leaderboard\" || this.config.size === \"large_mobile_banner\") {\n                this.config.template_layout = \"list\";\n\n                // no button\n                if (this.config.template_cta_style === \"button\") {\n                    this.config.template_cta_style = \"link\";\n                }\n            } else if (this.config.size === \"auto\") {\n                this.config.template_layout = \"list\";\n            } else if (this.config.size === \"responsive\") {\n                // no button in responsive mode\n                if (this.config.template_cta_style === \"button\") {\n                    this.config.template_cta_style = \"link\";\n                }\n            }\n        }\n\n        /**\n         * Handles custom styling display settings\n         * @private\n         */\n        _registerCustomBranding(/*prefix, buttonClass*/) {\n            const brandColor = this.config.template_cta_color,\n                brandCSSId = \"okanjo-wgid-\" + this.instanceId;\n            let brandCSS = '';\n\n            if (brandColor) {\n                brandCSS = `\n                    .okanjo-block2.${brandCSSId} .okanjo-resource-cta-button, .okanjo-block2.${brandCSSId} .okanjo-resource-buy-button { color: ${brandColor} !important; }\n                    .okanjo-block2.${brandCSSId}.okanjo-cta-style-button .okanjo-resource-cta-button, .okanjo-block2.${brandCSSId}.okanjo-cta-style-button .okanjo-resource-buy-button { border-color: ${brandColor} !important; }\n                    .okanjo-block2.${brandCSSId}.okanjo-cta-style-button .okanjo-resource-cta-button:hover, .okanjo-block2.${brandCSSId}.okanjo-cta-style-button .okanjo-resource-buy-button:hover { background: ${brandColor} !important; color: #fff !important; }\n                    .okanjo-block2.${brandCSSId}.okanjo-cta-style-button .okanjo-resource-buy-button.invert, .okanjo-block2.${brandCSSId}.okanjo-cta-style-button .okanjo-resource-cta-button.invert { background: ${brandColor} !important; color: #fff !important; }\n                    .okanjo-block2.${brandCSSId}.okanjo-cta-style-button .okanjo-resource-buy-button.invert:hover, .okanjo-block2.${brandCSSId}.okanjo-cta-style-button .okanjo-resource-cta-button.invert:hover { background: #fff !important; color: ${brandColor} !important; }\n                `;\n            }\n\n            // Append custom inline css to the element\n            if (this.config.custom_css) {\n                brandCSS += '\\n\\n' + this.config.custom_css;\n            }\n\n            // Custom external stylesheet first (so inline styles can get priority)\n            if (this.config.custom_css_url) {\n                okanjo.ui.engine.ensureExternalCss(this.config.custom_css_url);\n            }\n\n            // Append the custom widget css to the dom\n            if (brandCSS) {\n                okanjo.ui.engine.registerCss(brandCSSId, brandCSS, { id: brandCSSId });\n                okanjo.ui.engine.ensureCss(brandCSSId);\n            }\n        }\n\n        /**\n         * When element is in view per viewability constants (50% for 1s) trigger handler once\n         * @param element\n         * @param handler\n         * @private\n         */\n        _addOnceViewedHandler(element, handler) {\n            let controller = {\n                element,\n                successfulCount: 0,\n                handler\n            };\n\n            // Add our element to the watch list and turn on the watcher if not already on\n            this._viewedWatchers.push(controller);\n            this._toggleViewWatcher(true);\n        }\n\n        /**\n         * Interval function to check viewability of registered elements\n         * @private\n         */\n        _checkViewWatchers() {\n\n            // Check each registered watcher\n            for (let i = 0, controller; i < this._viewedWatchers.length; i++) {\n                controller = this._viewedWatchers[i];\n\n                const { percentage, elementArea, err } = okanjo.ui.getPercentageInViewport(controller.element);\n\n                // If the viewability stuff failed, the dom is messed up - clean up now\n                if (err) {\n                    this.dispose();\n                    return;\n                }\n\n                // Check if watcher is complete, then remove it from the list\n                /* istanbul ignore next: jsdom won't trigger this */\n                if (okanjo.ui.isElementVisible(controller.element) &&\n                    percentage >= (elementArea >= LARGE_PX_THRESHOLD ? LARGE_MINIMUM_VIEW_PX : MINIMUM_VIEW_PX)) {\n                    controller.successfulCount++;\n                }\n\n                // While this could more optimally be contained within the former condition, unit-testing blocks on this\n                if (controller.successfulCount >= MINIMUM_VIEW_FREQ) {\n                    controller.handler();\n                    this._viewedWatchers.splice(i, 1);\n                    i--;\n                }\n            }\n\n            // Turn off if nobody is watching\n            if (this._viewedWatchers.length === 0) {\n                this._toggleViewWatcher(false);\n            }\n        }\n\n        /**\n         * Turns the viewability watcher on and off\n         * @param enabled\n         * @private\n         */\n        _toggleViewWatcher(enabled) {\n            if (enabled) {\n                if (this._viewWatcherIv === null) {\n                    this._viewWatcherIv = setInterval(this._checkViewWatchers.bind(this), MINIMUM_VIEW_TIME / MINIMUM_VIEW_FREQ);\n                }\n            } else {\n                clearInterval(this._viewWatcherIv);\n                this._viewWatcherIv = null;\n            }\n        }\n\n        /**\n         * Removes the content from the dom, removes all event and watchers\n         */\n        dispose() {\n            // Stop watching for viewable events\n            this._toggleViewWatcher(false);\n\n            // Remove all child content\n            this.setMarkup('');\n\n            // Flag that this widget instance is dead\n            this.disposed = true;\n            this.emit('dispose');\n        }\n\n        //endregion\n\n        //region Product Handling\n\n        /**\n         * Renders a product segment\n         * @param data SmartServe segment data\n         * @param segmentIndex Segment index number\n         * @returns {string} Rendered segment HTML\n         * @private\n         */\n        _renderProductSegment(data, segmentIndex) {\n\n            // Determine template to render, using custom template name if it exists\n            const templateName = this._getTemplate(Placement.ContentTypes.products, Placement.DefaultTemplates.products);\n\n            // Format products\n            data.results.forEach((offer, index) => {\n                // Disable inline buy if configured to do so\n                if (this.config.disable_inline_buy) offer.inline_buy_url = null;\n                if (offer.inline_buy_url) offer._escaped_inline_buy_url = encodeURIComponent(offer.inline_buy_url);\n\n                // Set primary image\n                offer._image_url = offer.image_urls ? offer.image_urls[0] : '' ;\n\n                // Escape buy url (fixme: does not include proxy_url!)\n                offer._escaped_buy_url = encodeURIComponent(offer.buy_url);\n\n                // Make price tag pretty\n                offer._price_formatted = TemplateEngine.formatCurrency(offer.price);\n                offer._index = index;\n                offer.splitfill_segment = segmentIndex;\n                offer._segmentIndex = segmentIndex;\n            });\n\n            const model = this._getBaseRenderModel({\n                resources: data.results\n            });\n\n            // Render and return html (will get concatenated later)\n            return okanjo.ui.engine.render(templateName, this, model);\n        }\n\n        /**\n         * Handles post-render events for product resources\n         * @private\n         */\n        _postProductRender() {\n\n            // Detect broken images\n            this.element.querySelectorAll('.okanjo-product .okanjo-resource-image').forEach((img) => {\n                img.addEventListener('error', () => {\n                    img.src = okanjo.ui.inlineSVG(okanjo.ui.productSVG());\n                    console.error('[okanjo] Failed to load product image: ' + img.getAttribute('data-id'));\n                    // TODO: notify of resource failure\n                });\n            });\n\n            // Bind interaction handlers and track impressions\n            const segments = this._getResponseData();\n            this.element.querySelectorAll('.okanjo-product > a').forEach((a) => {\n\n                const id = a.getAttribute('data-id'),\n                    segment = parseInt(a.getAttribute('data-segment')),\n                    index = parseInt(a.getAttribute('data-index'));\n\n                // Don't bind links that are not tile links\n                /* istanbul ignore else: custom templates could break it */\n                if (id && index >= 0 && segment >= 0) {\n                    const data = segments[segment];\n\n                    /* istanbul ignore if: custom templates could break it */\n                    if (!data) return;\n\n                    const product = data.results[index];\n\n                    /* istanbul ignore else: custom templates could break it */\n                    if (product) {\n\n                        // Bind interaction listener\n                        a.addEventListener('mousedown', this._handleResourceMouseDown.bind(this, Metrics.Object.product, product));\n                        a.addEventListener('click', this._handleProductClick.bind(this, product));\n\n                        // Track impression\n                        okanjo.metrics.create(this._metricBase, { id: product.id })\n                            .type(Metrics.Object.product, Metrics.Event.impression)\n                            .meta(this.getConfig())\n                            .meta({\n                                bf: product.backfill ? 1 : 0,\n                                sf: product.shortfill ? 1 : 0,\n                                spltfl_seg: okanjo.util.ifDefined(product.splitfill_segment)\n                            })\n                            .element(a)\n                            .viewport()\n                            .widget(this.element)\n                            .send();\n\n                        // Start watching for a viewable impression\n                        this._addOnceViewedHandler(a, () => {\n                            okanjo.metrics.create(this._metricBase, { id: product.id })\n                                .type(Metrics.Object.product, Metrics.Event.view)\n                                .meta(this.getConfig())\n                                .meta({\n                                    bf: product.backfill ? 1 : 0,\n                                    sf: product.shortfill ? 1 : 0,\n                                    spltfl_seg: okanjo.util.ifDefined(product.splitfill_segment)\n                                })\n                                .element(a)\n                                .viewport()\n                                .widget(this.element)\n                                .send();\n                        });\n                    }\n                }\n            });\n\n            // Truncate product name to fit the space\n            this.element.querySelectorAll('.okanjo-product .okanjo-resource-title').forEach((element) => {\n                okanjo.ui.ellipsify(element);\n            });\n\n        }\n\n        /**\n         * Handles the product click process\n         * @param product\n         * @param e\n         * @private\n         */\n        _handleProductClick(product, e) {\n\n            // Update the event\n            if (!product._event || !product._additionalParams || !product._clickId) {\n                this._handleResourceMouseDown(Metrics.Object.product, product, e);\n            }\n\n            // Extract the already generated event and params list\n            const {\n                _event: event,\n                _additionalParams: additionalParams\n            } = product;\n\n            // Update the event to the current one\n            event.event(e);\n\n            // Determine what we're doing - native ux or redirect\n            const showNativeBuyUx = !!product.inline_buy_url,\n                showPopupNativeBuyUx = !this.config.disable_popup && showNativeBuyUx && okanjo.util.isMobile()\n            ;\n\n            // Show the inline buy experience or redirect\n            if (showPopupNativeBuyUx) {\n                // Mobile native buy ux\n\n                // Don't follow the link\n                e.preventDefault();\n\n                //\n                // Mobile devices (especially iOS) have real janky UX when interacting with iframes.\n                // So, we'll choose to popup a window with the native buy experience, so we can ensure\n                // a positive user experience. Nobody likes bouncy form fields and really weird zooming.\n                //\n\n                // Update the event\n                event\n                    .data({ ea: Metrics.Action.inline_click })\n                    .meta({ popup: 'true' });\n\n                // Get the frame url\n                let url = this._getClickThroughURL(event, product.inline_buy_url, additionalParams);\n\n                // Open the window or redirect if that failed\n                this._popupFrame = window.open(url, \"okanjo-inline-buy-frame\", \"width=400,height=400,location=yes,resizable=yes,scrollbars=yes\");\n                /* istanbul ignore else: jsdom doesn't support window.open or setting window.location.href */\n                if (!this._popupFrame) {\n                    // Fallback to just replacing the window with the target, since popups don't work :(\n                    okanjo.report('Popup blocker stopped buy experience from showing', { placement: this });\n                    window.location.href = url;\n                }\n\n            } else if (showNativeBuyUx) {\n                // Regular native buy ux\n\n                // Don't follow the link\n                e.preventDefault();\n\n                const frame = document.createElement('iframe');\n                const attributes = {\n                    'class': 'okanjo-inline-buy-frame',\n                    frameborder: 0,\n                    vspace: 0,\n                    hspace: 0,\n                    webkitallowfullscreen: '',\n                    mozallowfullscreen: '',\n                    allowfullscreen: '',\n                    scrolling: 'auto'\n                };\n\n                // Apply attributes\n                Object.keys(attributes).forEach((key) => frame.setAttribute(key, attributes[key]));\n\n                // Check whether we're allowed to expand past the bounds of the placement\n                additionalParams.ok_expandable = this.config.expandable ? 1: 0;\n                if (!this.config.expandable) {\n                    const parent = this.element.querySelector('.okanjo-expansion-root');\n                    /* istanbul ignore else: custom templates could break this */\n                    if (parent) {\n                        frame.className += ' okanjo-ad-in-unit';\n                        frame.setAttribute('height', \"100%\");\n                        frame.setAttribute('width', \"100%\");\n\n                        parent.appendChild(frame);\n\n                        const size = okanjo.ui.getElementSize(parent);\n                        additionalParams.ok_frame_height = size.height;\n                        additionalParams.ok_frame_width = size.width;\n                        /* istanbul ignore next: i'm not writing a whole test for this one config param */\n                        if (this.config.size) additionalParams.ok_ad_size = this.config.size;\n                    }\n                }\n\n                // Update the event\n                event\n                    .data({ ea: Metrics.Action.inline_click })\n                    .meta({ expandable: this.config.expandable ? 'true' : 'false' });\n\n                // Set the frame url\n                frame.src = this._getClickThroughURL(event, product.inline_buy_url, additionalParams);\n\n                // Show the modal if it was not internally expanded\n                if (!frame.parentNode) {\n                    okanjo.ui.modal.show(frame);\n                }\n\n            } else {\n                // Update the link a second time, just in case the data changed\n                e.currentTarget.href = this._getClickThroughURL(event, product.buy_url, additionalParams);\n            }\n        }\n\n        //endregion\n\n        //region Article Handling\n\n        /**\n         * Renders an article segment\n         * @param data SmartServe segment data\n         * @param segmentIndex Segment index number\n         * @returns {string} Rendered segment HTML\n         * @private\n         */\n        _renderArticleSegment(data, segmentIndex) {\n\n            // Determine template to render, using custom template name if it exists\n            const templateName = this._getTemplate(Placement.ContentTypes.articles, Placement.DefaultTemplates.articles);\n\n            // - render\n\n            // Format articles\n            data.results.forEach((article, index) => {\n                // Escape url (fixme: does not include proxy_url!)\n                article._escaped_url = encodeURIComponent(article.url);\n                article._index = index;\n                article.splitfill_segment = segmentIndex;\n                article._segmentIndex = segmentIndex;\n            });\n\n            const model = this._getBaseRenderModel({\n                resources: data.results,\n            });\n\n            // Render and return html (will get concatenated later)\n            return okanjo.ui.engine.render(templateName, this, model);\n        }\n\n        /**\n         * Handles post-render events for article resources\n         * @private\n         */\n        _postArticleRender() {\n\n            // Detect broken images\n            this.element.querySelectorAll('.okanjo-article .okanjo-resource-image').forEach((img) => {\n                img.addEventListener('error', () => {\n                    img.src = okanjo.ui.inlineSVG(okanjo.ui.articleSVG());\n                    console.error('[okanjo] Failed to load article image: ' + img.getAttribute('data-id'));\n                    // TODO: notify of resource failure\n                });\n            });\n\n            // Bind interaction handlers and track impressions\n            const segments = this._getResponseData();\n            this.element.querySelectorAll('.okanjo-article > a').forEach((a) => {\n\n                const id = a.getAttribute('data-id'),\n                    segment = parseInt(a.getAttribute('data-segment')),\n                    index = parseInt(a.getAttribute('data-index'));\n\n                // Don't bind links that are not tile links\n                /* istanbul ignore else: custom templates could break this */\n                if (id && index >= 0 && segment >= 0) {\n                    const data = segments[segment];\n\n                    /* istanbul ignore if: custom templates could break it */\n                    if (!data) return;\n\n                    const article = data.results[index];\n                    /* istanbul ignore else: custom templates could break this */\n                    if (article) {\n\n                        // Bind interaction listener\n                        a.addEventListener('mousedown', this._handleResourceMouseDown.bind(this, Metrics.Object.article, article));\n                        a.addEventListener('click', this._handleArticleClick.bind(this, article));\n\n                        // Track impression\n                        okanjo.metrics.create(this._metricBase, { id: article.id })\n                            .type(Metrics.Object.article, Metrics.Event.impression)\n                            .meta(this.getConfig())\n                            .meta({\n                                bf: article.backfill ? 1 : 0,\n                                sf: article.shortfill ? 1 : 0,\n                                spltfl_seg: okanjo.util.ifDefined(article.splitfill_segment)\n                            })\n                            .element(a)\n                            .viewport()\n                            .widget(this.element)\n                            .send();\n\n                        // Start watching for a viewable impression\n                        this._addOnceViewedHandler(a, () => {\n                            okanjo.metrics.create(this._metricBase, { id: article.id })\n                                .type(Metrics.Object.article, Metrics.Event.view)\n                                .meta(this.getConfig())\n                                .meta({\n                                    bf: article.backfill ? 1 : 0,\n                                    sf: article.shortfill ? 1 : 0,\n                                    spltfl_seg: okanjo.util.ifDefined(article.splitfill_segment)\n                                })\n                                .element(a)\n                                .viewport()\n                                .widget(this.element)\n                                .send();\n                        });\n\n                    }\n                }\n            });\n\n            // Truncate product name to fit the space\n            this.element.querySelectorAll('.okanjo-article .okanjo-resource-title').forEach((element) => {\n                okanjo.ui.ellipsify(element);\n            });\n\n        }\n\n        /**\n         * Handles the article click process\n         * @param article\n         * @param e\n         * @private\n         */\n        _handleArticleClick(article, e) {\n            // Update the event\n            if (!article._event || !article._additionalParams || !article._clickId) {\n                this._handleResourceMouseDown(Metrics.Object.article, article, e);\n            }\n\n            // Extract the already generated event and params list\n            const {\n                _event: event,\n                _additionalParams: additionalParams\n            } = article;\n\n            // Update the event to the current one\n            event.event(e);\n\n            // Update the link a second time, just in case the data changed\n            e.currentTarget.href = this._getClickThroughURL(event, article.url, additionalParams);\n        }\n\n        //endregion\n\n        //region ADX Handling\n\n        /**\n         * Renders a DFP/ADX/GPT segment\n         * @param data SmartServe segment data\n         * @param segmentIndex Segment index number\n         * @returns {string} Rendered segment HTML\n         * @private\n         */\n        _renderADXSegment(data, segmentIndex) {\n\n            // Get the template we should use to render the google ad\n            const templateName = this._getTemplate(Placement.ContentTypes.adx, Placement.DefaultTemplates.adx);\n\n            // Determine what size ad we can place here\n            let size = null;\n            if (this.config.size) {\n                if (Placement.Sizes[this.config.size]) {\n                    // Defined size, use these known dimensions\n                    size = Placement.Sizes[this.config.size];\n                } else {\n                    let match = (/^([0-9]+)x([0-9]+)$/i).exec(this.config.size);\n                    if (match) {\n                        size = { width: match[1], height: match[2] }\n                    }\n                }\n            }\n\n            // No given size, we need to guess\n            if (!size) size = Placement.Sizes.default;\n\n            // If we're using okanjo's ad slot, then track the impression\n            // otherwise decline it because we're just passing through to the publishers account\n            let adUnitPath = '/90447967/okanjo:<publisher>';\n            // let declineReason;\n            if (data.settings.display && data.settings.display.adx_unit_path) {\n                adUnitPath = data.settings.display.adx_unit_path;\n                // declineReason = 'custom_ad_unit';\n            }\n\n            // Pass along what the template needs to know to display the ad\n            const renderContext = this._getBaseRenderModel({\n                size,\n                adUnitPath,\n                segmentIndex\n            });\n\n            // Render the container\n            return okanjo.ui.engine.render(templateName, this, renderContext);\n        }\n\n        /**\n         * Handles post-render events for DFP/ADX/GPT resources\n         * @private\n         */\n        _postADXRender() {\n\n            // Insert the actual ads into their containers\n            const segments = this._getResponseData();\n            this.element.querySelectorAll('.okanjo-adx .okanjo-adx-container').forEach((container) => {\n\n                const path = container.getAttribute('data-path'),\n                    segment = parseInt(container.getAttribute('data-segment')),\n                    width = parseInt(container.getAttribute('data-width')),\n                    height = parseInt(container.getAttribute('data-height'));\n\n                const data = segments[segment];\n\n                /* istanbul ignore if: custom templates could break it */\n                if (!data) return;\n                const meta = {\n                    ta_s: path,\n                    ta_w: width,\n                    ta_h: height,\n                    spltfl_seg: okanjo.util.ifDefined(segment)\n                };\n\n                // Make the frame element\n                const frame = document.createElement('iframe');\n                const attributes = {\n                    'class': 'okanjo-adx-frame',\n                    frameborder: 0,\n                    vspace: 0,\n                    hspace: 0,\n                    webkitallowfullscreen: '',\n                    mozallowfullscreen: '',\n                    allowfullscreen: '',\n                    scrolling: 'auto',\n                    width: width,\n                    height: height\n                };\n\n                // Apply attributes\n                Object.keys(attributes).forEach((key) => frame.setAttribute(key, attributes[key]));\n\n                // Hold a ref to the frame for later\n                data._frame = frame;\n\n                // Attach to DOM\n                container.appendChild(frame);\n\n                // Build a click-through tracking url, so we know when an ad is clicked too\n                let clickUrl = okanjo.metrics.create(this._metricBase)\n                    .type(Metrics.Object.thirdparty_ad, Metrics.Event.interaction)\n                    .meta(this.getConfig())\n                    .meta(meta)\n                    .element(frame)\n                    .viewport()\n                    .widget(this.element)\n                    .toUrl();\n\n                // Transfer references to the frame window\n                // frame.contentWindow.okanjo = okanjo;\n                // frame.contentWindow.placement = this;\n                frame.contentWindow.trackImpression = () => {\n                    okanjo.metrics.create(this._metricBase)\n                        .type(Metrics.Object.thirdparty_ad, Metrics.Event.impression)\n                        .meta(this.getConfig())\n                        .meta(meta)\n                        .element(frame)\n                        .viewport()\n                        .widget(this.element)\n                        .send()\n                    ;\n\n                    // Start watching for a viewable impression\n                    this._addOnceViewedHandler(frame, () => {\n                        okanjo.metrics.create(this._metricBase)\n                            .type(Metrics.Object.thirdparty_ad, Metrics.Event.view)\n                            .meta(this.getConfig())\n                            .meta(meta)\n                            .element(frame)\n                            .viewport()\n                            .widget(this.element)\n                            .send()\n                        ;\n                    });\n                };\n\n                // Load Google ad!\n                // See: https://developers.google.com/publisher-tag/reference#googletag.events.SlotRenderEndedEvent\n                frame.contentWindow.document.open();\n                frame.contentWindow.document.write(\n                    `<html><head><style type=\"text/css\">html,body {margin: 0; padding: 0;}</style></head><body><div id=\"gpt-passback\">\n<`+`script type=\"text/javascript\" src=\"https://securepubads.g.doubleclick.net/tag/js/gpt.js\">\n    \n    window.googletag = window.googletag || {cmd: []};\n    googletag.cmd.push(function() {\n        \n        // Define the slot\n        googletag.defineSlot(\"${path.replace(/\"/g, '\\\\\"')}\", [[${width}, ${height}]], 'gpt-passback')\n            .setClickUrl(\"${clickUrl}&u=\")     // Track click event on the okanjo side\n            .addService(googletag.pubads())    // Service the ad\n        ;\n        \n        // Track load/view events\n        googletag.pubads().addEventListener('slotRenderEnded', function(e) { \n            trackImpression(e);\n        });\n        \n        // Go time\n        googletag.enableServices();\n        googletag.display('gpt-passback');\n    });\n    \n<`+`/script></div>\n</body></html>`);\n                frame.contentWindow.document.close();\n\n                // TODO future event hooks\n                // googletag.pubads().addEventListener('impressionViewable', function(e) { future )});\n                // googletag.pubads().addEventListener('slotOnload', function(e) { future });\n                // googletag.pubads().addEventListener('slotVisibilityChangedEvent', function(e) { future );\n\n                // Impression tracking is done from within the iframe. Crazy, right?\n            });\n\n        }\n\n        //endregion\n    }\n\n    //region Enumerations\n\n    /**\n     * Standard ad sizes\n     * @type {{billboard: {width: number, height: number}, button_2: {width: number, height: number}, half_page: {width: number, height: number}, leaderboard: {width: number, height: number}, medium_rectangle: {width: number, height: number}, micro_bar: {width: number, height: number}, portrait: {width: number, height: number}, rectangle: {width: number, height: number}, super_leaderboard: {width: number, height: number}, wide_skyscraper: {width: number, height: number}, large_mobile_banner: {width: number, height: number}, mobile_leaderboard: {width: number, height: number}, small_square: {width: number, height: number}, button_1: {width: number, height: number}, full_banner: {width: number, height: number}, half_banner: {width: number, height: number}, large_rectangle: {width: number, height: number}, pop_under: {width: number, height: number}, three_to_one_rectangle: {width: number, height: number}, skyscraper: {width: number, height: number}, square: {width: number, height: number}, square_button: {width: number, height: number}, vertical_banner: {width: number, height: number}, vertical_rectangle: {width: number, height: number}}}\n     */\n    Placement.Sizes = {\n\n        // Supported\n        medium_rectangle:       { width: 300, height: 250 }, // aka: sidekick\n        leaderboard:            { width: 728, height:  90 },\n        large_mobile_banner:    { width: 320, height: 100 },\n        half_page:              { width: 300, height: 600 }, // aka: filmstrip, sidekick\n        billboard:              { width: 970, height: 250 }, // aka: sidekick\n\n        // IAB / Others\n        button_2:               { width: 120, height:  60 },\n        micro_bar:              { width:  88, height:  31 },\n        portrait:               { width: 300, height:1050 },\n        rectangle:              { width: 180, height: 150 },\n        super_leaderboard:      { width: 970, height:  90 }, // aka: pushdown, slider, large_leaderboard\n        wide_skyscraper:        { width: 160, height: 600 },\n\n        // Google\n        mobile_leaderboard:     { width: 320, height:  50 },\n        small_square:           { width: 200, height: 200 },\n\n        // Retired / Deprecated\n        button_1:               { width: 120, height:  90 },\n        full_banner:            { width: 468, height:  60 },\n        half_banner:            { width: 234, height:  60 },\n        large_rectangle:        { width: 336, height: 280 },\n        pop_under:              { width: 720, height: 300 },\n        three_to_one_rectangle: { width: 300, height: 100 },\n        skyscraper:             { width: 120, height: 600 },\n        square:                 { width: 250, height: 250 },\n        square_button:          { width: 125, height: 125 },\n        vertical_banner:        { width: 120, height: 240 },\n        vertical_rectangle:     { width: 240, height: 400 }\n    };\n\n    // When we should show an ad but nobody told us what size\n    Placement.Sizes.default = Placement.Sizes.medium_rectangle;\n\n    /**\n     * Placement content types\n     * @type {{adx: string, articles: string, products: string, mixed: string, container: string}}\n     */\n    Placement.ContentTypes = {\n        products: 'products',   // only products\n        articles: 'articles',   // only articles\n        adx: 'adx',             // only display ad\n        mixed: 'mixed',         // mix of two or more of the above (used for metrics responses, not a template)\n        container: 'container', // Widget container - segment content gets rendered into this one at the end\n    };\n\n    /**\n     * Default templates for each content type\n     * @type {{products: string, articles: string, adx: string, container: string}}\n     */\n    Placement.DefaultTemplates = {\n        products: 'block2',\n        articles: 'block2',\n        adx: 'block2',\n        container: 'block2'\n    };\n\n    //endregion\n\n    return okanjo.Placement = Placement;\n\n})(window);","\"use strict\";\n\n// **********\n// DEPRECATED - USE okanjo.Placement instead!\n// **********\n\n//noinspection ThisExpressionReferencesGlobalObjectJS,JSUnusedLocalSymbols\n(function(window) {\n\n    const okanjo = window.okanjo;\n\n    /**\n     * Backwards compatible interface, turning a Product widget into a placement widget\n     * @deprecated\n     */\n    class Product extends okanjo.Placement {\n\n        constructor(element, options) {\n            // Initialize placement w/o loading (we need to jack the config)\n            options = options || {};\n            const no_init = options.no_init; // hold original no_init flag, if set\n            options.no_init = true;\n            super(element, options);\n\n            okanjo.warn('Product widget has been deprecated. Use Placement instead (may require configuration changes)', { widget: this });\n\n            // Start loading content\n            if (!no_init) {\n                delete this.config.no_init;\n                this.init();\n            }\n        }\n\n        //noinspection JSUnusedGlobalSymbols\n        /**\n         * Converts the old product widget configuration into a usable placement configuration\n         */\n        _setCompatibilityOptions() {\n            // Convert the product config to a placement configuration\n            this.config.backwards = 'Product';\n            this.config.type = okanjo.Placement.ContentTypes.products;\n\n            // Set filters based on old \"mode\"\n            if (this.config.mode === 'sense') {\n                // sense\n                this.config.url = this.config.url || 'referrer';\n                this.config.take = this.config.take || 5;\n            } else if (this.config.mode === 'single') {\n                // single\n                this.config.url = null;\n                if (this.config.id) this.config.ids = [this.config.id];\n                this.config.take = 1;\n                delete this.config.id;\n            } else {\n                // browse\n                this.config.url = null;\n                this.config.take = this.config.take || 25;\n            }\n            delete this.config.mode;\n\n            // Sold by changed to store name\n            if (this.config.sold_by) {\n                this.config.store_name = this.config.sold_by;\n                delete this.config.sold_by;\n            }\n\n            // Selectors is now url_selectors\n            if (this.config.selectors) {\n                this.config.url_selectors = this.config.selectors;\n                delete this.config.selectors;\n            }\n\n            // Marketplace_id is no longer a thing, closest analog are properties.\n            if (this.config.marketplace_id) {\n                this.config.property_id = this.config.marketplace_id;\n                delete this.config.marketplace_id\n            }\n\n            // Marketplace status is no longer a thing, instead, use the sandbox environment for testing\n            if (this.config.marketplace_status === 'testing') {\n                this.config.sandbox = true;\n            }\n            delete this.config.marketplace_status;\n\n            // Deprecated\n            delete this.config.suboptimal;\n            delete this.config.text;\n        }\n\n    }\n\n    return okanjo.Product = Product;\n\n})(window);","\"use strict\";\n\n// **********\n// DEPRECATED - USE okanjo.Placement instead!\n// **********\n\n//noinspection ThisExpressionReferencesGlobalObjectJS,JSUnusedLocalSymbols\n(function(window) {\n\n    const okanjo = window.okanjo;\n\n    /**\n     * Backwards compatible interface, turning an Ad widget into a placement widget\n     * @deprecated\n     */\n    class Ad extends okanjo.Placement {\n\n        constructor(element, options) {\n            // Initialize placement w/o loading (we need to jack the config)\n            options = options || {};\n            const no_init = options.no_init; // hold original no_init flag, if set\n            options.no_init = true;\n            super(element, options);\n\n            okanjo.warn('Ad widget has been deprecated. Use Placement instead (may require configuration changes)', { widget: this });\n\n            // Start loading content\n            if (!no_init) {\n                delete this.config.no_init;\n                this.init();\n            }\n        }\n\n        //noinspection JSUnusedGlobalSymbols\n        /**\n         * Converts the old product widget configuration into a usable placement configuration\n         */\n        _setCompatibilityOptions() {\n            // Convert the product config to a placement configuration\n            this.config.backwards = 'Ad';\n            this.config.type = okanjo.Placement.ContentTypes.products;\n\n            // Id / single mode is now ids\n            this.config.url = null;\n            if (this.config.id) {\n                this.config.ids = [this.config.id];\n            } else {\n                okanjo.warn('Ad widget should have parameter `id` set.');\n            }\n            this.config.take = 1;\n            delete this.config.id;\n\n            // Content is automatically determined whether the placement element contains children\n            delete this.config.content;\n        }\n\n    }\n\n    return okanjo.Ad = Ad;\n\n})(window);","\"use strict\";\n\n//noinspection ThisExpressionReferencesGlobalObjectJS,JSUnusedLocalSymbols\n/** Based on https://gist.github.com/mudge/5830382 **/\n(function(window) {\n\n    /**\n     * Simplified EventEmitter base class\n     */\n    class EventEmitter {\n\n        constructor() {\n            this._events = {};\n        }\n\n        /**\n         * Registers an event handler to fire on any occurrence of an event\n         * @param event\n         * @param listener\n         */\n        on(event, listener) {\n            if (!this._events[event]) {\n                this._events[event] = [];\n            }\n\n            this._events[event].push(listener);\n        }\n\n        /**\n         * Removes an event handler for an event\n         * @param event\n         * @param listener\n         */\n        removeListener(event, listener) {\n\n            if (this._events[event]) {\n                let idx = this._events[event].indexOf(listener);\n                if (idx >= 0) {\n                    this._events[event].splice(idx, 1);\n                }\n            }\n        }\n\n        /**\n         * Emits an event\n         * @param event\n         */\n        emit(event) {\n            let i, listeners, length, args = [].slice.call(arguments, 1);\n\n            if (this._events[event]) {\n                listeners = this._events[event].slice();\n                length = listeners.length;\n\n                for (i = 0; i < length; i++) {\n                    listeners[i].apply(this, args);\n                }\n            }\n        }\n\n        //noinspection JSUnusedGlobalSymbols\n        /**\n         * Registers an event handler to fire only once on an event\n         * @param event\n         * @param listener\n         */\n        once(event, listener) {\n\n            const callback = () => {\n                let args = [].slice.call(arguments, 1);\n                this.removeListener(event, callback);\n                listener.apply(this, args);\n            };\n\n            this.on(event, callback);\n        }\n\n    }\n\n    window.okanjo._EventEmitter = EventEmitter;\n    return EventEmitter;\n\n})(window);","/* jshint ignore:start */\n\n(function() {\n\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global = global || self, global.Mustache = factory());\n}(this, (function () { 'use strict';\n\n  /*!\n   * mustache.js - Logic-less {{mustache}} templates with JavaScript\n   * http://github.com/janl/mustache.js\n   */\n\n  var objectToString = Object.prototype.toString;\n  var isArray = Array.isArray || function isArrayPolyfill (object) {\n    return objectToString.call(object) === '[object Array]';\n  };\n\n  function isFunction (object) {\n    return typeof object === 'function';\n  }\n\n  /**\n   * More correct typeof string handling array\n   * which normally returns typeof 'object'\n   */\n  function typeStr (obj) {\n    return isArray(obj) ? 'array' : typeof obj;\n  }\n\n  function escapeRegExp (string) {\n    return string.replace(/[\\-\\[\\]{}()*+?.,\\\\\\^$|#\\s]/g, '\\\\$&');\n  }\n\n  /**\n   * Null safe way of checking whether or not an object,\n   * including its prototype, has a given property\n   */\n  function hasProperty (obj, propName) {\n    return obj != null && typeof obj === 'object' && (propName in obj);\n  }\n\n  /**\n   * Safe way of detecting whether or not the given thing is a primitive and\n   * whether it has the given property\n   */\n  function primitiveHasOwnProperty (primitive, propName) {\n    return (\n      primitive != null\n      && typeof primitive !== 'object'\n      && primitive.hasOwnProperty\n      && primitive.hasOwnProperty(propName)\n    );\n  }\n\n  // Workaround for https://issues.apache.org/jira/browse/COUCHDB-577\n  // See https://github.com/janl/mustache.js/issues/189\n  var regExpTest = RegExp.prototype.test;\n  function testRegExp (re, string) {\n    return regExpTest.call(re, string);\n  }\n\n  var nonSpaceRe = /\\S/;\n  function isWhitespace (string) {\n    return !testRegExp(nonSpaceRe, string);\n  }\n\n  var entityMap = {\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;',\n    '\"': '&quot;',\n    \"'\": '&#39;',\n    '/': '&#x2F;',\n    '`': '&#x60;',\n    '=': '&#x3D;'\n  };\n\n  function escapeHtml (string) {\n    return String(string).replace(/[&<>\"'`=\\/]/g, function fromEntityMap (s) {\n      return entityMap[s];\n    });\n  }\n\n  var whiteRe = /\\s*/;\n  var spaceRe = /\\s+/;\n  var equalsRe = /\\s*=/;\n  var curlyRe = /\\s*\\}/;\n  var tagRe = /#|\\^|\\/|>|\\{|&|=|!/;\n\n  /**\n   * Breaks up the given `template` string into a tree of tokens. If the `tags`\n   * argument is given here it must be an array with two string values: the\n   * opening and closing tags used in the template (e.g. [ \"<%\", \"%>\" ]). Of\n   * course, the default is to use mustaches (i.e. mustache.tags).\n   *\n   * A token is an array with at least 4 elements. The first element is the\n   * mustache symbol that was used inside the tag, e.g. \"#\" or \"&\". If the tag\n   * did not contain a symbol (i.e. {{myValue}}) this element is \"name\". For\n   * all text that appears outside a symbol this element is \"text\".\n   *\n   * The second element of a token is its \"value\". For mustache tags this is\n   * whatever else was inside the tag besides the opening symbol. For text tokens\n   * this is the text itself.\n   *\n   * The third and fourth elements of the token are the start and end indices,\n   * respectively, of the token in the original template.\n   *\n   * Tokens that are the root node of a subtree contain two more elements: 1) an\n   * array of tokens in the subtree and 2) the index in the original template at\n   * which the closing tag for that section begins.\n   *\n   * Tokens for partials also contain two more elements: 1) a string value of\n   * indendation prior to that tag and 2) the index of that tag on that line -\n   * eg a value of 2 indicates the partial is the third tag on this line.\n   */\n  function parseTemplate (template, tags) {\n    if (!template)\n      return [];\n    var lineHasNonSpace = false;\n    var sections = [];     // Stack to hold section tokens\n    var tokens = [];       // Buffer to hold the tokens\n    var spaces = [];       // Indices of whitespace tokens on the current line\n    var hasTag = false;    // Is there a {{tag}} on the current line?\n    var nonSpace = false;  // Is there a non-space char on the current line?\n    var indentation = '';  // Tracks indentation for tags that use it\n    var tagIndex = 0;      // Stores a count of number of tags encountered on a line\n\n    // Strips all whitespace tokens array for the current line\n    // if there was a {{#tag}} on it and otherwise only space.\n    function stripSpace () {\n      if (hasTag && !nonSpace) {\n        while (spaces.length)\n          delete tokens[spaces.pop()];\n      } else {\n        spaces = [];\n      }\n\n      hasTag = false;\n      nonSpace = false;\n    }\n\n    var openingTagRe, closingTagRe, closingCurlyRe;\n    function compileTags (tagsToCompile) {\n      if (typeof tagsToCompile === 'string')\n        tagsToCompile = tagsToCompile.split(spaceRe, 2);\n\n      if (!isArray(tagsToCompile) || tagsToCompile.length !== 2)\n        throw new Error('Invalid tags: ' + tagsToCompile);\n\n      openingTagRe = new RegExp(escapeRegExp(tagsToCompile[0]) + '\\\\s*');\n      closingTagRe = new RegExp('\\\\s*' + escapeRegExp(tagsToCompile[1]));\n      closingCurlyRe = new RegExp('\\\\s*' + escapeRegExp('}' + tagsToCompile[1]));\n    }\n\n    compileTags(tags || mustache.tags);\n\n    var scanner = new Scanner(template);\n\n    var start, type, value, chr, token, openSection;\n    while (!scanner.eos()) {\n      start = scanner.pos;\n\n      // Match any text between tags.\n      value = scanner.scanUntil(openingTagRe);\n\n      if (value) {\n        for (var i = 0, valueLength = value.length; i < valueLength; ++i) {\n          chr = value.charAt(i);\n\n          if (isWhitespace(chr)) {\n            spaces.push(tokens.length);\n            indentation += chr;\n          } else {\n            nonSpace = true;\n            lineHasNonSpace = true;\n            indentation += ' ';\n          }\n\n          tokens.push([ 'text', chr, start, start + 1 ]);\n          start += 1;\n\n          // Check for whitespace on the current line.\n          if (chr === '\\n') {\n            stripSpace();\n            indentation = '';\n            tagIndex = 0;\n            lineHasNonSpace = false;\n          }\n        }\n      }\n\n      // Match the opening tag.\n      if (!scanner.scan(openingTagRe))\n        break;\n\n      hasTag = true;\n\n      // Get the tag type.\n      type = scanner.scan(tagRe) || 'name';\n      scanner.scan(whiteRe);\n\n      // Get the tag value.\n      if (type === '=') {\n        value = scanner.scanUntil(equalsRe);\n        scanner.scan(equalsRe);\n        scanner.scanUntil(closingTagRe);\n      } else if (type === '{') {\n        value = scanner.scanUntil(closingCurlyRe);\n        scanner.scan(curlyRe);\n        scanner.scanUntil(closingTagRe);\n        type = '&';\n      } else {\n        value = scanner.scanUntil(closingTagRe);\n      }\n\n      // Match the closing tag.\n      if (!scanner.scan(closingTagRe))\n        throw new Error('Unclosed tag at ' + scanner.pos);\n\n      if (type == '>') {\n        token = [ type, value, start, scanner.pos, indentation, tagIndex, lineHasNonSpace ];\n      } else {\n        token = [ type, value, start, scanner.pos ];\n      }\n      tagIndex++;\n      tokens.push(token);\n\n      if (type === '#' || type === '^') {\n        sections.push(token);\n      } else if (type === '/') {\n        // Check section nesting.\n        openSection = sections.pop();\n\n        if (!openSection)\n          throw new Error('Unopened section \"' + value + '\" at ' + start);\n\n        if (openSection[1] !== value)\n          throw new Error('Unclosed section \"' + openSection[1] + '\" at ' + start);\n      } else if (type === 'name' || type === '{' || type === '&') {\n        nonSpace = true;\n      } else if (type === '=') {\n        // Set the tags for the next time around.\n        compileTags(value);\n      }\n    }\n\n    stripSpace();\n\n    // Make sure there are no open sections when we're done.\n    openSection = sections.pop();\n\n    if (openSection)\n      throw new Error('Unclosed section \"' + openSection[1] + '\" at ' + scanner.pos);\n\n    return nestTokens(squashTokens(tokens));\n  }\n\n  /**\n   * Combines the values of consecutive text tokens in the given `tokens` array\n   * to a single token.\n   */\n  function squashTokens (tokens) {\n    var squashedTokens = [];\n\n    var token, lastToken;\n    for (var i = 0, numTokens = tokens.length; i < numTokens; ++i) {\n      token = tokens[i];\n\n      if (token) {\n        if (token[0] === 'text' && lastToken && lastToken[0] === 'text') {\n          lastToken[1] += token[1];\n          lastToken[3] = token[3];\n        } else {\n          squashedTokens.push(token);\n          lastToken = token;\n        }\n      }\n    }\n\n    return squashedTokens;\n  }\n\n  /**\n   * Forms the given array of `tokens` into a nested tree structure where\n   * tokens that represent a section have two additional items: 1) an array of\n   * all tokens that appear in that section and 2) the index in the original\n   * template that represents the end of that section.\n   */\n  function nestTokens (tokens) {\n    var nestedTokens = [];\n    var collector = nestedTokens;\n    var sections = [];\n\n    var token, section;\n    for (var i = 0, numTokens = tokens.length; i < numTokens; ++i) {\n      token = tokens[i];\n\n      switch (token[0]) {\n        case '#':\n        case '^':\n          collector.push(token);\n          sections.push(token);\n          collector = token[4] = [];\n          break;\n        case '/':\n          section = sections.pop();\n          section[5] = token[2];\n          collector = sections.length > 0 ? sections[sections.length - 1][4] : nestedTokens;\n          break;\n        default:\n          collector.push(token);\n      }\n    }\n\n    return nestedTokens;\n  }\n\n  /**\n   * A simple string scanner that is used by the template parser to find\n   * tokens in template strings.\n   */\n  function Scanner (string) {\n    this.string = string;\n    this.tail = string;\n    this.pos = 0;\n  }\n\n  /**\n   * Returns `true` if the tail is empty (end of string).\n   */\n  Scanner.prototype.eos = function eos () {\n    return this.tail === '';\n  };\n\n  /**\n   * Tries to match the given regular expression at the current position.\n   * Returns the matched text if it can match, the empty string otherwise.\n   */\n  Scanner.prototype.scan = function scan (re) {\n    var match = this.tail.match(re);\n\n    if (!match || match.index !== 0)\n      return '';\n\n    var string = match[0];\n\n    this.tail = this.tail.substring(string.length);\n    this.pos += string.length;\n\n    return string;\n  };\n\n  /**\n   * Skips all text until the given regular expression can be matched. Returns\n   * the skipped string, which is the entire tail if no match can be made.\n   */\n  Scanner.prototype.scanUntil = function scanUntil (re) {\n    var index = this.tail.search(re), match;\n\n    switch (index) {\n      case -1:\n        match = this.tail;\n        this.tail = '';\n        break;\n      case 0:\n        match = '';\n        break;\n      default:\n        match = this.tail.substring(0, index);\n        this.tail = this.tail.substring(index);\n    }\n\n    this.pos += match.length;\n\n    return match;\n  };\n\n  /**\n   * Represents a rendering context by wrapping a view object and\n   * maintaining a reference to the parent context.\n   */\n  function Context (view, parentContext) {\n    this.view = view;\n    this.cache = { '.': this.view };\n    this.parent = parentContext;\n  }\n\n  /**\n   * Creates a new context using the given view with this context\n   * as the parent.\n   */\n  Context.prototype.push = function push (view) {\n    return new Context(view, this);\n  };\n\n  /**\n   * Returns the value of the given name in this context, traversing\n   * up the context hierarchy if the value is absent in this context's view.\n   */\n  Context.prototype.lookup = function lookup (name) {\n    var cache = this.cache;\n\n    var value;\n    if (cache.hasOwnProperty(name)) {\n      value = cache[name];\n    } else {\n      var context = this, intermediateValue, names, index, lookupHit = false;\n\n      while (context) {\n        if (name.indexOf('.') > 0) {\n          intermediateValue = context.view;\n          names = name.split('.');\n          index = 0;\n\n          /**\n           * Using the dot notion path in `name`, we descend through the\n           * nested objects.\n           *\n           * To be certain that the lookup has been successful, we have to\n           * check if the last object in the path actually has the property\n           * we are looking for. We store the result in `lookupHit`.\n           *\n           * This is specially necessary for when the value has been set to\n           * `undefined` and we want to avoid looking up parent contexts.\n           *\n           * In the case where dot notation is used, we consider the lookup\n           * to be successful even if the last \"object\" in the path is\n           * not actually an object but a primitive (e.g., a string, or an\n           * integer), because it is sometimes useful to access a property\n           * of an autoboxed primitive, such as the length of a string.\n           **/\n          while (intermediateValue != null && index < names.length) {\n            if (index === names.length - 1)\n              lookupHit = (\n                hasProperty(intermediateValue, names[index])\n                || primitiveHasOwnProperty(intermediateValue, names[index])\n              );\n\n            intermediateValue = intermediateValue[names[index++]];\n          }\n        } else {\n          intermediateValue = context.view[name];\n\n          /**\n           * Only checking against `hasProperty`, which always returns `false` if\n           * `context.view` is not an object. Deliberately omitting the check\n           * against `primitiveHasOwnProperty` if dot notation is not used.\n           *\n           * Consider this example:\n           * ```\n           * Mustache.render(\"The length of a football field is {{#length}}{{length}}{{/length}}.\", {length: \"100 yards\"})\n           * ```\n           *\n           * If we were to check also against `primitiveHasOwnProperty`, as we do\n           * in the dot notation case, then render call would return:\n           *\n           * \"The length of a football field is 9.\"\n           *\n           * rather than the expected:\n           *\n           * \"The length of a football field is 100 yards.\"\n           **/\n          lookupHit = hasProperty(context.view, name);\n        }\n\n        if (lookupHit) {\n          value = intermediateValue;\n          break;\n        }\n\n        context = context.parent;\n      }\n\n      cache[name] = value;\n    }\n\n    if (isFunction(value))\n      value = value.call(this.view);\n\n    return value;\n  };\n\n  /**\n   * A Writer knows how to take a stream of tokens and render them to a\n   * string, given a context. It also maintains a cache of templates to\n   * avoid the need to parse the same template twice.\n   */\n  function Writer () {\n    this.templateCache = {\n      _cache: {},\n      set: function set (key, value) {\n        this._cache[key] = value;\n      },\n      get: function get (key) {\n        return this._cache[key];\n      },\n      clear: function clear () {\n        this._cache = {};\n      }\n    };\n  }\n\n  /**\n   * Clears all cached templates in this writer.\n   */\n  Writer.prototype.clearCache = function clearCache () {\n    if (typeof this.templateCache !== 'undefined') {\n      this.templateCache.clear();\n    }\n  };\n\n  /**\n   * Parses and caches the given `template` according to the given `tags` or\n   * `mustache.tags` if `tags` is omitted,  and returns the array of tokens\n   * that is generated from the parse.\n   */\n  Writer.prototype.parse = function parse (template, tags) {\n    var cache = this.templateCache;\n    var cacheKey = template + ':' + (tags || mustache.tags).join(':');\n    var isCacheEnabled = typeof cache !== 'undefined';\n    var tokens = isCacheEnabled ? cache.get(cacheKey) : undefined;\n\n    if (tokens == undefined) {\n      tokens = parseTemplate(template, tags);\n      isCacheEnabled && cache.set(cacheKey, tokens);\n    }\n    return tokens;\n  };\n\n  /**\n   * High-level method that is used to render the given `template` with\n   * the given `view`.\n   *\n   * The optional `partials` argument may be an object that contains the\n   * names and templates of partials that are used in the template. It may\n   * also be a function that is used to load partial templates on the fly\n   * that takes a single argument: the name of the partial.\n   *\n   * If the optional `config` argument is given here, then it should be an\n   * object with a `tags` attribute or an `escape` attribute or both.\n   * If an array is passed, then it will be interpreted the same way as\n   * a `tags` attribute on a `config` object.\n   *\n   * The `tags` attribute of a `config` object must be an array with two\n   * string values: the opening and closing tags used in the template (e.g.\n   * [ \"<%\", \"%>\" ]). The default is to mustache.tags.\n   *\n   * The `escape` attribute of a `config` object must be a function which\n   * accepts a string as input and outputs a safely escaped string.\n   * If an `escape` function is not provided, then an HTML-safe string\n   * escaping function is used as the default.\n   */\n  Writer.prototype.render = function render (template, view, partials, config) {\n    var tags = this.getConfigTags(config);\n    var tokens = this.parse(template, tags);\n    var context = (view instanceof Context) ? view : new Context(view, undefined);\n    return this.renderTokens(tokens, context, partials, template, config);\n  };\n\n  /**\n   * Low-level method that renders the given array of `tokens` using\n   * the given `context` and `partials`.\n   *\n   * Note: The `originalTemplate` is only ever used to extract the portion\n   * of the original template that was contained in a higher-order section.\n   * If the template doesn't use higher-order sections, this argument may\n   * be omitted.\n   */\n  Writer.prototype.renderTokens = function renderTokens (tokens, context, partials, originalTemplate, config) {\n    var buffer = '';\n\n    var token, symbol, value;\n    for (var i = 0, numTokens = tokens.length; i < numTokens; ++i) {\n      value = undefined;\n      token = tokens[i];\n      symbol = token[0];\n\n      if (symbol === '#') value = this.renderSection(token, context, partials, originalTemplate, config);\n      else if (symbol === '^') value = this.renderInverted(token, context, partials, originalTemplate, config);\n      else if (symbol === '>') value = this.renderPartial(token, context, partials, config);\n      else if (symbol === '&') value = this.unescapedValue(token, context);\n      else if (symbol === 'name') value = this.escapedValue(token, context, config);\n      else if (symbol === 'text') value = this.rawValue(token);\n\n      if (value !== undefined)\n        buffer += value;\n    }\n\n    return buffer;\n  };\n\n  Writer.prototype.renderSection = function renderSection (token, context, partials, originalTemplate, config) {\n    var self = this;\n    var buffer = '';\n    var value = context.lookup(token[1]);\n\n    // This function is used to render an arbitrary template\n    // in the current context by higher-order sections.\n    function subRender (template) {\n      return self.render(template, context, partials, config);\n    }\n\n    if (!value) return;\n\n    if (isArray(value)) {\n      for (var j = 0, valueLength = value.length; j < valueLength; ++j) {\n        buffer += this.renderTokens(token[4], context.push(value[j]), partials, originalTemplate, config);\n      }\n    } else if (typeof value === 'object' || typeof value === 'string' || typeof value === 'number') {\n      buffer += this.renderTokens(token[4], context.push(value), partials, originalTemplate, config);\n    } else if (isFunction(value)) {\n      if (typeof originalTemplate !== 'string')\n        throw new Error('Cannot use higher-order sections without the original template');\n\n      // Extract the portion of the original template that the section contains.\n      value = value.call(context.view, originalTemplate.slice(token[3], token[5]), subRender);\n\n      if (value != null)\n        buffer += value;\n    } else {\n      buffer += this.renderTokens(token[4], context, partials, originalTemplate, config);\n    }\n    return buffer;\n  };\n\n  Writer.prototype.renderInverted = function renderInverted (token, context, partials, originalTemplate, config) {\n    var value = context.lookup(token[1]);\n\n    // Use JavaScript's definition of falsy. Include empty arrays.\n    // See https://github.com/janl/mustache.js/issues/186\n    if (!value || (isArray(value) && value.length === 0))\n      return this.renderTokens(token[4], context, partials, originalTemplate, config);\n  };\n\n  Writer.prototype.indentPartial = function indentPartial (partial, indentation, lineHasNonSpace) {\n    var filteredIndentation = indentation.replace(/[^ \\t]/g, '');\n    var partialByNl = partial.split('\\n');\n    for (var i = 0; i < partialByNl.length; i++) {\n      if (partialByNl[i].length && (i > 0 || !lineHasNonSpace)) {\n        partialByNl[i] = filteredIndentation + partialByNl[i];\n      }\n    }\n    return partialByNl.join('\\n');\n  };\n\n  Writer.prototype.renderPartial = function renderPartial (token, context, partials, config) {\n    if (!partials) return;\n    var tags = this.getConfigTags(config);\n\n    var value = isFunction(partials) ? partials(token[1]) : partials[token[1]];\n    if (value != null) {\n      var lineHasNonSpace = token[6];\n      var tagIndex = token[5];\n      var indentation = token[4];\n      var indentedValue = value;\n      if (tagIndex == 0 && indentation) {\n        indentedValue = this.indentPartial(value, indentation, lineHasNonSpace);\n      }\n      var tokens = this.parse(indentedValue, tags);\n      return this.renderTokens(tokens, context, partials, indentedValue, config);\n    }\n  };\n\n  Writer.prototype.unescapedValue = function unescapedValue (token, context) {\n    var value = context.lookup(token[1]);\n    if (value != null)\n      return value;\n  };\n\n  Writer.prototype.escapedValue = function escapedValue (token, context, config) {\n    var escape = this.getConfigEscape(config) || mustache.escape;\n    var value = context.lookup(token[1]);\n    if (value != null)\n      return (typeof value === 'number' && escape === mustache.escape) ? String(value) : escape(value);\n  };\n\n  Writer.prototype.rawValue = function rawValue (token) {\n    return token[1];\n  };\n\n  Writer.prototype.getConfigTags = function getConfigTags (config) {\n    if (isArray(config)) {\n      return config;\n    }\n    else if (config && typeof config === 'object') {\n      return config.tags;\n    }\n    else {\n      return undefined;\n    }\n  };\n\n  Writer.prototype.getConfigEscape = function getConfigEscape (config) {\n    if (config && typeof config === 'object' && !isArray(config)) {\n      return config.escape;\n    }\n    else {\n      return undefined;\n    }\n  };\n\n  var mustache = {\n    name: 'mustache.js',\n    version: '4.2.0',\n    tags: [ '{{', '}}' ],\n    clearCache: undefined,\n    escape: undefined,\n    parse: undefined,\n    render: undefined,\n    Scanner: undefined,\n    Context: undefined,\n    Writer: undefined,\n    /**\n     * Allows a user to override the default caching strategy, by providing an\n     * object with set, get and clear methods. This can also be used to disable\n     * the cache by setting it to the literal `undefined`.\n     */\n    set templateCache (cache) {\n      defaultWriter.templateCache = cache;\n    },\n    /**\n     * Gets the default or overridden caching object from the default writer.\n     */\n    get templateCache () {\n      return defaultWriter.templateCache;\n    }\n  };\n\n  // All high-level mustache.* functions use this writer.\n  var defaultWriter = new Writer();\n\n  /**\n   * Clears all cached templates in the default writer.\n   */\n  mustache.clearCache = function clearCache () {\n    return defaultWriter.clearCache();\n  };\n\n  /**\n   * Parses and caches the given template in the default writer and returns the\n   * array of tokens it contains. Doing this ahead of time avoids the need to\n   * parse templates on the fly as they are rendered.\n   */\n  mustache.parse = function parse (template, tags) {\n    return defaultWriter.parse(template, tags);\n  };\n\n  /**\n   * Renders the `template` with the given `view`, `partials`, and `config`\n   * using the default writer.\n   */\n  mustache.render = function render (template, view, partials, config) {\n    if (typeof template !== 'string') {\n      throw new TypeError('Invalid template! Template should be a \"string\" ' +\n                          'but \"' + typeStr(template) + '\" was given as the first ' +\n                          'argument for mustache#render(template, view, partials)');\n    }\n\n    return defaultWriter.render(template, view, partials, config);\n  };\n\n  // Export the escaping function so that the user may override it.\n  // See https://github.com/janl/mustache.js/issues/244\n  mustache.escape = escapeHtml;\n\n  // Export these mainly for testing, but also for advanced usage.\n  mustache.Scanner = Scanner;\n  mustache.Context = Context;\n  mustache.Writer = Writer;\n\n  return mustache;\n\n})));\n\n\n}).apply(okanjo.lib);\n\n/* jshint ignore:end */"],"sourceRoot":"./"}