/*! okanjo-metrics.js v0.8.4 | (c) 2013 Okanjo Partners Inc | https://okanjo.com/ */
!function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():e.okanjo=t()}(this,function(){var okanjo=function(e){function t(e){for(var t,n,r,o,i={},u=e.split("&"),a=0;a<u.length;a++)try{t=u[a],o=t.indexOf("="),0>o?(n=decodeURIComponent(t),r=null):(n=decodeURIComponent(t.substring(0,o)),r=decodeURIComponent(t.substring(o+1))),n&&(i[n]=r)}catch(s){console.error("[Okanjo] Failed to parse URL parameter:",t,s)}return i}var n=void 0!==window.pageXOffset,r="CSS1Compat"===(document.compatMode||""),o=window.navigator.userAgent,i=function(){},u=e||{};u.version="0.8.4",u.qwery=i,u.metrics={trackEvent:i,trackPageView:i},u.routes={products:"/products",products_id:"/products/:product_id",products_sense:"/products/sense",metrics:"/metrics/:object_type/:event_type"},u.getRoute=function(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&(e=e.replace(":"+n,t[n]+""));return u.config.ads.apiUri+e},u.exec=function(e,t,n){t=t||{},u.JSONP({url:e,data:t,error:function(e){var t={statusCode:500,error:"Communication Error",message:e.message||"JSONP communication failure."};u.report("core-jsonp",e.error||new Error(t.message)),n(t,null)},success:function(e){var t,r;e?e.error?t=e:r=e:(t={statusCode:500,error:"Invalid Response",message:"Could not interpret the JSONP response."},u.report("core-jsonp",new Error(t.message))),n(t,r)}})},u.report=function(e,t){var n;"string"==typeof t?n=new Error("[Okanjo"+(e?" "+e:"")+"] "+t):"object"==typeof t&&t instanceof Error&&(n=t),console.error(n)};var a=u.util=u.util||{};/*! https://github.com/isaacs/inherits/blob/master/inherits_browser.js */
/*! based on shortid https://github.com/dylang/shortid */
return a.trim=function(e){return(e||"").replace(/^\s+|\s+$/g,"")},a.empty=function(e){return null===e||void 0===e||"string"==typeof e&&""===a.trim(e)},a.clone=function(e){var t={};e=e||{};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},a.hash=function(e){var t=0;if(0===e.length)return""+t;for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);t=(t<<5)-t+r}return t.toString(16).replace(/^-/,"n")},a.data=function(e){var t={};if(e)for(var n=e.attributes,r=n.length-1;r>=0;r--)0===n[r].name.indexOf("data-")&&(t[n[r].name.substr(5)]=n[r].value);return t},a.copyIfSet=function(e,t,n,r,o){function i(r){!t||void 0===t[r]||o.stripEmpty&&a.empty(t[r])||(e[n]=t[r])}if(r=r||n,o=o||{},"object"==typeof r&&Array.isArray(r))for(var u=0;u<r.length;u++)i(r[u]);else i(r)},a.copyIfSetMap=function(e,t,n,r){for(var o=Object.keys(n),i=0;i<o.length;i++)a.copyIfSet(e,t,o[i],n[o[i]],r)},a.inherits=function(e,t){if("function"==typeof Object.create)e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}});else{e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},a.getScrollPosition=function(){return{x:n?window.pageXOffset:r?document.documentElement.scrollLeft:document.body.scrollLeft,y:n?window.pageYOffset:r?document.documentElement.scrollTop:document.body.scrollTop}},a.getElementSize=function(e,t){var n,r={height:e.offsetHeight,width:e.offsetWidth};return t&&(n=e.currentStyle||getComputedStyle(e),r.height+=parseInt(n.marginTop)+parseInt(n.marginBottom),r.width+=parseInt(n.marginLeft)+parseInt(n.marginRight)),r},a.getElementPosition=function(e){var t,n,r="[Okanjo Core] Could not get position of element. Did you attach the element to the DOM before initializing?";try{return t=e.getBoundingClientRect(),n=a.getScrollPosition(),document.body.contains(e)||console.warn(r),{x1:t.left+n.x,y1:t.top+n.y,x2:t.right+n.x,y2:t.bottom+n.y}}catch(o){return console.warn(r,o),{x1:0,y1:0,x2:0,y2:0}}},a.getPageSize=function(){var e=u.qwery("body")[0],t=document.documentElement;return{w:Math.max(e.scrollWidth,e.offsetWidth,t.clientWidth,t.scrollWidth,t.offsetWidth),h:Math.max(e.scrollHeight,e.offsetHeight,t.clientHeight,t.scrollHeight,t.offsetHeight)}},a.getViewportSize=function(){var e=document,t=window,n=e.compatMode&&"CSS1Compat"===e.compatMode?e.documentElement:e.body,r=n.clientWidth,o=n.clientHeight,i=t.innerWidth||0,u=t.innerHeight||0,a=i&&r>i||u&&o>u;return{vw:a?i:r,vh:a?u:o}},a.getEventPosition=function(e){var t=e.pageX,n=e.pageY,r=document,o=r.body,i=r.documentElement,u="scrollLeft",a="scrollTop";return{ex:void 0===t?e.clientX+o[u]+i[u]:t,ey:void 0===n?e.clientY+o[a]+i[a]:n}},a.ellipsify=function(e,t){for(var n=t||e.parentNode,r=a.getElementSize(n).height,o=void 0!==e.textContent,i=o?e.textContent:e.innerText,u="",s=5e3,c=function(e){return u=e.substr(0,e.length-3)+u,"..."};a.getElementSize(e).height>r&&i.length>0&&s-- >0;)i=o?e.textContent:e.innerText,i=i.replace(/[\s\S](?:\.\.\.)?$/,c),o?e.textContent=i:e.innerText=i;if(u.length>0){var f=document.createElement("span"),l=document.createElement("span");f.setAttribute("class","okanjo-ellipses"),l.setAttribute("class","okanjo-visually-hidden"),o?(f.textContent=i.substr(0,i.length-3),l.textContent=u):(f.innerText=i.substr(0,i.length-3),l.innerText=u),e.innerHTML="",e.appendChild(f),e.appendChild(l)}},a.detectClasses=function(){var e=[];return-1!=navigator.appVersion.indexOf("MSIE 9.")?e.push("lt-ie10"):-1!=navigator.appVersion.indexOf("MSIE 8.")?e.push("lt-ie9"):-1!=navigator.appVersion.indexOf("MSIE 7.")?e.push("lt-ie8"):-1!=navigator.appVersion.indexOf("MSIE 6.")&&e.push("lt-ie7"),e},a.isFramed=function(){return window.top!==window.self},a.isiOS=function(){return/(iPhone|iPad|iPod)/i.test(o)},a.isAndroid=function(){return/Android/.test(o)},a.isMobile=function(){return a.isiOS()||a.isAndroid()},a.getPageArguments=function(e){var n=t(window.location.search.substring(window.location.search.indexOf("?")+1));if(e){var r=t(window.location.hash.substring(Math.max(window.location.hash.indexOf("#")+1,window.location.hash.indexOf("#!")+2)));for(var o in r)r.hasOwnProperty(o)&&(n[o]=r[o])}return n},a.deepClone=function(e,t){var n,r=0;if(Array.isArray(e))for(t=t||[];r<e.length;r++)t.push(a.deepClone(e[r]));else if("object"==typeof e){t=t||{};for(n in e)e.hasOwnProperty(n)&&(t[n]=a.deepClone(e[n]))}else t=e;return t},a.flatten=function(e){var t,n,r,o={};for(r in e)if(e.hasOwnProperty(r))if(Array.isArray(e[r]))o[r]=e[r];else if("object"==typeof e[r]){t=a.flatten(e[r]);for(n in t)t.hasOwnProperty(n)&&(o[r+"_"+n]=t[n])}else o[r]=e[r];return o},a.shortid=function(e){var t,n,r="ylZM7VHLvOFcohp01x-fXNr8P_tqin6RkgWGm4SIDdK5s2TAJebzQEBUwuY9j3aC",o="undefined"!=typeof require?require("crypto"):window.crypto||window.msCrypto,i=function(){if(o&&o.randomBytes)return 48&o.randomBytes(1)[0];if(!o||!o.getRandomValues)return 48&Math.floor(256*Math.random());var e=new Uint8Array(1);return o.getRandomValues(e),48&e[0]},u=function(e){for(var t,n=0,o="";!t;)o+=r[e>>4*n&15|i()],t=e<Math.pow(16,n+1),n++;return o},a=1458848907498,s=6;return e=e||0,function(){var r="",o=Math.floor(.001*((new Date).getTime()-a));return o===n?t++:(t=0,n=o),r=r+u(s)+u(e),t>0&&(r+=u(t)),r+=u(o)}}(),u}(okanjo||window.okanjo),config=okanjo.config=okanjo.config||{};/*! Console-polyfill. | MIT license. | https://github.com/paulmillr/console-polyfill */
/*! Okanjo Local Storage Polyfill v1.0.0 | (c) 2013 Okanjo Partners Inc | Based on https://gist.github.com/juliocesar/926500/ddb28fb72903be87cb9044a945c6edbe1aa28b3a */
/*! Okanjo Cookie Helper v1.0.0 | (c) 2013 Okanjo Partners Inc */
return config.key=config.key||void 0,config.marketplace={uri:"https://shop.okanjo.com",apiUri:"https://api.okanjo.com",routerUri:"https://shop.okanjo.com/widgets/router/",balancedMarketplacePath:"/v1/marketplaces/MP6vnNdXY7izEEVPs1gl7jSy",socketIOUri:"https://mke-rt.okanjo.com:13443"},config.ads={apiUri:"https://ads-api.okanjo.com"},okanjo.configure=function(e){Object.keys(e).every(function(t){return config[t]&&"object"==typeof config[t]&&"object"==typeof e[t]?Object.keys(e[t]).every(function(n){return config[t][n]=e[t][e[n]],!0}):config[t]=e[t],!0})},function(){if(!this.JSONP){var e,t,n,r,o,i,u;n=window.encodeURIComponent,r=function(){},t=function(e){var t;return t=e.url,t+=e.url.indexOf("?")<0?"?":"&",t+=o(e.data)},i=function(){return e.requestCounter+=1,(new Date).getTime()+"_"+e.requestCounter},o=function(e){var t,r,o;t=[];for(r in e)if(e.hasOwnProperty(r))if(o=e[r],Array.isArray(o))for(var i=0;i<o.length;i++)t.push(n(r)+"[]="+n(o[i]));else if("object"==typeof o)for(var u in o)o.hasOwnProperty(u)&&t.push(n(r)+"["+n(u)+"]="+n(o[u]));else t.push(n(r)+"="+n(o));return t.join("&")},e=function(e){e=e?e:{};var n,o,a,s,c,f;if(a={data:e.data||{},error:e.error||r,success:e.success||r,beforeSend:e.beforeSend||r,complete:e.complete||r,url:e.url||"",timeout:e.timeout||3e4},a.computedUrl=t(a),0===a.url.length)throw new Error("MissingUrl");return o=!1,a.beforeSend({},a)!==!1?(n=a.data[e.callbackName||"callback"]="_okanjo_jsonp_"+i(),window[n]=function(e){c&&clearTimeout(c),c=null,a.success(e,a),a.complete(e,a),f()},f=function(){try{return delete window[n]}catch(e){return void(window[n]=void 0)}},s=window.document.createElement("script"),s.src=t(a),s.async=!0,c=setTimeout(function(){c=null;var e=new Error("JSONP request did not respond in time!");return e.url=s&&s.src||null,a.error(e),f(),a.complete(e,a)},a.timeout),s.onerror=function(e){return c&&clearTimeout(c),a.error({url:s.src,event:e}),a.complete({url:s.src,event:e},a)},s.onload=s.onreadystatechange=function(){return o||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState?void 0:(o=!0,s.onload=s.onreadystatechange=null,s&&s.parentNode&&s.parentNode.removeChild(s),s=null)},u=u||window.document.getElementsByTagName("head")[0]||window.document.documentElement,u.insertBefore(s,u.firstChild)):void 0},e.requestCounter=0,e.makeUrl=t,e.objectToURI=o,"undefined"!=typeof define&&null!==define&&define.amd?define(function(){return e}):"undefined"!=typeof module&&null!==module&&module.exports?module.exports=e:this.JSONP=e}}.call(okanjo),Object.keys||(Object.keys=function(){"use strict";var e=Object.prototype.hasOwnProperty,t=!{toString:null}.propertyIsEnumerable("toString"),n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],r=n.length;return function(o){if("object"!=typeof o&&("function"!=typeof o||null===o))throw new TypeError("Object.keys called on non-object");var i,u,a=[];for(i in o)e.call(o,i)&&a.push(i);if(t)for(u=0;r>u;u++)e.call(o,n[u])&&a.push(n[u]);return a}}()),Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){var n;if(null==this)throw new TypeError('"this" is null or not defined');var r=Object(this),o=r.length>>>0;if(0===o)return-1;var i=+t||0;if(Math.abs(i)===1/0&&(i=0),i>=o)return-1;for(n=Math.max(i>=0?i:o-Math.abs(i),0);o>n;){if(n in r&&r[n]===e)return n;n++}return-1}),Array.prototype.every||(Array.prototype.every=function(e,t){"use strict";var n,r;if(null==this)throw new TypeError("this is null or not defined");var o=Object(this),i=o.length>>>0;if("function"!=typeof e)throw new TypeError;for(arguments.length>1&&(n=t),r=0;i>r;){var u;if(r in o){u=o[r];var a=e.call(n,u,r,o);if(!a)return!1}r++}return!0}),Array.prototype.filter||(Array.prototype.filter=function(e){"use strict";if(void 0===this||null===this)throw new TypeError;var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError;for(var r=[],o=arguments.length>=2?arguments[1]:void 0,i=0;n>i;i++)if(i in t){var u=t[i];e.call(o,u,i,t)&&r.push(u)}return r}),function(){if(Event.prototype.preventDefault||(Event.prototype.preventDefault=function(){this.returnValue=!1}),Event.prototype.stopPropagation||(Event.prototype.stopPropagation=function(){this.cancelBubble=!0}),!Element.prototype.addEventListener){var e=[],t=function(t,n){var r=this,o=function(e){e.target=e.srcElement,e.currentTarget=r,n.handleEvent?n.handleEvent(e):n.call(r,e)};if("DOMContentLoaded"==t){var i=function(e){"complete"==document.readyState&&o(e)};if(document.attachEvent("onreadystatechange",i),e.push({object:this,type:t,listener:n,wrapper:i}),"complete"==document.readyState){var u=new Event;u.srcElement=window,i(u)}}else this.attachEvent("on"+t,o),e.push({object:this,type:t,listener:n,wrapper:o})},n=function(t,n){for(var r=0;r<e.length;){var o=e[r];if(o.object==this&&o.type==t&&o.listener==n){"DOMContentLoaded"==t?this.detachEvent("onreadystatechange",o.wrapper):this.detachEvent("on"+t,o.wrapper),e.splice(r,1);break}++r}};Element.prototype.addEventListener=t,Element.prototype.removeEventListener=n,HTMLDocument&&(HTMLDocument.prototype.addEventListener=t,HTMLDocument.prototype.removeEventListener=n),Window&&(Window.prototype.addEventListener=t,Window.prototype.removeEventListener=n)}}(),function(e){"use strict";var t,n,r=e.console||{},o={},i=function(){},u="memory".split(","),a="assert,count,debug,dir,dirxml,error,exception,group,groupCollapsed,groupEnd,info,log,markTimeline,profile,profileEnd,time,timeEnd,trace,warn".split(",");for(e.console=r;t=u.pop();)void 0===r[t]&&(r[t]=r[t]||o);for(;n=a.pop();)void 0===r[n]&&(r[n]=r[n]||i)}(this||{}),function(e,t){function n(){var e="test",n=t.sessionStorage;try{return n.setItem(e,"1"),n.removeItem(e),!0}catch(r){return!1}}var r=null;return r="localStorage"in t&&null!==t.localStorage&&n()?t.localStorage:{_data:{},length:0,_updateLen:function(){this.length=this._data.length},setItem:function(e,t){var n=this._data[e]=String(t);return this._updateLen(),n},getItem:function(e){return this._data.hasOwnProperty(e)?this._data[e]:void 0},removeItem:function(e){var t=delete this._data[e];return this._updateLen(),t},clear:function(){return this._data={}},key:function(e){return Object.keys(this._data)[e]}},e.Cache=r,r}(okanjo||this,this),function(e,t){var n=t.document||{cookie:""};return e.Cookie={set:function(e,t,r){var o=new Date;o.setDate(o.getDate()+r);var i=encodeURI(t)+(r?"; Expires="+o.toUTCString()+"; Path=/":"");n.cookie=e+"="+i},get:function(e){var t,r,o,i=n.cookie.split(";");for(t=0;t<i.length;t++)if(r=i[t].substr(0,i[t].indexOf("=")),o=i[t].substr(i[t].indexOf("=")+1),r=r.replace(/^\s+|\s+$/g,""),r==e)return decodeURI(o);return null}},e.Cookie}(okanjo||this,this),"object"!=typeof JSON&&(JSON={},function(){"use strict";function f(e){return 10>e?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,r,o,i,u,a=gap,s=t[e];switch(s&&"object"==typeof s&&"function"==typeof s.toJSON&&(s=s.toJSON(e)),"function"==typeof rep&&(s=rep.call(t,e,s)),typeof s){case"string":return quote(s);case"number":return isFinite(s)?String(s):"null";case"boolean":case"null":return String(s);case"object":if(!s)return"null";if(gap+=indent,u=[],"[object Array]"===Object.prototype.toString.apply(s)){for(i=s.length,n=0;i>n;n+=1)u[n]=str(n,s)||"null";return o=0===u.length?"[]":gap?"[\n"+gap+u.join(",\n"+gap)+"\n"+a+"]":"["+u.join(",")+"]",gap=a,o}if(rep&&"object"==typeof rep)for(i=rep.length,n=0;i>n;n+=1)"string"==typeof rep[n]&&(r=rep[n],o=str(r,s),o&&u.push(quote(r)+(gap?": ":":")+o));else for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(o=str(r,s),o&&u.push(quote(r)+(gap?": ":":")+o));return o=0===u.length?"{}":gap?"{\n"+gap+u.join(",\n"+gap)+"\n"+a+"}":"{"+u.join(",")+"}",gap=a,o}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(e,t,n){var r;if(gap="",indent="","number"==typeof n)for(r=0;n>r;r+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(e,t){var n,r,o=e[t];if(o&&"object"==typeof o)for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(r=walk(o,n),void 0!==r?o[n]=r:delete o[n]);return reviver.call(e,t,o)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}()),function(){/*!
  * @preserve Qwery - A Blazing Fast query selector engine
  * https://github.com/ded/qwery
  * copyright Dustin Diaz 2012
  * MIT License
  */
!function(e,t,n){"undefined"!=typeof module&&module.exports?module.exports=n():"function"==typeof define&&define.amd?define(n):t[e]=n()}("qwery",this,function(){function e(){this.c={}}function t(e){return Q.g(e)||Q.s(e,"(^|\\s+)"+e+"(\\s+|$)",1)}function n(e,t){for(var n=0,r=e.length;r>n;n++)t(e[n])}function r(e){for(var t=[],n=0,r=e.length;r>n;++n)g(e[n])?t=t.concat(e[n]):t[t.length]=e[n];return t}function o(e){for(var t=0,n=e.length,r=[];n>t;t++)r[t]=e[t];return r}function i(e){for(;(e=e.previousSibling)&&1!=e[C];);return e}function u(e){return e.match(W)}function a(e,n,r,o,i,u,a,s,f,l,p){var d,h,g,y,m;if(1!==this[C])return!1;if(n&&"*"!==n&&this[S]&&this[S].toLowerCase()!==n)return!1;if(r&&(h=r.match(P))&&h[1]!==this.id)return!1;if(r&&(m=r.match(T)))for(d=m.length;d--;)if(!t(m[d].slice(1)).test(this.className))return!1;if(f&&v.pseudos[f]&&!v.pseudos[f](this,p))return!1;if(o&&!a){y=this.attributes;for(g in y)if(Object.prototype.hasOwnProperty.call(y,g)&&(y[g].name||g)==i)return this}return o&&!c(u,G(this,i)||"",a)?!1:this}function s(e){return X.g(e)||X.s(e,e.replace(R,"\\$1"))}function c(e,t,n){switch(e){case"=":return t==n;case"^=":return t.match(Y.g("^="+n)||Y.s("^="+n,"^"+s(n),1));case"$=":return t.match(Y.g("$="+n)||Y.s("$="+n,s(n)+"$",1));case"*=":return t.match(Y.g(n)||Y.s(n,s(n),1));case"~=":return t.match(Y.g("~="+n)||Y.s("~="+n,"(?:^|\\s+)"+s(n)+"(?:\\s+|$)",1));case"|=":return t.match(Y.g("|="+n)||Y.s("|="+n,"^"+s(n)+"(-|$)",1))}return 0}function f(e,t){var r,o,i,s,c,f,l,d=[],h=[],g=t,y=K.g(e)||K.s(e,e.split(B)),v=e.match(z);if(!y.length)return d;if(s=(y=y.slice(0)).pop(),y.length&&(i=y[y.length-1].match(A))&&(g=m(t,i[1])),!g)return d;for(f=u(s),c=g!==t&&9!==g[C]&&v&&/^[+~]$/.test(v[v.length-1])?function(e){for(;g=g.nextSibling;)1==g[C]&&(f[1]?f[1]==g[S].toLowerCase():1)&&(e[e.length]=g);return e}([]):g[k](f[1]||"*"),r=0,o=c.length;o>r;r++)(l=a.apply(c[r],f))&&(d[d.length]=l);return y.length?(n(d,function(e){p(e,y,v)&&(h[h.length]=e)}),h):d}function l(e,t,n){if(d(t))return e==t;if(g(t))return!!~r(t).indexOf(e);for(var o,i,s=t.split(",");t=s.pop();)if(o=K.g(t)||K.s(t,t.split(B)),i=t.match(z),o=o.slice(0),a.apply(e,u(o.pop()))&&(!o.length||p(e,o,i,n)))return!0;return!1}function p(e,t,n,r){function o(e,r,s){for(;s=F[n[r]](s,e);)if(d(s)&&a.apply(s,u(t[r]))){if(!r)return s;if(i=o(s,r-1,s))return i}}var i;return(i=o(e,t.length-1,e))&&(!r||Z(i,r))}function d(e,t){return e&&"object"==typeof e&&(t=e[C])&&(1==t||9==t)}function h(e){var t,n,r=[];e:for(t=0;t<e.length;++t){for(n=0;n<r.length;++n)if(r[n]==e[t])continue e;r[r.length]=e[t]}return r}function g(e){return"object"==typeof e&&isFinite(e.length)}function y(e){return e?"string"==typeof e?v(e)[0]:!e[C]&&g(e)?e[0]:e:x}function m(e,t,n){return 9===e[C]?e.getElementById(t):e.ownerDocument&&((n=e.ownerDocument.getElementById(t))&&Z(n,e)&&n||!Z(e,e.ownerDocument)&&b('[id="'+t+'"]',e)[0])}function v(e,t){var n,i,u=y(t);if(!u||!e)return[];if(e===window||d(e))return!t||e!==window&&d(u)&&Z(e,u)?[e]:[];if(e&&g(e))return r(e);if(n=e.match(V)){if(n[1])return(i=m(u,n[1]))?[i]:[];if(n[2])return o(u[k](n[2]));if(ee&&n[3])return o(u[j](n[3]))}return b(e,u)}function w(e,t){return function(n){var r,o;return L.test(n)?void(9!==e[C]&&((o=r=e.getAttribute("id"))||e.setAttribute("id",o="__qwerymeupscotty"),n='[id="'+o+'"]'+n,t(e.parentNode||e,n,!0),r||e.removeAttribute("id"))):void(n.length&&t(e,n,!1))}}var b,x=document,_=x.documentElement,j="getElementsByClassName",k="getElementsByTagName",E="querySelectorAll",O="useNativeQSA",S="tagName",C="nodeType",P=/#([\w\-]+)/,T=/\.[\w\-]+/g,A=/^#([\w\-]+)$/,N=/^\.([\w\-]+)$/,M=/^([\w\-]+)$/,I=/^([\w]+)?\.([\w\-]+)$/,L=/(^|,)\s*[>~+]/,D=/^\s+|\s*([,\s\+\~>]|$)\s*/g,q=/[\s\>\+\~]/,U=/(?![\s\w\-\/\?\&\=\:\.\(\)\!,@#%<>\{\}\$\*\^'"]*\]|[\s\w\+\-]*\))/,R=/([.*+?\^=!:${}()|\[\]\/\\])/g,$=/^(\*|[a-z0-9]+)?(?:([\.\#]+[\w\-\.#]+)?)/,J=/\[([\w\-]+)(?:([\|\^\$\*\~]?\=)['"]?([ \w\-\/\?\&\=\:\.\(\)\!,@#%<>\{\}\$\*\^]+)["']?)?\]/,H=/:([\w\-]+)(\(['"]?([^()]+)['"]?\))?/,V=new RegExp(A.source+"|"+M.source+"|"+N.source),z=new RegExp("("+q.source+")"+U.source,"g"),B=new RegExp(q.source+U.source),W=new RegExp($.source+"("+J.source+")?("+H.source+")?"),F={" ":function(e){return e&&e!==_&&e.parentNode},">":function(e,t){return e&&e.parentNode==t.parentNode&&e.parentNode},"~":function(e){return e&&e.previousSibling},"+":function(e,t,n,r){return e?(n=i(e))&&(r=i(t))&&n==r&&n:!1}};e.prototype={g:function(e){return this.c[e]||void 0},s:function(e,t,n){return t=n?new RegExp(t):t,this.c[e]=t}};var Q=new e,X=new e,Y=new e,K=new e,Z="compareDocumentPosition"in _?function(e,t){return 16==(16&t.compareDocumentPosition(e))}:"contains"in _?function(e,t){return t=9===t[C]||t==window?_:t,t!==e&&t.contains(e)}:function(e,t){for(;e=e.parentNode;)if(e===t)return 1;return 0},G=function(){var e=x.createElement("p");return(e.innerHTML='<a href="#x">x</a>')&&"#x"!=e.firstChild.getAttribute("href")?function(e,t){return"class"===t?e.className:"href"===t||"src"===t?e.getAttribute(t,2):e.getAttribute(t)}:function(e,t){return e.getAttribute(t)}}(),ee=!!x[j],te=x.querySelector&&x[E],ne=function(e,t){var r,i,u=[];try{return 9!==t[C]&&L.test(e)?(n(r=e.split(","),w(t,function(e,t){i=e[E](t),1==i.length?u[u.length]=i.item(0):i.length&&(u=u.concat(o(i)))})),r.length>1&&u.length>1?h(u):u):o(t[E](e))}catch(a){}return re(e,t)},re=function(e,r){var o,i,u,a,s,c,l=[];if(e=e.replace(D,"$1"),i=e.match(I)){for(s=t(i[2]),o=r[k](i[1]||"*"),u=0,a=o.length;a>u;u++)s.test(o[u].className)&&(l[l.length]=o[u]);return l}return n(c=e.split(","),w(r,function(e,t,n){for(s=f(t,e),u=0,a=s.length;a>u;u++)(9===e[C]||n||Z(s[u],r))&&(l[l.length]=s[u])})),c.length>1&&l.length>1?h(l):l},oe=function(e){"undefined"!=typeof e[O]&&(b=e[O]&&te?ne:re)};return oe({useNativeQSA:!0}),v.configure=oe,v.uniq=h,v.is=l,v.pseudos={},v}),/*! onDomReady.js 1.4.0 (c) 2013 Tubal Martin - MIT license | Wrapped in UMD by Okanjo */
function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():e.onDomReady=t()}(this,function(){"use strict";function e(t){if(!x){if(!u.body)return r(e);for(x=!0;t=_.shift();)r(t)}}function t(t){(w||t.type===s||u[p]===l)&&(n(),e())}function n(){w?(u[v](y,t,c),i[v](s,t,c)):(u[h](m,t),i[h](f,t))}function r(e,t){setTimeout(e,+t>=0?t:1)}function o(e){x?r(e):_.push(e)}var i=window,u=i.document,a=u.documentElement,s="load",c=!1,f="on"+s,l="complete",p="readyState",d="attachEvent",h="detachEvent",g="addEventListener",y="DOMContentLoaded",m="onreadystatechange",v="removeEventListener",w=g in u,b=c,x=c,_=[];if(u[p]===l)r(e);else if(w)u[g](y,t,c),i[g](s,t,c);else{u[d](m,t),i[d](f,t);try{b=null==i.frameElement&&a}catch(j){}b&&b.doScroll&&!function k(){if(!x){try{b.doScroll("left")}catch(t){return r(k,50)}n(),e()}}()}return o.version="1.4.0",o.isReady=function(){return x},o})}.apply(okanjo),function(e,t){function n(){this.default_channel=this.channel.external,this._queue=[],this.pageId=e.util.shortid();var t=e.util.getPageArguments(!0),n=t[this.msid_key],r=e.Cookie.get(this.msid_key),o=t[this.source_cx],i=t[this.source_ch];n&&r&&n!=r&&(this.trackEvent(this.object_type.metric_session,this.event_type.correlation,{id:n+"_"+r,ch:this.default_channel,_noProcess:!0}),e.Cookie.set(this.msid_key,n,this.msid_ttl)),this.sid=n||r||null,this.sourceCh=i||null,this.sourceCx=o||null,this._lastKey=void 0}n.prototype={msid_key:"ok_msid",source_cx:"ok_cx",source_ch:"ok_ch",msid_ttl:1460,strip_meta:["key","callback","metrics_channel_context","metrics_context","mode"],constructor:n,event_type:{view:"vw",impression:"imp",interaction:"int",correlation:"cor"},action:{click:"click",inline_click:"inline_click"},object_type:{thirdparty_ad:"ta",cart:"ct",page:"pg",widget:"wg",product:"pr",store:"st",cause:"ca",marketplace:"mp",order:"or",order_item:"oi",user:"ur",metric_session:"mt"},channel:{product_widget:"pw",ad_widget:"aw",store_widget:"sw",marketplace:"mp",external:"ex"},environment:{live:"live",testing:"testing"},trackEvent:function(t,n,r,o){r=r||{},r.object_type=t,r.event_type=n,this._lastKey=r.key||r.key||r.m&&r.m.key||e.key||this._lastKey||void 0,this.push(r,o)},trackPageView:function(e,n){e=e||{},e.id=e.id||t.location.href,e.ch=e.ch||this.default_channel,this.trackEvent(this.object_type.page,this.event_type.view,e,n)},track:function(t,n){if(!t||"object"!=typeof t)return void console.warn("[Okanjo.Metrics] event object data required");if(!t.object_type)return void console.warn("[Okanjo.Metrics] object_type required");if(!t.event_type)return void console.warn("[Okanjo.Metrics] event_type required");var r=t.object_type,o=t.event_type;delete t.object_type,delete t.event_type,this.normalizeEventData(t),e.exec(e.getRoute(e.routes.metrics,{object_type:r,event_type:o}),t,function(e,t){e&&console.warn("[Okanjo.Metrics] Reporting failed",e,t),n&&n(e,t)})},normalizeEventData:function(t){if(t.key=t.key||t.m&&t.m.key||e.key||this._lastKey||void 0,this.sid&&(t.sid=this.sid),t.m){var n={};for(var r in t.m)t.m.hasOwnProperty(r)&&this.strip_meta.indexOf(r)<0&&(n[r]=t.m[r]);t.m=n}else t.m={};(this.sourceCh||this.sourceCx)&&(this.sourceCh&&(t.m.ref_ch=this.sourceCh),this.sourceCx&&(t.m.ref_cx=this.sourceCx)),t.m.pgid=this.pageId,t.m.ok_ver=e.version,document.referrer&&(t.ref=document.referrer)},updateSid:function(t){!this.sid&&t&&(this.sid=t,e.Cookie.set(this.msid_key,t,this.msid_ttl))},push:function(e,t){this._queue.push({event:e,callback:t}),e._noProcess?delete e._noProcess:this._processQueue()},_processQueue:function(){if(!this._processTimeout&&this._queue.length>0){var e=this;this._processTimeout=setTimeout(function(){var t=e._queue.shift();void 0===t?e._processTimeout=null:e.track(t.event,function(n,r){r&&r.data&&r.data.sid&&e.updateSid(r.data.sid),e._processTimeout=null,e._processQueue(),t.callback&&t.callback(n,r)})},0)}},includeElementInfo:function(t,n){var r=e.util.getPageSize(),o=e.util.getElementPosition(t);return n=n||{},n.pw=r.w,n.ph=r.h,n.x1=o.x1,n.y1=o.y1,n.x2=o.x2,n.y2=o.y2,n},includeViewportInfo:function(t){var n=e.util.getViewportSize(),r=e.util.getScrollPosition();return t=t||{},t.vx1=r.x,t.vy1=r.y,t.vx2=t.vx1+n.vw,t.vy2=t.vy1+n.vh,t},includeEventInfo:function(t,n){var r=e.util.getEventPosition(t);return n.ex=r.ex,n.ey=r.ey,n},copy:function(t,n){return e.util.flatten(e.util.deepClone(t,n))},truncate:function(e){for(var t in e)e.hasOwnProperty(t)&&"string"==typeof e[t]&&(e[t]=e[t].substr(0,255));return e}},e.metrics=new n}(okanjo,this),okanjo});
//# sourceMappingURL=okanjo-metrics.min.js.map
